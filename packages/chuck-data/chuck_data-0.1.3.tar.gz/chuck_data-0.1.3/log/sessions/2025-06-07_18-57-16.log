2025-06-07 18:57:16,648 - DEBUG - Logging initialized. Writing to /Users/johnrush/repos/chuck-data/log/sessions/2025-06-07_18-57-16.log
2025-06-07 18:57:16,653 - DEBUG - GET request to: https://test-workspace.cloud.databricks.com/test-endpoint
2025-06-07 18:57:16,654 - DEBUG - GET request to: https://test-workspace.cloud.databricks.com/test-endpoint
2025-06-07 18:57:16,654 - DEBUG - HTTP error: HTTP 404, Response: Not Found
2025-06-07 18:57:16,655 - DEBUG - GET request to: https://test-workspace.cloud.databricks.com/test-endpoint
2025-06-07 18:57:16,655 - DEBUG - Connection error: Connection failed
2025-06-07 18:57:16,656 - DEBUG - POST request to: https://test-workspace.cloud.databricks.com/test-endpoint
2025-06-07 18:57:16,658 - DEBUG - POST request to: https://test-workspace.cloud.databricks.com/test-endpoint
2025-06-07 18:57:16,658 - DEBUG - HTTP error: HTTP 400, Response: Bad Request
2025-06-07 18:57:16,659 - DEBUG - POST request to: https://test-workspace.cloud.databricks.com/test-endpoint
2025-06-07 18:57:16,659 - DEBUG - Connection error: Connection failed
2025-06-07 18:57:16,660 - DEBUG - HTTP error: HTTP 401, Response: {"status":401,"message":"Unauthorized"}
2025-06-07 18:57:16,663 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpm7fbqsyn/test_config.json
2025-06-07 18:57:16,663 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpm7fbqsyn/test_config.json
2025-06-07 18:57:16,665 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpb3kpft9n/test_config.json
2025-06-07 18:57:16,666 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpb3kpft9n/test_config.json
2025-06-07 18:57:16,667 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmphsamgth0/test_config.json
2025-06-07 18:57:16,667 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmphsamgth0/test_config.json
2025-06-07 18:57:16,667 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmphsamgth0/test_config.json
2025-06-07 18:57:16,668 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmphsamgth0/test_config.json
2025-06-07 18:57:16,668 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmphsamgth0/test_config.json
2025-06-07 18:57:16,668 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmphsamgth0/test_config.json
2025-06-07 18:57:16,668 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmphsamgth0/test_config.json
2025-06-07 18:57:16,669 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmphsamgth0/test_config.json
2025-06-07 18:57:16,669 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmphsamgth0/test_config.json
2025-06-07 18:57:16,669 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmphsamgth0/test_config.json
2025-06-07 18:57:16,669 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmphsamgth0/test_config.json
2025-06-07 18:57:16,669 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmphsamgth0/test_config.json
2025-06-07 18:57:16,669 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmphsamgth0/test_config.json
2025-06-07 18:57:16,670 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmphsamgth0/test_config.json
2025-06-07 18:57:16,670 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmphsamgth0/test_config.json
2025-06-07 18:57:16,671 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpkit9s9dc/test_config.json
2025-06-07 18:57:16,672 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpkit9s9dc/test_config.json
2025-06-07 18:57:16,672 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpkit9s9dc/test_config.json
2025-06-07 18:57:16,672 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpkit9s9dc/test_config.json
2025-06-07 18:57:16,672 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpkit9s9dc/test_config.json
2025-06-07 18:57:16,672 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpkit9s9dc/test_config.json
2025-06-07 18:57:16,673 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpkit9s9dc/test_config.json
2025-06-07 18:57:16,673 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpkit9s9dc/test_config.json
2025-06-07 18:57:16,673 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpkit9s9dc/test_config.json
2025-06-07 18:57:16,673 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpkit9s9dc/test_config.json
2025-06-07 18:57:16,673 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpkit9s9dc/test_config.json
2025-06-07 18:57:16,673 - DEBUG - Using workspace_url from environment variable CHUCK_WORKSPACE_URL
2025-06-07 18:57:16,673 - DEBUG - Using active_model from environment variable CHUCK_ACTIVE_MODEL
2025-06-07 18:57:16,673 - DEBUG - Using warehouse_id from environment variable CHUCK_WAREHOUSE_ID
2025-06-07 18:57:16,674 - DEBUG - Using active_catalog from environment variable CHUCK_ACTIVE_CATALOG
2025-06-07 18:57:16,674 - DEBUG - Using active_schema from environment variable CHUCK_ACTIVE_SCHEMA
2025-06-07 18:57:16,675 - ERROR - Config file is corrupted. Using default config.
2025-06-07 18:57:16,676 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpv_z5l27w/test_config.json
2025-06-07 18:57:16,678 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpmzntiogl/test_config.json
2025-06-07 18:57:16,678 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpmzntiogl/test_config.json
2025-06-07 18:57:16,678 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpmzntiogl/test_config.json
2025-06-07 18:57:16,678 - DEBUG - Using databricks_token from environment variable CHUCK_DATABRICKS_TOKEN
2025-06-07 18:57:16,680 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpka3ousf8/test_config.json
2025-06-07 18:57:16,680 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpka3ousf8/test_config.json
2025-06-07 18:57:16,680 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpka3ousf8/test_config.json
2025-06-07 18:57:16,680 - DEBUG - Using workspace_url from environment variable CHUCK_WORKSPACE_URL
2025-06-07 18:57:16,682 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpn_qrrbpr/test_config.json
2025-06-07 18:57:16,683 - ERROR - Config file is corrupted. Using default config.
2025-06-07 18:57:16,683 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpu7pyh9ft
2025-06-07 18:57:16,684 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpu7pyh9ft
2025-06-07 18:57:16,685 - ERROR - Config file is corrupted. Using default config.
2025-06-07 18:57:16,685 - DEBUG - Using workspace_url from environment variable CHUCK_WORKSPACE_URL
2025-06-07 18:57:16,685 - DEBUG - Using active_model from environment variable CHUCK_ACTIVE_MODEL
2025-06-07 18:57:16,685 - DEBUG - Using warehouse_id from environment variable CHUCK_WAREHOUSE_ID
2025-06-07 18:57:16,685 - DEBUG - Using active_catalog from environment variable CHUCK_ACTIVE_CATALOG
2025-06-07 18:57:16,685 - DEBUG - Using active_schema from environment variable CHUCK_ACTIVE_SCHEMA
2025-06-07 18:57:16,685 - DEBUG - Using amperity_token from environment variable CHUCK_AMPERITY_TOKEN
2025-06-07 18:57:16,685 - DEBUG - Using databricks_token from environment variable CHUCK_DATABRICKS_TOKEN
2025-06-07 18:57:16,685 - DEBUG - Using usage_tracking_consent from environment variable CHUCK_USAGE_TRACKING_CONSENT
2025-06-07 18:57:16,686 - ERROR - Config file is corrupted. Using default config.
2025-06-07 18:57:16,688 - ERROR - Config file is corrupted. Using default config.
2025-06-07 18:57:16,688 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp7v0w9kbe
2025-06-07 18:57:16,689 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp7v0w9kbe
2025-06-07 18:57:16,690 - ERROR - Config file is corrupted. Using default config.
2025-06-07 18:57:16,690 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpvz23tdg4
2025-06-07 18:57:16,690 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpvz23tdg4
2025-06-07 18:57:16,691 - ERROR - Config file is corrupted. Using default config.
2025-06-07 18:57:16,692 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp8055rrsz
2025-06-07 18:57:16,692 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp8055rrsz
2025-06-07 18:57:16,692 - ERROR - Connection error during token validation: Network error
2025-06-07 18:57:16,694 - ERROR - Config file is corrupted. Using default config.
2025-06-07 18:57:16,694 - INFO - Using Databricks token from environment variable. Consider using /set-token to save it to config.
2025-06-07 18:57:16,695 - ERROR - Config file is corrupted. Using default config.
2025-06-07 18:57:16,695 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpsd055v7v
2025-06-07 18:57:16,695 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpsd055v7v
2025-06-07 18:57:16,696 - ERROR - Config file is corrupted. Using default config.
2025-06-07 18:57:16,696 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpdyd1e1uh
2025-06-07 18:57:16,697 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpdyd1e1uh
2025-06-07 18:57:16,700 - DEBUG - GET request to: https://adb-3856707039489412.12.azuredatabricks.net/test-endpoint
2025-06-07 18:57:16,703 - DEBUG - GET request to: https://test-workspace.cloud.databricks.com/test-endpoint
2025-06-07 18:57:16,705 - DEBUG - GET request to: https://test-workspace.cloud.databricks.com/test-endpoint
2025-06-07 18:57:16,705 - DEBUG - HTTP error: HTTP 404, Response: Not Found
2025-06-07 18:57:16,705 - DEBUG - GET request to: https://test-workspace.cloud.databricks.com/test-endpoint
2025-06-07 18:57:16,706 - DEBUG - Connection error: Connection failed
2025-06-07 18:57:16,706 - DEBUG - POST request to: https://test-workspace.cloud.databricks.com/test-endpoint
2025-06-07 18:57:16,708 - DEBUG - POST request to: https://test-workspace.cloud.databricks.com/test-endpoint
2025-06-07 18:57:16,708 - DEBUG - HTTP error: HTTP 400, Response: Bad Request
2025-06-07 18:57:16,709 - DEBUG - POST request to: https://test-workspace.cloud.databricks.com/test-endpoint
2025-06-07 18:57:16,709 - DEBUG - Connection error: Connection failed
2025-06-07 18:57:16,710 - DEBUG - Token validation failed: Token validation failed
2025-06-07 18:57:16,713 - DEBUG - File upload request to: https://test-workspace.cloud.databricks.com/api/2.0/fs/files/test/path.txt
2025-06-07 18:57:16,715 - DEBUG - File upload request to: https://test-workspace.cloud.databricks.com/api/2.0/fs/files/test/path.txt
2025-06-07 18:57:16,719 - WARNING - Model 'nonexistent-model' not found
2025-06-07 18:57:16,726 - ERROR - Config file is corrupted. Using default config.
2025-06-07 18:57:16,726 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpi0aqjbvp
2025-06-07 18:57:16,726 - DEBUG - Metrics tracking skipped - user has not provided consent
2025-06-07 18:57:16,728 - ERROR - Config file is corrupted. Using default config.
2025-06-07 18:57:16,728 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpbs3tf5w3
2025-06-07 18:57:16,730 - ERROR - Config file is corrupted. Using default config.
2025-06-07 18:57:16,730 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpyeepp05f
2025-06-07 18:57:16,730 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpyeepp05f
2025-06-07 18:57:16,730 - DEBUG - Sending metric: {"event": "USAGE", "prompt": "test prompt"}...
2025-06-07 18:57:16,732 - ERROR - Config file is corrupted. Using default config.
2025-06-07 18:57:16,732 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmph6kiaee5
2025-06-07 18:57:16,732 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmph6kiaee5
2025-06-07 18:57:16,732 - DEBUG - Sending metric: {"event": "USAGE", "prompt": "test prompt"}...
2025-06-07 18:57:16,734 - ERROR - Config file is corrupted. Using default config.
2025-06-07 18:57:16,734 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp42ocoqn8
2025-06-07 18:57:16,734 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp42ocoqn8
2025-06-07 18:57:16,734 - DEBUG - Sending metric: {"event": "USAGE", "prompt": "test prompt"}...
2025-06-07 18:57:16,734 - DEBUG - Error sending metrics: Test exception
Traceback (most recent call last):
  File "/Users/johnrush/repos/chuck-data/chuck_data/metrics_collector.py", line 123, in send_metric
    return self._client.submit_metrics(payload, token)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnrush/repos/chuck-data/tests/fixtures/amperity.py", line 60, in submit_metrics
    raise Exception("Test exception")
Exception: Test exception
2025-06-07 18:57:16,736 - ERROR - Config file is corrupted. Using default config.
2025-06-07 18:57:16,736 - DEBUG - Cannot send metrics - no authentication token available
2025-06-07 18:57:16,740 - ERROR - Failed to list models: HTTP error occurred: 404 Not Found
2025-06-07 18:57:16,741 - ERROR - Connection error when listing models: Connection failed
2025-06-07 18:57:16,743 - ERROR - Failed to get model: HTTP error occurred: 500 Internal Server Error
2025-06-07 18:57:16,744 - ERROR - Connection error when getting model: Connection failed
2025-06-07 18:57:16,753 - DEBUG - Unity Catalog check failed: Access denied
2025-06-07 18:57:16,754 - DEBUG - Jobs check failed: Forbidden
2025-06-07 18:57:16,754 - DEBUG - Volumes check failed: Access denied
2025-06-07 18:57:16,801 - DEBUG - Executing SQL: SELECT * FROM table
2025-06-07 18:57:16,802 - DEBUG - Executing SQL: SELECT * FROM table
2025-06-07 18:57:16,803 - DEBUG - Executing SQL: SELECT * FROM table
2025-06-07 18:57:16,804 - DEBUG - Executing SQL: SELECT * FROM table
2025-06-07 18:57:16,805 - DEBUG - Executing SQL: SELECT * INVALID SQL
2025-06-07 18:57:16,807 - DEBUG - Executing SQL: SELECT * INVALID SQL
