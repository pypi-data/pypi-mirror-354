2025-05-21 15:17:25,615 - ERROR - HTTP error: 401 Client Error: Unauthorized for url: https://dbc-df998298-4c7e.cloud.databricks.com/api/2.0/serving-endpoints, Response: {"error_code":401,"message":"Credential was not sent or was of an unsupported type for this API. [ReqId: 9788eec6-fe1a-4a06-810b-d2916b96c8a3]"}
2025-05-21 15:17:25,616 - ERROR - Failed to list models: HTTP error occurred: 401 Client Error: Unauthorized for url: https://dbc-df998298-4c7e.cloud.databricks.com/api/2.0/serving-endpoints, Response: {"error_code":401,"message":"Credential was not sent or was of an unsupported type for this API. [ReqId: 9788eec6-fe1a-4a06-810b-d2916b96c8a3]"}
2025-05-21 15:17:25,616 - ERROR - Failed to list models: Model serving API error: HTTP error occurred: 401 Client Error: Unauthorized for url: https://dbc-df998298-4c7e.cloud.databricks.com/api/2.0/serving-endpoints, Response: {"error_code":401,"message":"Credential was not sent or was of an unsupported type for this API. [ReqId: 9788eec6-fe1a-4a06-810b-d2916b96c8a3]"}
Traceback (most recent call last):
  File "/Users/johnrush/repos/clamp-internal/src/clients/databricks.py", line 75, in get
    response.raise_for_status()
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/johnrush/repos/clamp-internal/.venv/lib/python3.13/site-packages/requests/models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 401 Client Error: Unauthorized for url: https://dbc-df998298-4c7e.cloud.databricks.com/api/2.0/serving-endpoints

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/johnrush/repos/clamp-internal/src/models.py", line 19, in list_models
    return client.list_models()
           ~~~~~~~~~~~~~~~~~~^^
  File "/Users/johnrush/repos/clamp-internal/src/clients/databricks.py", line 393, in list_models
    response = self.get("/api/2.0/serving-endpoints")
  File "/Users/johnrush/repos/clamp-internal/src/clients/databricks.py", line 79, in get
    raise ValueError(f"HTTP error occurred: {e}, Response: {response.text}")
ValueError: HTTP error occurred: 401 Client Error: Unauthorized for url: https://dbc-df998298-4c7e.cloud.databricks.com/api/2.0/serving-endpoints, Response: {"error_code":401,"message":"Credential was not sent or was of an unsupported type for this API. [ReqId: 9788eec6-fe1a-4a06-810b-d2916b96c8a3]"}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/johnrush/repos/clamp-internal/src/commands/models.py", line 20, in handle_command
    models_list = list_models_api(client)
  File "/Users/johnrush/repos/clamp-internal/src/models.py", line 22, in list_models
    raise ValueError(f"Model serving API error: {e}")
ValueError: Model serving API error: HTTP error occurred: 401 Client Error: Unauthorized for url: https://dbc-df998298-4c7e.cloud.databricks.com/api/2.0/serving-endpoints, Response: {"error_code":401,"message":"Credential was not sent or was of an unsupported type for this API. [ReqId: 9788eec6-fe1a-4a06-810b-d2916b96c8a3]"}
2025-05-21 15:17:35,475 - ERROR - HTTP error: 401 Client Error: Unauthorized for url: https://dbc-df998298-4c7e.cloud.databricks.com/api/2.0/preview/scim/v2/Me, Response: {"error_code":401,"message":"Credential was not sent or was of an unsupported type for this API. [ReqId: 3e41c87d-2453-4010-8c9c-64544478eaca]"}
2025-05-21 15:17:35,578 - ERROR - HTTP error: 401 Client Error: Unauthorized for url: https://dbc-df998298-4c7e.cloud.databricks.com/api/2.1/unity-catalog/catalogs?max_results=1, Response: {"error_code":401,"message":"Credential was not sent or was of an unsupported type for this API. [ReqId: 5769afe9-944d-4dca-adbb-06a8d9207fe0]"}
2025-05-21 15:17:35,693 - ERROR - HTTP error: 401 Client Error: Unauthorized for url: https://dbc-df998298-4c7e.cloud.databricks.com/api/2.0/sql/warehouses?page_size=1, Response: {"error_code":401,"message":"Credential was not sent or was of an unsupported type for this API. [ReqId: 76fc3b59-7514-49ab-a5bb-aad0be3e2008]"}
2025-05-21 15:17:35,799 - ERROR - HTTP error: 401 Client Error: Unauthorized for url: https://dbc-df998298-4c7e.cloud.databricks.com/api/2.1/jobs/list?limit=1, Response: {"error_code":401,"message":"Credential was not sent or was of an unsupported type for this API. [ReqId: 8cc3aa40-1d4a-414b-89ee-ce1e32e978af]"}
2025-05-21 15:17:35,898 - ERROR - HTTP error: 401 Client Error: Unauthorized for url: https://dbc-df998298-4c7e.cloud.databricks.com/api/2.0/mlflow/registered-models/list?max_results=1, Response: {"error_code":401,"message":"Credential was not sent or was of an unsupported type for this API. [ReqId: 4ca0f10f-be54-4c3d-99b2-8acb207fbc64]"}
2025-05-21 15:17:36,008 - ERROR - HTTP error: 401 Client Error: Unauthorized for url: https://dbc-df998298-4c7e.cloud.databricks.com/api/2.1/unity-catalog/catalogs?max_results=1, Response: {"error_code":401,"message":"Credential was not sent or was of an unsupported type for this API. [ReqId: f462d481-d6f8-4deb-8dd8-720e2abe53cc]"}
2025-05-21 15:17:45,237 - ERROR - HTTP error: 401 Client Error: Unauthorized for url: https://dbc-df998298-4c7e.cloud.databricks.com/api/2.0/preview/scim/v2/Me, Response: {"error_code":401,"message":"Credential was not sent or was of an unsupported type for this API. [ReqId: a9e2e477-c457-4991-a51f-154703392318]"}
2025-05-21 15:17:45,349 - ERROR - HTTP error: 401 Client Error: Unauthorized for url: https://dbc-df998298-4c7e.cloud.databricks.com/api/2.1/unity-catalog/catalogs?max_results=1, Response: {"error_code":401,"message":"Credential was not sent or was of an unsupported type for this API. [ReqId: d243946c-5a8e-40fb-a45c-757111f930ab]"}
2025-05-21 15:17:45,448 - ERROR - HTTP error: 401 Client Error: Unauthorized for url: https://dbc-df998298-4c7e.cloud.databricks.com/api/2.0/sql/warehouses?page_size=1, Response: {"error_code":401,"message":"Credential was not sent or was of an unsupported type for this API. [ReqId: 6dd3e20a-dd5a-491d-a9e0-95130aaa3961]"}
2025-05-21 15:17:45,542 - ERROR - HTTP error: 401 Client Error: Unauthorized for url: https://dbc-df998298-4c7e.cloud.databricks.com/api/2.1/jobs/list?limit=1, Response: {"error_code":401,"message":"Credential was not sent or was of an unsupported type for this API. [ReqId: aae1a4a1-c76a-4c5f-8e91-000fad50f42f]"}
2025-05-21 15:17:45,643 - ERROR - HTTP error: 401 Client Error: Unauthorized for url: https://dbc-df998298-4c7e.cloud.databricks.com/api/2.0/mlflow/registered-models/list?max_results=1, Response: {"error_code":401,"message":"Credential was not sent or was of an unsupported type for this API. [ReqId: 9822ea68-94e2-4dc5-b587-056216d10053]"}
2025-05-21 15:17:45,753 - ERROR - HTTP error: 401 Client Error: Unauthorized for url: https://dbc-df998298-4c7e.cloud.databricks.com/api/2.1/unity-catalog/catalogs?max_results=1, Response: {"error_code":401,"message":"Credential was not sent or was of an unsupported type for this API. [ReqId: d97969a0-a130-4c72-8146-7bc7db698849]"}
