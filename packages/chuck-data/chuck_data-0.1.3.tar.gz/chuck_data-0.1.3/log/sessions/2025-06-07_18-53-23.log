2025-06-07 18:53:23,324 - DEBUG - Logging initialized. Writing to /Users/johnrush/repos/chuck-data/log/sessions/2025-06-07_18-53-23.log
2025-06-07 18:53:23,330 - DEBUG - GET request to: https://test-workspace.cloud.databricks.com/test-endpoint
2025-06-07 18:53:23,332 - DEBUG - GET request to: https://test-workspace.cloud.databricks.com/test-endpoint
2025-06-07 18:53:23,332 - DEBUG - HTTP error: HTTP 404, Response: Not Found
2025-06-07 18:53:23,333 - DEBUG - GET request to: https://test-workspace.cloud.databricks.com/test-endpoint
2025-06-07 18:53:23,333 - DEBUG - Connection error: Connection failed
2025-06-07 18:53:23,334 - DEBUG - POST request to: https://test-workspace.cloud.databricks.com/test-endpoint
2025-06-07 18:53:23,336 - DEBUG - POST request to: https://test-workspace.cloud.databricks.com/test-endpoint
2025-06-07 18:53:23,336 - DEBUG - HTTP error: HTTP 400, Response: Bad Request
2025-06-07 18:53:23,337 - DEBUG - POST request to: https://test-workspace.cloud.databricks.com/test-endpoint
2025-06-07 18:53:23,337 - DEBUG - Connection error: Connection failed
2025-06-07 18:53:23,339 - DEBUG - HTTP error: HTTP 401, Response: {"status":401,"message":"Unauthorized"}
2025-06-07 18:53:23,342 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpd4gx7ig2/test_config.json
2025-06-07 18:53:23,342 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpd4gx7ig2/test_config.json
2025-06-07 18:53:23,344 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp_tfiwi94/test_config.json
2025-06-07 18:53:23,344 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp_tfiwi94/test_config.json
2025-06-07 18:53:23,346 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpcei4sm_y/test_config.json
2025-06-07 18:53:23,346 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpcei4sm_y/test_config.json
2025-06-07 18:53:23,346 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpcei4sm_y/test_config.json
2025-06-07 18:53:23,347 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpcei4sm_y/test_config.json
2025-06-07 18:53:23,347 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpcei4sm_y/test_config.json
2025-06-07 18:53:23,347 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpcei4sm_y/test_config.json
2025-06-07 18:53:23,347 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpcei4sm_y/test_config.json
2025-06-07 18:53:23,348 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpcei4sm_y/test_config.json
2025-06-07 18:53:23,348 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpcei4sm_y/test_config.json
2025-06-07 18:53:23,348 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpcei4sm_y/test_config.json
2025-06-07 18:53:23,348 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpcei4sm_y/test_config.json
2025-06-07 18:53:23,348 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpcei4sm_y/test_config.json
2025-06-07 18:53:23,348 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpcei4sm_y/test_config.json
2025-06-07 18:53:23,349 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpcei4sm_y/test_config.json
2025-06-07 18:53:23,349 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpcei4sm_y/test_config.json
2025-06-07 18:53:23,350 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpi4xn0gl5/test_config.json
2025-06-07 18:53:23,351 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpi4xn0gl5/test_config.json
2025-06-07 18:53:23,351 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpi4xn0gl5/test_config.json
2025-06-07 18:53:23,351 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpi4xn0gl5/test_config.json
2025-06-07 18:53:23,351 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpi4xn0gl5/test_config.json
2025-06-07 18:53:23,351 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpi4xn0gl5/test_config.json
2025-06-07 18:53:23,352 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpi4xn0gl5/test_config.json
2025-06-07 18:53:23,352 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpi4xn0gl5/test_config.json
2025-06-07 18:53:23,352 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpi4xn0gl5/test_config.json
2025-06-07 18:53:23,352 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpi4xn0gl5/test_config.json
2025-06-07 18:53:23,352 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpi4xn0gl5/test_config.json
2025-06-07 18:53:23,352 - DEBUG - Using workspace_url from environment variable CHUCK_WORKSPACE_URL
2025-06-07 18:53:23,352 - DEBUG - Using active_model from environment variable CHUCK_ACTIVE_MODEL
2025-06-07 18:53:23,352 - DEBUG - Using warehouse_id from environment variable CHUCK_WAREHOUSE_ID
2025-06-07 18:53:23,352 - DEBUG - Using active_catalog from environment variable CHUCK_ACTIVE_CATALOG
2025-06-07 18:53:23,352 - DEBUG - Using active_schema from environment variable CHUCK_ACTIVE_SCHEMA
2025-06-07 18:53:23,354 - ERROR - Config file is corrupted. Using default config.
2025-06-07 18:53:23,356 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp0fs0kmem/test_config.json
2025-06-07 18:53:23,357 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpcrtefrtw/test_config.json
2025-06-07 18:53:23,357 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpcrtefrtw/test_config.json
2025-06-07 18:53:23,358 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpcrtefrtw/test_config.json
2025-06-07 18:53:23,358 - DEBUG - Using databricks_token from environment variable CHUCK_DATABRICKS_TOKEN
2025-06-07 18:53:23,359 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpqejkp90s/test_config.json
2025-06-07 18:53:23,359 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpqejkp90s/test_config.json
2025-06-07 18:53:23,359 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpqejkp90s/test_config.json
2025-06-07 18:53:23,360 - DEBUG - Using workspace_url from environment variable CHUCK_WORKSPACE_URL
2025-06-07 18:53:23,361 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpft_um41e/test_config.json
2025-06-07 18:53:23,363 - ERROR - Config file is corrupted. Using default config.
2025-06-07 18:53:23,363 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp2d3ohmxf
2025-06-07 18:53:23,363 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp2d3ohmxf
2025-06-07 18:53:23,365 - ERROR - Config file is corrupted. Using default config.
2025-06-07 18:53:23,365 - DEBUG - Using workspace_url from environment variable CHUCK_WORKSPACE_URL
2025-06-07 18:53:23,365 - DEBUG - Using active_model from environment variable CHUCK_ACTIVE_MODEL
2025-06-07 18:53:23,365 - DEBUG - Using warehouse_id from environment variable CHUCK_WAREHOUSE_ID
2025-06-07 18:53:23,365 - DEBUG - Using active_catalog from environment variable CHUCK_ACTIVE_CATALOG
2025-06-07 18:53:23,365 - DEBUG - Using active_schema from environment variable CHUCK_ACTIVE_SCHEMA
2025-06-07 18:53:23,365 - DEBUG - Using amperity_token from environment variable CHUCK_AMPERITY_TOKEN
2025-06-07 18:53:23,365 - DEBUG - Using databricks_token from environment variable CHUCK_DATABRICKS_TOKEN
2025-06-07 18:53:23,365 - DEBUG - Using usage_tracking_consent from environment variable CHUCK_USAGE_TRACKING_CONSENT
2025-06-07 18:53:23,366 - ERROR - Config file is corrupted. Using default config.
2025-06-07 18:53:23,368 - ERROR - Config file is corrupted. Using default config.
2025-06-07 18:53:23,368 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp6e0c9eco
2025-06-07 18:53:23,368 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp6e0c9eco
2025-06-07 18:53:23,370 - ERROR - Config file is corrupted. Using default config.
2025-06-07 18:53:23,370 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpt9ton0po
2025-06-07 18:53:23,370 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpt9ton0po
2025-06-07 18:53:23,372 - ERROR - Config file is corrupted. Using default config.
2025-06-07 18:53:23,372 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpu7piqbwt
2025-06-07 18:53:23,373 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpu7piqbwt
2025-06-07 18:53:23,373 - ERROR - Connection error during token validation: Network error
2025-06-07 18:53:23,374 - ERROR - Config file is corrupted. Using default config.
2025-06-07 18:53:23,374 - INFO - Using Databricks token from environment variable. Consider using /set-token to save it to config.
2025-06-07 18:53:23,375 - ERROR - Config file is corrupted. Using default config.
2025-06-07 18:53:23,376 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpwf45uic0
2025-06-07 18:53:23,376 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpwf45uic0
2025-06-07 18:53:23,377 - ERROR - Config file is corrupted. Using default config.
2025-06-07 18:53:23,377 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp58bnjco7
2025-06-07 18:53:23,378 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp58bnjco7
2025-06-07 18:53:23,381 - DEBUG - GET request to: https://adb-3856707039489412.12.azuredatabricks.net/test-endpoint
2025-06-07 18:53:23,386 - DEBUG - GET request to: https://test-workspace.cloud.databricks.com/test-endpoint
2025-06-07 18:53:23,388 - DEBUG - GET request to: https://test-workspace.cloud.databricks.com/test-endpoint
2025-06-07 18:53:23,388 - DEBUG - HTTP error: HTTP 404, Response: Not Found
2025-06-07 18:53:23,389 - DEBUG - GET request to: https://test-workspace.cloud.databricks.com/test-endpoint
2025-06-07 18:53:23,389 - DEBUG - Connection error: Connection failed
2025-06-07 18:53:23,390 - DEBUG - POST request to: https://test-workspace.cloud.databricks.com/test-endpoint
2025-06-07 18:53:23,392 - DEBUG - POST request to: https://test-workspace.cloud.databricks.com/test-endpoint
2025-06-07 18:53:23,392 - DEBUG - HTTP error: HTTP 400, Response: Bad Request
2025-06-07 18:53:23,393 - DEBUG - POST request to: https://test-workspace.cloud.databricks.com/test-endpoint
2025-06-07 18:53:23,393 - DEBUG - Connection error: Connection failed
2025-06-07 18:53:23,395 - DEBUG - Token validation failed: Token validation failed
2025-06-07 18:53:23,399 - DEBUG - File upload request to: https://test-workspace.cloud.databricks.com/api/2.0/fs/files/test/path.txt
2025-06-07 18:53:23,402 - DEBUG - File upload request to: https://test-workspace.cloud.databricks.com/api/2.0/fs/files/test/path.txt
2025-06-07 18:53:23,407 - WARNING - Model 'nonexistent-model' not found
2025-06-07 18:53:23,416 - ERROR - Config file is corrupted. Using default config.
2025-06-07 18:53:23,416 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpz_q5e21x
2025-06-07 18:53:23,416 - DEBUG - Metrics tracking skipped - user has not provided consent
2025-06-07 18:53:23,418 - ERROR - Config file is corrupted. Using default config.
2025-06-07 18:53:23,418 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp78o0ozi4
2025-06-07 18:53:23,420 - ERROR - Config file is corrupted. Using default config.
2025-06-07 18:53:23,421 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpxgex5e6c
2025-06-07 18:53:23,421 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpxgex5e6c
2025-06-07 18:53:23,421 - DEBUG - Sending metric: {"event": "USAGE", "prompt": "test prompt"}...
2025-06-07 18:53:23,423 - ERROR - Config file is corrupted. Using default config.
2025-06-07 18:53:23,423 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp73n4cvho
2025-06-07 18:53:23,423 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp73n4cvho
2025-06-07 18:53:23,424 - DEBUG - Sending metric: {"event": "USAGE", "prompt": "test prompt"}...
2025-06-07 18:53:23,425 - ERROR - Config file is corrupted. Using default config.
2025-06-07 18:53:23,426 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp_mdksj7o
2025-06-07 18:53:23,426 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp_mdksj7o
2025-06-07 18:53:23,426 - DEBUG - Sending metric: {"event": "USAGE", "prompt": "test prompt"}...
2025-06-07 18:53:23,426 - DEBUG - Error sending metrics: Test exception
Traceback (most recent call last):
  File "/Users/johnrush/repos/chuck-data/chuck_data/metrics_collector.py", line 123, in send_metric
    return self._client.submit_metrics(payload, token)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnrush/repos/chuck-data/tests/fixtures/amperity.py", line 60, in submit_metrics
    raise Exception("Test exception")
Exception: Test exception
2025-06-07 18:53:23,428 - ERROR - Config file is corrupted. Using default config.
2025-06-07 18:53:23,428 - DEBUG - Cannot send metrics - no authentication token available
2025-06-07 18:53:23,432 - ERROR - Failed to list models: HTTP error occurred: 404 Not Found
2025-06-07 18:53:23,433 - ERROR - Connection error when listing models: Connection failed
2025-06-07 18:53:23,437 - ERROR - Failed to get model: HTTP error occurred: 500 Internal Server Error
2025-06-07 18:53:23,437 - ERROR - Connection error when getting model: Connection failed
2025-06-07 18:53:23,448 - DEBUG - Unity Catalog check failed: Access denied
2025-06-07 18:53:23,448 - DEBUG - Jobs check failed: Forbidden
2025-06-07 18:53:23,448 - DEBUG - Volumes check failed: Access denied
2025-06-07 18:53:23,509 - DEBUG - Executing SQL: SELECT * FROM table
2025-06-07 18:53:23,510 - DEBUG - Executing SQL: SELECT * FROM table
2025-06-07 18:53:23,512 - DEBUG - Executing SQL: SELECT * FROM table
2025-06-07 18:53:23,513 - DEBUG - Executing SQL: SELECT * FROM table
2025-06-07 18:53:23,514 - DEBUG - Executing SQL: SELECT * INVALID SQL
2025-06-07 18:53:23,515 - DEBUG - Executing SQL: SELECT * INVALID SQL
