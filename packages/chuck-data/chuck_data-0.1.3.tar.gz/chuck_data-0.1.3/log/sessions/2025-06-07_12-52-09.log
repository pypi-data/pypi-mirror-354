2025-06-07 12:52:09,069 - DEBUG - Logging initialized. Writing to /Users/johnrush/repos/chuck-data/log/sessions/2025-06-07_12-52-09.log
2025-06-07 12:52:09,071 - DEBUG - Loaded configuration from /Users/johnrush/.chuck_config.json
2025-06-07 12:52:09,088 - DEBUG - Using selector: KqueueSelector
2025-06-07 12:52:14,046 - DEBUG - connect_tcp.started host='dbc-df998298-4c7e.cloud.databricks.com' port=443 local_address=None timeout=5.0 socket_options=None
2025-06-07 12:52:14,152 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x1081e70e0>
2025-06-07 12:52:14,152 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x1081bce60> server_hostname='dbc-df998298-4c7e.cloud.databricks.com' timeout=5.0
2025-06-07 12:52:14,195 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x108214410>
2025-06-07 12:52:14,195 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2025-06-07 12:52:14,195 - DEBUG - send_request_headers.complete
2025-06-07 12:52:14,195 - DEBUG - send_request_body.started request=<Request [b'POST']>
2025-06-07 12:52:14,195 - DEBUG - send_request_body.complete
2025-06-07 12:52:14,195 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2025-06-07 12:52:15,130 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'content-type', b'application/json; charset=utf-8'), (b'server', b'databricks'), (b'date', b'Sat, 7 Jun 2025 19:52:15 GMT'), (b'x-databricks-org-id', b'3416276235813320'), (b'x-request-id', b'e7c532ab-7c98-4683-9f36-d476f7a6b2a5'), (b'content-encoding', b'gzip'), (b'vary', b'Accept-Encoding'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'x-content-type-options', b'nosniff'), (b'transfer-encoding', b'chunked')])
2025-06-07 12:52:15,131 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2025-06-07 12:52:15,131 - DEBUG - receive_response_body.complete
2025-06-07 12:52:15,131 - DEBUG - response_closed.started
2025-06-07 12:52:15,132 - DEBUG - response_closed.complete
2025-06-07 12:52:15,135 - DEBUG - Agent attempting to execute tool: status with args: {}
2025-06-07 12:52:15,135 - DEBUG - Tool arguments for 'status' validated successfully.
2025-06-07 12:52:15,135 - DEBUG - Executing agent tool 'status' with handler: handle_command
2025-06-07 12:52:15,135 - DEBUG - GET request to: https://dbc-df998298-4c7e.cloud.databricks.com/api/2.0/preview/scim/v2/Me
2025-06-07 12:52:15,137 - DEBUG - Starting new HTTPS connection (1): dbc-df998298-4c7e.cloud.databricks.com:443
2025-06-07 12:52:15,559 - DEBUG - https://dbc-df998298-4c7e.cloud.databricks.com:443 "GET /api/2.0/preview/scim/v2/Me HTTP/1.1" 200 None
2025-06-07 12:52:15,560 - DEBUG - GET request to: https://dbc-df998298-4c7e.cloud.databricks.com/api/2.1/unity-catalog/catalogs?max_results=1
2025-06-07 12:52:15,561 - DEBUG - Starting new HTTPS connection (1): dbc-df998298-4c7e.cloud.databricks.com:443
2025-06-07 12:52:15,773 - DEBUG - https://dbc-df998298-4c7e.cloud.databricks.com:443 "GET /api/2.1/unity-catalog/catalogs?max_results=1 HTTP/1.1" 200 None
2025-06-07 12:52:15,773 - DEBUG - GET request to: https://dbc-df998298-4c7e.cloud.databricks.com/api/2.0/sql/warehouses?page_size=1
2025-06-07 12:52:15,774 - DEBUG - Starting new HTTPS connection (1): dbc-df998298-4c7e.cloud.databricks.com:443
2025-06-07 12:52:15,910 - DEBUG - https://dbc-df998298-4c7e.cloud.databricks.com:443 "GET /api/2.0/sql/warehouses?page_size=1 HTTP/1.1" 200 None
2025-06-07 12:52:15,911 - DEBUG - GET request to: https://dbc-df998298-4c7e.cloud.databricks.com/api/2.1/jobs/list?limit=1
2025-06-07 12:52:15,911 - DEBUG - Starting new HTTPS connection (1): dbc-df998298-4c7e.cloud.databricks.com:443
2025-06-07 12:52:16,183 - DEBUG - https://dbc-df998298-4c7e.cloud.databricks.com:443 "GET /api/2.1/jobs/list?limit=1 HTTP/1.1" 200 None
2025-06-07 12:52:16,184 - DEBUG - GET request to: https://dbc-df998298-4c7e.cloud.databricks.com/api/2.0/mlflow/registered-models/list?max_results=1
2025-06-07 12:52:16,185 - DEBUG - Starting new HTTPS connection (1): dbc-df998298-4c7e.cloud.databricks.com:443
2025-06-07 12:52:16,340 - DEBUG - https://dbc-df998298-4c7e.cloud.databricks.com:443 "GET /api/2.0/mlflow/registered-models/list?max_results=1 HTTP/1.1" 200 2
2025-06-07 12:52:16,340 - DEBUG - GET request to: https://dbc-df998298-4c7e.cloud.databricks.com/api/2.1/unity-catalog/catalogs?max_results=1
2025-06-07 12:52:16,341 - DEBUG - Starting new HTTPS connection (1): dbc-df998298-4c7e.cloud.databricks.com:443
2025-06-07 12:52:16,500 - DEBUG - https://dbc-df998298-4c7e.cloud.databricks.com:443 "GET /api/2.1/unity-catalog/catalogs?max_results=1 HTTP/1.1" 200 None
2025-06-07 12:52:16,501 - DEBUG - GET request to: https://dbc-df998298-4c7e.cloud.databricks.com/api/2.1/unity-catalog/schemas?catalog_name=__databricks_internal&max_results=1
2025-06-07 12:52:16,502 - DEBUG - Starting new HTTPS connection (1): dbc-df998298-4c7e.cloud.databricks.com:443
2025-06-07 12:52:16,702 - DEBUG - https://dbc-df998298-4c7e.cloud.databricks.com:443 "GET /api/2.1/unity-catalog/schemas?catalog_name=__databricks_internal&max_results=1 HTTP/1.1" 200 None
2025-06-07 12:52:16,703 - DEBUG - GET request to: https://dbc-df998298-4c7e.cloud.databricks.com/api/2.1/unity-catalog/volumes?catalog_name=__databricks_internal&schema_name=__dlt_materialization_schema_16ba9f51_ef4e_43a2_bfe8_4a1a919fe7cd
2025-06-07 12:52:16,704 - DEBUG - Starting new HTTPS connection (1): dbc-df998298-4c7e.cloud.databricks.com:443
2025-06-07 12:52:16,856 - DEBUG - https://dbc-df998298-4c7e.cloud.databricks.com:443 "GET /api/2.1/unity-catalog/volumes?catalog_name=__databricks_internal&schema_name=__dlt_materialization_schema_16ba9f51_ef4e_43a2_bfe8_4a1a919fe7cd HTTP/1.1" 200 2
2025-06-07 12:52:16,856 - DEBUG - Tool 'status' executed successfully. Data: {'workspace_url': 'https://dbc-df998298-4c7e.cloud.databricks.com', 'active_catalog': 'john_test', 'active_schema': 'datatypes', 'active_model': 'databricks-meta-llama-3-3-70b-instruct', 'warehouse_id': '9b07e1f740586a24', 'connection_status': 'Connected (client present).', 'permissions': {'basic_connectivity': {'authorized': True, 'details': 'Connected as john.rush@amperity.com', 'api_path': '/api/2.0/preview/scim/v2/Me'}, 'unity_catalog': {'authorized': True, 'details': 'Unity Catalog access granted (1 catalogs visible)', 'api_path': '/api/2.1/unity-catalog/catalogs'}, 'sql_warehouse': {'authorized': True, 'details': 'SQL Warehouse access granted (6 warehouses visible)', 'api_path': '/api/2.0/sql/warehouses'}, 'jobs': {'authorized': True, 'details': 'Jobs access granted (1 jobs visible)', 'api_path': '/api/2.1/jobs/list'}, 'models': {'authorized': True, 'details': 'ML Models access granted (0 models visible)', 'api_path': '/api/2.0/mlflow/registered-models/list'}, 'volumes': {'authorized': True, 'details': 'Volumes access granted in __databricks_internal.__dlt_materialization_schema_16ba9f51_ef4e_43a2_bfe8_4a1a919fe7cd (0 volumes visible)', 'api_path': '/api/2.1/unity-catalog/volumes'}}}
2025-06-07 12:52:16,869 - DEBUG - connect_tcp.started host='dbc-df998298-4c7e.cloud.databricks.com' port=443 local_address=None timeout=5.0 socket_options=None
2025-06-07 12:52:16,893 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x108239e50>
2025-06-07 12:52:16,894 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x1081bd760> server_hostname='dbc-df998298-4c7e.cloud.databricks.com' timeout=5.0
2025-06-07 12:52:16,945 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x108200510>
2025-06-07 12:52:16,945 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2025-06-07 12:52:16,945 - DEBUG - send_request_headers.complete
2025-06-07 12:52:16,945 - DEBUG - send_request_body.started request=<Request [b'POST']>
2025-06-07 12:52:16,945 - DEBUG - send_request_body.complete
2025-06-07 12:52:16,945 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2025-06-07 12:52:26,287 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'content-type', b'application/json; charset=utf-8'), (b'server', b'databricks'), (b'date', b'Sat, 7 Jun 2025 19:52:26 GMT'), (b'x-databricks-org-id', b'3416276235813320'), (b'x-request-id', b'133f58c1-b04e-4b42-8dc8-9ca41c0c367b'), (b'content-encoding', b'gzip'), (b'vary', b'Accept-Encoding'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'x-content-type-options', b'nosniff'), (b'transfer-encoding', b'chunked')])
2025-06-07 12:52:26,287 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2025-06-07 12:52:26,287 - DEBUG - receive_response_body.complete
2025-06-07 12:52:26,287 - DEBUG - response_closed.started
2025-06-07 12:52:26,288 - DEBUG - response_closed.complete
2025-06-07 12:52:26,288 - DEBUG - Sending metric: {"event": "USAGE", "configuration": {"workspace_url": "https://dbc-df998298-4c7e.cloud.databricks.co...
2025-06-07 12:52:26,289 - DEBUG - Starting new HTTPS connection (1): chuck.amperity.com:443
2025-06-07 12:52:26,850 - DEBUG - https://chuck.amperity.com:443 "POST /api/usage HTTP/1.1" 204 0
2025-06-07 12:52:26,850 - DEBUG - Failed to send metrics: 204 - 
2025-06-07 12:52:26,852 - DEBUG - Using selector: KqueueSelector
2025-06-07 12:54:03,032 - DEBUG - close.started
2025-06-07 12:54:03,034 - DEBUG - close.complete
2025-06-07 12:54:10,590 - DEBUG - connect_tcp.started host='dbc-df998298-4c7e.cloud.databricks.com' port=443 local_address=None timeout=5.0 socket_options=None
2025-06-07 12:54:10,612 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x108200e90>
2025-06-07 12:54:10,612 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x1081be2a0> server_hostname='dbc-df998298-4c7e.cloud.databricks.com' timeout=5.0
2025-06-07 12:54:10,652 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x108114b90>
2025-06-07 12:54:10,652 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2025-06-07 12:54:10,653 - DEBUG - send_request_headers.complete
2025-06-07 12:54:10,653 - DEBUG - send_request_body.started request=<Request [b'POST']>
2025-06-07 12:54:10,653 - DEBUG - send_request_body.complete
2025-06-07 12:54:10,653 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2025-06-07 12:54:17,301 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'content-type', b'application/json; charset=utf-8'), (b'server', b'databricks'), (b'date', b'Sat, 7 Jun 2025 19:54:17 GMT'), (b'x-databricks-org-id', b'3416276235813320'), (b'x-request-id', b'd872e73f-fe7e-4bdf-8cef-7a1fb3889975'), (b'content-encoding', b'gzip'), (b'vary', b'Accept-Encoding'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'x-content-type-options', b'nosniff'), (b'transfer-encoding', b'chunked')])
2025-06-07 12:54:17,302 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2025-06-07 12:54:17,302 - DEBUG - receive_response_body.complete
2025-06-07 12:54:17,302 - DEBUG - response_closed.started
2025-06-07 12:54:17,302 - DEBUG - response_closed.complete
2025-06-07 12:54:17,303 - DEBUG - Sending metric: {"event": "USAGE", "configuration": {"workspace_url": "https://dbc-df998298-4c7e.cloud.databricks.co...
2025-06-07 12:54:17,306 - DEBUG - Starting new HTTPS connection (1): chuck.amperity.com:443
2025-06-07 12:54:17,470 - DEBUG - https://chuck.amperity.com:443 "POST /api/usage HTTP/1.1" 204 0
2025-06-07 12:54:17,470 - DEBUG - Failed to send metrics: 204 - 
2025-06-07 12:54:17,473 - DEBUG - Using selector: KqueueSelector
2025-06-07 12:54:17,511 - DEBUG - Using selector: KqueueSelector
2025-06-07 12:54:49,794 - DEBUG - close.started
2025-06-07 12:54:49,796 - DEBUG - close.complete
2025-06-07 12:54:50,447 - DEBUG - connect_tcp.started host='dbc-df998298-4c7e.cloud.databricks.com' port=443 local_address=None timeout=5.0 socket_options=None
2025-06-07 12:54:50,500 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x107fe86b0>
2025-06-07 12:54:50,500 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x1081bd910> server_hostname='dbc-df998298-4c7e.cloud.databricks.com' timeout=5.0
2025-06-07 12:54:50,552 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x1081f4e20>
2025-06-07 12:54:50,552 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2025-06-07 12:54:50,552 - DEBUG - send_request_headers.complete
2025-06-07 12:54:50,552 - DEBUG - send_request_body.started request=<Request [b'POST']>
2025-06-07 12:54:50,553 - DEBUG - send_request_body.complete
2025-06-07 12:54:50,553 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2025-06-07 12:54:51,697 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'content-type', b'application/json; charset=utf-8'), (b'server', b'databricks'), (b'date', b'Sat, 7 Jun 2025 19:54:51 GMT'), (b'x-databricks-org-id', b'3416276235813320'), (b'x-request-id', b'561ad5ef-2bc9-460c-9124-cd6ff3746c76'), (b'content-encoding', b'gzip'), (b'vary', b'Accept-Encoding'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'x-content-type-options', b'nosniff'), (b'transfer-encoding', b'chunked')])
2025-06-07 12:54:51,697 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2025-06-07 12:54:51,697 - DEBUG - receive_response_body.complete
2025-06-07 12:54:51,697 - DEBUG - response_closed.started
2025-06-07 12:54:51,697 - DEBUG - response_closed.complete
2025-06-07 12:54:51,698 - DEBUG - Agent attempting to execute tool: scan-schema-for-pii with args: {'catalog_name': 'john_test', 'schema_name': 'datatypes'}
2025-06-07 12:54:51,698 - DEBUG - Tool arguments for 'scan-schema-for-pii' validated successfully.
2025-06-07 12:54:51,698 - DEBUG - Executing agent tool 'scan-schema-for-pii' with handler: handle_command
2025-06-07 12:54:51,698 - DEBUG - GET request with params to: https://dbc-df998298-4c7e.cloud.databricks.com/api/2.1/unity-catalog/tables
2025-06-07 12:54:51,699 - DEBUG - Starting new HTTPS connection (1): dbc-df998298-4c7e.cloud.databricks.com:443
2025-06-07 12:54:51,918 - DEBUG - https://dbc-df998298-4c7e.cloud.databricks.com:443 "GET /api/2.1/unity-catalog/tables?catalog_name=john_test&schema_name=datatypes&omit_columns=true HTTP/1.1" 200 None
2025-06-07 12:54:51,919 - INFO - Starting PII Scan for 2 tables in john_test.datatypes.
2025-06-07 12:54:51,920 - DEBUG - GET request to: https://dbc-df998298-4c7e.cloud.databricks.com/api/2.1/unity-catalog/tables/john_test.datatypes.customers_pii_demo
2025-06-07 12:54:51,920 - DEBUG - GET request to: https://dbc-df998298-4c7e.cloud.databricks.com/api/2.1/unity-catalog/tables/john_test.datatypes.customers_pii_demo2
2025-06-07 12:54:51,921 - DEBUG - Starting new HTTPS connection (1): dbc-df998298-4c7e.cloud.databricks.com:443
2025-06-07 12:54:51,921 - DEBUG - Starting new HTTPS connection (1): dbc-df998298-4c7e.cloud.databricks.com:443
2025-06-07 12:54:52,088 - DEBUG - https://dbc-df998298-4c7e.cloud.databricks.com:443 "GET /api/2.1/unity-catalog/tables/john_test.datatypes.customers_pii_demo HTTP/1.1" 200 None
2025-06-07 12:54:52,094 - DEBUG - connect_tcp.started host='dbc-df998298-4c7e.cloud.databricks.com' port=443 local_address=None timeout=5.0 socket_options=None
2025-06-07 12:54:52,102 - DEBUG - https://dbc-df998298-4c7e.cloud.databricks.com:443 "GET /api/2.1/unity-catalog/tables/john_test.datatypes.customers_pii_demo2 HTTP/1.1" 200 None
2025-06-07 12:54:52,107 - DEBUG - close.started
2025-06-07 12:54:52,108 - DEBUG - close.complete
2025-06-07 12:54:52,108 - DEBUG - connect_tcp.started host='dbc-df998298-4c7e.cloud.databricks.com' port=443 local_address=None timeout=5.0 socket_options=None
2025-06-07 12:54:52,119 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x1081abe50>
2025-06-07 12:54:52,119 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x1081be450> server_hostname='dbc-df998298-4c7e.cloud.databricks.com' timeout=5.0
2025-06-07 12:54:52,133 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x1082c8050>
2025-06-07 12:54:52,133 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x1081bd760> server_hostname='dbc-df998298-4c7e.cloud.databricks.com' timeout=5.0
2025-06-07 12:54:52,164 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x108255040>
2025-06-07 12:54:52,164 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2025-06-07 12:54:52,164 - DEBUG - send_request_headers.complete
2025-06-07 12:54:52,164 - DEBUG - send_request_body.started request=<Request [b'POST']>
2025-06-07 12:54:52,164 - DEBUG - send_request_body.complete
2025-06-07 12:54:52,164 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2025-06-07 12:54:52,184 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x108255130>
2025-06-07 12:54:52,184 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2025-06-07 12:54:52,184 - DEBUG - send_request_headers.complete
2025-06-07 12:54:52,184 - DEBUG - send_request_body.started request=<Request [b'POST']>
2025-06-07 12:54:52,184 - DEBUG - send_request_body.complete
2025-06-07 12:54:52,184 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2025-06-07 12:54:54,890 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'content-type', b'application/json; charset=utf-8'), (b'server', b'databricks'), (b'date', b'Sat, 7 Jun 2025 19:54:54 GMT'), (b'x-databricks-org-id', b'3416276235813320'), (b'x-request-id', b'c258739f-3c2a-4a4d-95a2-e8a0ab8e5455'), (b'content-encoding', b'gzip'), (b'vary', b'Accept-Encoding'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'x-content-type-options', b'nosniff'), (b'transfer-encoding', b'chunked')])
2025-06-07 12:54:54,892 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2025-06-07 12:54:54,893 - DEBUG - receive_response_body.complete
2025-06-07 12:54:54,893 - DEBUG - response_closed.started
2025-06-07 12:54:54,894 - DEBUG - response_closed.complete
2025-06-07 12:54:55,547 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'content-type', b'application/json; charset=utf-8'), (b'server', b'databricks'), (b'date', b'Sat, 7 Jun 2025 19:54:55 GMT'), (b'x-databricks-org-id', b'3416276235813320'), (b'x-request-id', b'ec58b700-f5fc-4fe6-8bdd-2680988bb376'), (b'content-encoding', b'gzip'), (b'vary', b'Accept-Encoding'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'x-content-type-options', b'nosniff'), (b'transfer-encoding', b'chunked')])
2025-06-07 12:54:55,548 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2025-06-07 12:54:55,548 - DEBUG - receive_response_body.complete
2025-06-07 12:54:55,548 - DEBUG - response_closed.started
2025-06-07 12:54:55,548 - DEBUG - response_closed.complete
2025-06-07 12:54:55,550 - DEBUG - Tool 'scan-schema-for-pii' executed successfully. Data: {'catalog': 'john_test', 'schema': 'datatypes', 'tables_scanned_attempted': 2, 'tables_successfully_processed': 2, 'tables_with_pii': 2, 'total_pii_columns': 13, 'results_detail': [{'table_name': 'customers_pii_demo', 'full_name': 'john_test.datatypes.customers_pii_demo', 'column_count': 15, 'pii_column_count': 6, 'has_pii': True, 'columns': [{'name': 'customer_id', 'type': 'LONG', 'semantic': None}, {'name': 'first_name', 'type': 'STRING', 'semantic': 'given-name'}, {'name': 'last_name', 'type': 'STRING', 'semantic': 'surname'}, {'name': 'email', 'type': 'STRING', 'semantic': 'email'}, {'name': 'phone_e164', 'type': 'CHAR', 'semantic': 'phone'}, {'name': 'date_of_birth', 'type': 'DATE', 'semantic': 'birthdate'}, {'name': 'signup_timestamp', 'type': 'TIMESTAMP', 'semantic': 'create-dt'}, {'name': 'signup_interval', 'type': 'STRING', 'semantic': None}, {'name': 'segments', 'type': 'STRUCT', 'semantic': None}, {'name': 'preferences', 'type': 'MAP', 'semantic': None}, {'name': 'raw_json', 'type': 'STRING', 'semantic': None}, {'name': 'balance_usd', 'type': 'DECIMAL', 'semantic': None}, {'name': 'is_opted_in', 'type': 'BOOLEAN', 'semantic': None}, {'name': 'sha_id', 'type': 'BINARY', 'semantic': None}, {'name': 'null_placeholder', 'type': 'NULL', 'semantic': None}], 'pii_columns': [{'name': 'first_name', 'type': 'STRING', 'semantic': 'given-name'}, {'name': 'last_name', 'type': 'STRING', 'semantic': 'surname'}, {'name': 'email', 'type': 'STRING', 'semantic': 'email'}, {'name': 'phone_e164', 'type': 'CHAR', 'semantic': 'phone'}, {'name': 'date_of_birth', 'type': 'DATE', 'semantic': 'birthdate'}, {'name': 'signup_timestamp', 'type': 'TIMESTAMP', 'semantic': 'create-dt'}], 'skipped': False}, {'table_name': 'customers_pii_demo2', 'full_name': 'john_test.datatypes.customers_pii_demo2', 'column_count': 18, 'pii_column_count': 7, 'has_pii': True, 'columns': [{'name': 'customer_id', 'type': 'LONG', 'semantic': None}, {'name': 'first_name', 'type': 'STRING', 'semantic': 'given-name'}, {'name': 'last_name', 'type': 'STRING', 'semantic': 'surname'}, {'name': 'email', 'type': 'STRING', 'semantic': 'email'}, {'name': 'phone_e164', 'type': 'STRING', 'semantic': 'phone'}, {'name': 'date_of_birth', 'type': 'DATE', 'semantic': 'birthdate'}, {'name': 'signup_timestamp', 'type': 'TIMESTAMP', 'semantic': 'create-dt'}, {'name': 'signup_timestamp_ntz', 'type': 'TIMESTAMP_NTZ', 'semantic': 'create-dt'}, {'name': 'signup_interval', 'type': 'INT', 'semantic': None}, {'name': 'segments', 'type': 'STRUCT', 'semantic': None}, {'name': 'preferences', 'type': 'STRUCT', 'semantic': None}, {'name': 'raw_json', 'type': 'STRING', 'semantic': None}, {'name': 'home_geog_wkt', 'type': 'STRING', 'semantic': None}, {'name': 'route_geom_wkt', 'type': 'STRING', 'semantic': None}, {'name': 'balance_usd', 'type': 'DOUBLE', 'semantic': None}, {'name': 'is_opted_in', 'type': 'BOOLEAN', 'semantic': None}, {'name': 'sha_id', 'type': 'BINARY', 'semantic': None}, {'name': 'null_placeholder', 'type': 'INT', 'semantic': None}], 'pii_columns': [{'name': 'first_name', 'type': 'STRING', 'semantic': 'given-name'}, {'name': 'last_name', 'type': 'STRING', 'semantic': 'surname'}, {'name': 'email', 'type': 'STRING', 'semantic': 'email'}, {'name': 'phone_e164', 'type': 'STRING', 'semantic': 'phone'}, {'name': 'date_of_birth', 'type': 'DATE', 'semantic': 'birthdate'}, {'name': 'signup_timestamp', 'type': 'TIMESTAMP', 'semantic': 'create-dt'}, {'name': 'signup_timestamp_ntz', 'type': 'TIMESTAMP_NTZ', 'semantic': 'create-dt'}], 'skipped': False}]}
2025-06-07 12:54:55,590 - DEBUG - connect_tcp.started host='dbc-df998298-4c7e.cloud.databricks.com' port=443 local_address=None timeout=5.0 socket_options=None
2025-06-07 12:54:55,615 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x108234e50>
2025-06-07 12:54:55,616 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x1081bdd90> server_hostname='dbc-df998298-4c7e.cloud.databricks.com' timeout=5.0
2025-06-07 12:54:55,656 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x1082358d0>
2025-06-07 12:54:55,656 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2025-06-07 12:54:55,656 - DEBUG - send_request_headers.complete
2025-06-07 12:54:55,656 - DEBUG - send_request_body.started request=<Request [b'POST']>
2025-06-07 12:54:55,657 - DEBUG - send_request_body.complete
2025-06-07 12:54:55,657 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2025-06-07 12:54:59,279 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'content-type', b'application/json; charset=utf-8'), (b'server', b'databricks'), (b'date', b'Sat, 7 Jun 2025 19:54:59 GMT'), (b'x-databricks-org-id', b'3416276235813320'), (b'x-request-id', b'd11e8e0d-baf7-46d9-92f9-3a78b1611fef'), (b'content-encoding', b'gzip'), (b'vary', b'Accept-Encoding'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'x-content-type-options', b'nosniff'), (b'transfer-encoding', b'chunked')])
2025-06-07 12:54:59,280 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2025-06-07 12:54:59,280 - DEBUG - receive_response_body.complete
2025-06-07 12:54:59,280 - DEBUG - response_closed.started
2025-06-07 12:54:59,280 - DEBUG - response_closed.complete
2025-06-07 12:54:59,281 - DEBUG - Sending metric: {"event": "USAGE", "configuration": {"workspace_url": "https://dbc-df998298-4c7e.cloud.databricks.co...
2025-06-07 12:54:59,282 - DEBUG - Starting new HTTPS connection (1): chuck.amperity.com:443
2025-06-07 12:54:59,408 - DEBUG - https://chuck.amperity.com:443 "POST /api/usage HTTP/1.1" 204 0
2025-06-07 12:54:59,408 - DEBUG - Failed to send metrics: 204 - 
2025-06-07 12:54:59,413 - DEBUG - Using selector: KqueueSelector
