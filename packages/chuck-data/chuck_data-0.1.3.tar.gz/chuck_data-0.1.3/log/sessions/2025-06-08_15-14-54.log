2025-06-08 15:14:54,578 - DEBUG - Logging initialized. Writing to /Users/johnrush/repos/chuck-data/log/sessions/2025-06-08_15-14-54.log
2025-06-08 15:14:54,583 - DEBUG - GET request to: https://test-workspace.cloud.databricks.com/test-endpoint
2025-06-08 15:14:54,584 - DEBUG - GET request to: https://test-workspace.cloud.databricks.com/test-endpoint
2025-06-08 15:14:54,584 - DEBUG - HTTP error: HTTP 404, Response: Not Found
2025-06-08 15:14:54,585 - DEBUG - GET request to: https://test-workspace.cloud.databricks.com/test-endpoint
2025-06-08 15:14:54,585 - DEBUG - Connection error: Connection failed
2025-06-08 15:14:54,586 - DEBUG - POST request to: https://test-workspace.cloud.databricks.com/test-endpoint
2025-06-08 15:14:54,588 - DEBUG - POST request to: https://test-workspace.cloud.databricks.com/test-endpoint
2025-06-08 15:14:54,588 - DEBUG - HTTP error: HTTP 400, Response: Bad Request
2025-06-08 15:14:54,589 - DEBUG - POST request to: https://test-workspace.cloud.databricks.com/test-endpoint
2025-06-08 15:14:54,589 - DEBUG - Connection error: Connection failed
2025-06-08 15:14:54,590 - DEBUG - HTTP error: HTTP 401, Response: {"status":401,"message":"Unauthorized"}
2025-06-08 15:14:54,593 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpfzovuejm/test_config.json
2025-06-08 15:14:54,593 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpfzovuejm/test_config.json
2025-06-08 15:14:54,595 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp455e6i5h/test_config.json
2025-06-08 15:14:54,595 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp455e6i5h/test_config.json
2025-06-08 15:14:54,596 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp1sd5ijnx/test_config.json
2025-06-08 15:14:54,596 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp1sd5ijnx/test_config.json
2025-06-08 15:14:54,597 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp1sd5ijnx/test_config.json
2025-06-08 15:14:54,597 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp1sd5ijnx/test_config.json
2025-06-08 15:14:54,597 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp1sd5ijnx/test_config.json
2025-06-08 15:14:54,597 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp1sd5ijnx/test_config.json
2025-06-08 15:14:54,597 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp1sd5ijnx/test_config.json
2025-06-08 15:14:54,597 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp1sd5ijnx/test_config.json
2025-06-08 15:14:54,598 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp1sd5ijnx/test_config.json
2025-06-08 15:14:54,598 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp1sd5ijnx/test_config.json
2025-06-08 15:14:54,598 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp1sd5ijnx/test_config.json
2025-06-08 15:14:54,598 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp1sd5ijnx/test_config.json
2025-06-08 15:14:54,598 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp1sd5ijnx/test_config.json
2025-06-08 15:14:54,598 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp1sd5ijnx/test_config.json
2025-06-08 15:14:54,598 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp1sd5ijnx/test_config.json
2025-06-08 15:14:54,600 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpo9c8tx90/test_config.json
2025-06-08 15:14:54,600 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpo9c8tx90/test_config.json
2025-06-08 15:14:54,600 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpo9c8tx90/test_config.json
2025-06-08 15:14:54,600 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpo9c8tx90/test_config.json
2025-06-08 15:14:54,600 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpo9c8tx90/test_config.json
2025-06-08 15:14:54,601 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpo9c8tx90/test_config.json
2025-06-08 15:14:54,601 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpo9c8tx90/test_config.json
2025-06-08 15:14:54,601 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpo9c8tx90/test_config.json
2025-06-08 15:14:54,601 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpo9c8tx90/test_config.json
2025-06-08 15:14:54,601 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpo9c8tx90/test_config.json
2025-06-08 15:14:54,602 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpo9c8tx90/test_config.json
2025-06-08 15:14:54,602 - DEBUG - Using workspace_url from environment variable CHUCK_WORKSPACE_URL
2025-06-08 15:14:54,602 - DEBUG - Using active_model from environment variable CHUCK_ACTIVE_MODEL
2025-06-08 15:14:54,602 - DEBUG - Using warehouse_id from environment variable CHUCK_WAREHOUSE_ID
2025-06-08 15:14:54,602 - DEBUG - Using active_catalog from environment variable CHUCK_ACTIVE_CATALOG
2025-06-08 15:14:54,602 - DEBUG - Using active_schema from environment variable CHUCK_ACTIVE_SCHEMA
2025-06-08 15:14:54,603 - ERROR - Config file is corrupted. Using default config.
2025-06-08 15:14:54,604 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmphbuj087_/test_config.json
2025-06-08 15:14:54,606 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpll7sb_mi/test_config.json
2025-06-08 15:14:54,606 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpll7sb_mi/test_config.json
2025-06-08 15:14:54,606 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpll7sb_mi/test_config.json
2025-06-08 15:14:54,606 - DEBUG - Using databricks_token from environment variable CHUCK_DATABRICKS_TOKEN
2025-06-08 15:14:54,607 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp5da57r4e/test_config.json
2025-06-08 15:14:54,608 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp5da57r4e/test_config.json
2025-06-08 15:14:54,608 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp5da57r4e/test_config.json
2025-06-08 15:14:54,608 - DEBUG - Using workspace_url from environment variable CHUCK_WORKSPACE_URL
2025-06-08 15:14:54,609 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpyvv7q_hu/test_config.json
2025-06-08 15:14:54,610 - ERROR - Config file is corrupted. Using default config.
2025-06-08 15:14:54,611 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp_cggwd0w
2025-06-08 15:14:54,611 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp_cggwd0w
2025-06-08 15:14:54,612 - ERROR - Config file is corrupted. Using default config.
2025-06-08 15:14:54,612 - DEBUG - Using workspace_url from environment variable CHUCK_WORKSPACE_URL
2025-06-08 15:14:54,612 - DEBUG - Using active_model from environment variable CHUCK_ACTIVE_MODEL
2025-06-08 15:14:54,612 - DEBUG - Using warehouse_id from environment variable CHUCK_WAREHOUSE_ID
2025-06-08 15:14:54,613 - DEBUG - Using active_catalog from environment variable CHUCK_ACTIVE_CATALOG
2025-06-08 15:14:54,613 - DEBUG - Using active_schema from environment variable CHUCK_ACTIVE_SCHEMA
2025-06-08 15:14:54,613 - DEBUG - Using amperity_token from environment variable CHUCK_AMPERITY_TOKEN
2025-06-08 15:14:54,613 - DEBUG - Using databricks_token from environment variable CHUCK_DATABRICKS_TOKEN
2025-06-08 15:14:54,613 - DEBUG - Using usage_tracking_consent from environment variable CHUCK_USAGE_TRACKING_CONSENT
2025-06-08 15:14:54,614 - ERROR - Config file is corrupted. Using default config.
2025-06-08 15:14:54,615 - ERROR - Config file is corrupted. Using default config.
2025-06-08 15:14:54,615 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp0hc_46mv
2025-06-08 15:14:54,616 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp0hc_46mv
2025-06-08 15:14:54,617 - ERROR - Config file is corrupted. Using default config.
2025-06-08 15:14:54,617 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpe_bl7j5r
2025-06-08 15:14:54,618 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpe_bl7j5r
2025-06-08 15:14:54,619 - ERROR - Config file is corrupted. Using default config.
2025-06-08 15:14:54,619 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpmrt9buik
2025-06-08 15:14:54,620 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpmrt9buik
2025-06-08 15:14:54,620 - ERROR - Connection error during token validation: Network error
2025-06-08 15:14:54,621 - ERROR - Config file is corrupted. Using default config.
2025-06-08 15:14:54,621 - INFO - Using Databricks token from environment variable. Consider using /set-token to save it to config.
2025-06-08 15:14:54,622 - ERROR - Config file is corrupted. Using default config.
2025-06-08 15:14:54,622 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpz4giwsdh
2025-06-08 15:14:54,622 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpz4giwsdh
2025-06-08 15:14:54,623 - ERROR - Config file is corrupted. Using default config.
2025-06-08 15:14:54,624 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpcac9uvmv
2025-06-08 15:14:54,624 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpcac9uvmv
2025-06-08 15:14:54,628 - DEBUG - GET request to: https://adb-3856707039489412.12.azuredatabricks.net/test-endpoint
2025-06-08 15:14:54,632 - DEBUG - GET request to: https://test-workspace.cloud.databricks.com/test-endpoint
2025-06-08 15:14:54,633 - DEBUG - GET request to: https://test-workspace.cloud.databricks.com/test-endpoint
2025-06-08 15:14:54,634 - DEBUG - HTTP error: HTTP 404, Response: Not Found
2025-06-08 15:14:54,635 - DEBUG - GET request to: https://test-workspace.cloud.databricks.com/test-endpoint
2025-06-08 15:14:54,635 - DEBUG - Connection error: Connection failed
2025-06-08 15:14:54,636 - DEBUG - POST request to: https://test-workspace.cloud.databricks.com/test-endpoint
2025-06-08 15:14:54,637 - DEBUG - POST request to: https://test-workspace.cloud.databricks.com/test-endpoint
2025-06-08 15:14:54,637 - DEBUG - HTTP error: HTTP 400, Response: Bad Request
2025-06-08 15:14:54,638 - DEBUG - POST request to: https://test-workspace.cloud.databricks.com/test-endpoint
2025-06-08 15:14:54,638 - DEBUG - Connection error: Connection failed
2025-06-08 15:14:54,640 - DEBUG - Token validation failed: Token validation failed
2025-06-08 15:14:54,643 - DEBUG - File upload request to: https://test-workspace.cloud.databricks.com/api/2.0/fs/files/test/path.txt
2025-06-08 15:14:54,645 - DEBUG - File upload request to: https://test-workspace.cloud.databricks.com/api/2.0/fs/files/test/path.txt
2025-06-08 15:14:54,649 - WARNING - Model 'nonexistent-model' not found
2025-06-08 15:14:54,655 - ERROR - Config file is corrupted. Using default config.
2025-06-08 15:14:54,655 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmprg7nh6op
2025-06-08 15:14:54,656 - DEBUG - Metrics tracking skipped - user has not provided consent
2025-06-08 15:14:54,657 - ERROR - Config file is corrupted. Using default config.
2025-06-08 15:14:54,657 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpdrx23ado
2025-06-08 15:14:54,659 - ERROR - Config file is corrupted. Using default config.
2025-06-08 15:14:54,659 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpzlli_iyd
2025-06-08 15:14:54,659 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpzlli_iyd
2025-06-08 15:14:54,659 - DEBUG - Sending metric: {"event": "USAGE", "prompt": "test prompt"}...
2025-06-08 15:14:54,660 - ERROR - Config file is corrupted. Using default config.
2025-06-08 15:14:54,661 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpm6zp8ya_
2025-06-08 15:14:54,661 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpm6zp8ya_
2025-06-08 15:14:54,661 - DEBUG - Sending metric: {"event": "USAGE", "prompt": "test prompt"}...
2025-06-08 15:14:54,662 - ERROR - Config file is corrupted. Using default config.
2025-06-08 15:14:54,662 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpn25qd5ko
2025-06-08 15:14:54,662 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpn25qd5ko
2025-06-08 15:14:54,663 - DEBUG - Sending metric: {"event": "USAGE", "prompt": "test prompt"}...
2025-06-08 15:14:54,663 - DEBUG - Error sending metrics: Test exception
Traceback (most recent call last):
  File "/Users/johnrush/repos/chuck-data/chuck_data/metrics_collector.py", line 123, in send_metric
    return self._client.submit_metrics(payload, token)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnrush/repos/chuck-data/tests/fixtures/amperity.py", line 60, in submit_metrics
    raise Exception("Test exception")
Exception: Test exception
2025-06-08 15:14:54,664 - ERROR - Config file is corrupted. Using default config.
2025-06-08 15:14:54,664 - DEBUG - Cannot send metrics - no authentication token available
2025-06-08 15:14:54,668 - ERROR - Failed to list models: HTTP error occurred: 404 Not Found
2025-06-08 15:14:54,670 - ERROR - Connection error when listing models: Connection failed
2025-06-08 15:14:54,672 - ERROR - Failed to get model: HTTP error occurred: 500 Internal Server Error
2025-06-08 15:14:54,673 - ERROR - Connection error when getting model: Connection failed
2025-06-08 15:14:54,683 - DEBUG - Unity Catalog check failed: Access denied
2025-06-08 15:14:54,683 - DEBUG - Jobs check failed: Forbidden
2025-06-08 15:14:54,683 - DEBUG - Volumes check failed: Access denied
2025-06-08 15:14:54,734 - DEBUG - Executing SQL: SELECT * FROM table
2025-06-08 15:14:54,735 - DEBUG - Executing SQL: SELECT * FROM table
2025-06-08 15:14:54,736 - DEBUG - Executing SQL: SELECT * FROM table
2025-06-08 15:14:54,737 - DEBUG - Executing SQL: SELECT * FROM table
2025-06-08 15:14:54,738 - DEBUG - Executing SQL: SELECT * INVALID SQL
2025-06-08 15:14:54,739 - DEBUG - Executing SQL: SELECT * INVALID SQL
