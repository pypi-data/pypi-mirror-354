2025-06-05 15:07:25,219 - DEBUG - Logging initialized. Writing to /Users/johnrush/repos/chuck-data/log/sessions/2025-06-05_15-07-25.log
2025-06-05 15:07:25,221 - DEBUG - Loaded configuration from /Users/johnrush/.chuck_config.json
2025-06-05 15:07:25,241 - DEBUG - Using selector: KqueueSelector
2025-06-05 15:07:27,765 - DEBUG - connect_tcp.started host='dbc-df998298-4c7e.cloud.databricks.com' port=443 local_address=None timeout=5.0 socket_options=None
2025-06-05 15:07:27,849 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x105f7e510>
2025-06-05 15:07:27,849 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x105efb890> server_hostname='dbc-df998298-4c7e.cloud.databricks.com' timeout=5.0
2025-06-05 15:07:27,896 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x105dcfc50>
2025-06-05 15:07:27,896 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2025-06-05 15:07:27,896 - DEBUG - send_request_headers.complete
2025-06-05 15:07:27,896 - DEBUG - send_request_body.started request=<Request [b'POST']>
2025-06-05 15:07:27,896 - DEBUG - send_request_body.complete
2025-06-05 15:07:27,896 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2025-06-05 15:07:30,589 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'x-amzn-requestid', b'27e03982-3325-445c-8a6c-e28abef57aa9'), (b'x-amzn-bedrock-invocation-latency', b'2486'), (b'x-amzn-bedrock-output-token-count', b'63'), (b'x-amzn-bedrock-input-token-count', b'4147'), (b'content-type', b'application/json'), (b'date', b'Thu, 5 Jun 2025 22:07:30 GMT'), (b'x-databricks-org-id', b'3416276235813320'), (b'x-request-id', b'6ae665ac-b732-459a-9f0e-af9ee559fa77'), (b'content-encoding', b'gzip'), (b'vary', b'Accept-Encoding'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'x-content-type-options', b'nosniff'), (b'server', b'databricks'), (b'transfer-encoding', b'chunked')])
2025-06-05 15:07:30,590 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2025-06-05 15:07:30,590 - DEBUG - receive_response_body.complete
2025-06-05 15:07:30,590 - DEBUG - response_closed.started
2025-06-05 15:07:30,590 - DEBUG - response_closed.complete
2025-06-05 15:07:30,592 - DEBUG - Agent attempting to execute tool: list-warehouses with args: {}
2025-06-05 15:07:30,593 - DEBUG - Tool arguments for 'list-warehouses' validated successfully.
2025-06-05 15:07:30,593 - DEBUG - Executing agent tool 'list-warehouses' with handler: handle_command
2025-06-05 15:07:30,593 - DEBUG - GET request to: https://dbc-df998298-4c7e.cloud.databricks.com/api/2.0/sql/warehouses
2025-06-05 15:07:30,596 - DEBUG - Starting new HTTPS connection (1): dbc-df998298-4c7e.cloud.databricks.com:443
2025-06-05 15:07:30,883 - DEBUG - https://dbc-df998298-4c7e.cloud.databricks.com:443 "GET /api/2.0/sql/warehouses HTTP/1.1" 200 None
2025-06-05 15:07:30,883 - DEBUG - Tool 'list-warehouses' executed successfully. Data: {'warehouses': [{'id': '1bfc8803d32a69c3', 'name': 'Perlovsky Chuck Testing', 'size': 'XLARGE', 'state': 'STOPPED', 'creator_name': 'daniel.perlovsky@amperity.com', 'auto_stop_mins': 10, 'enable_serverless_compute': True, 'warehouse_type': 'PRO'}, {'id': '865b9b2dc901775c', 'name': 'Christian Serverless Compute', 'size': 'XLARGE', 'state': 'STOPPED', 'creator_name': 'christian.saffici@amperity.com', 'auto_stop_mins': 10, 'enable_serverless_compute': True, 'warehouse_type': 'PRO'}, {'id': '9b07e1f740586a24', 'name': 'Integration tests', 'size': 'XXSMALL', 'state': 'STOPPED', 'creator_name': 'john.rush@amperity.com', 'auto_stop_mins': 10, 'enable_serverless_compute': True, 'warehouse_type': 'PRO'}, {'id': 'aaa2993b572dcf34', 'name': 'Parker Chuck Testing', 'size': 'XLARGE', 'state': 'STOPPED', 'creator_name': 'jeff.parker@amperity.com', 'auto_stop_mins': 10, 'enable_serverless_compute': True, 'warehouse_type': 'PRO'}, {'id': 'cda9d8187af3f951', 'name': "Carson's Chuck Data", 'size': 'XLARGE', 'state': 'STOPPED', 'creator_name': 'carson.crooks@amperity.com', 'auto_stop_mins': 10, 'enable_serverless_compute': True, 'warehouse_type': 'PRO'}, {'id': 'ed6a5cc30217adf0', 'name': 'Starter Warehouse', 'size': 'SMALL', 'state': 'STOPPED', 'creator_name': 'cary+databricks@amperity.com', 'auto_stop_mins': 60, 'enable_serverless_compute': False, 'warehouse_type': 'PRO'}], 'total_count': 6}
2025-06-05 15:07:30,889 - DEBUG - Using selector: KqueueSelector
2025-06-05 15:07:34,326 - DEBUG - GET request to: https://dbc-df998298-4c7e.cloud.databricks.com/api/2.0/sql/warehouses/Starter Warehouse
2025-06-05 15:07:34,327 - DEBUG - Starting new HTTPS connection (1): dbc-df998298-4c7e.cloud.databricks.com:443
2025-06-05 15:07:34,404 - DEBUG - https://dbc-df998298-4c7e.cloud.databricks.com:443 "GET /api/2.0/sql/warehouses/Starter%20Warehouse HTTP/1.1" 400 None
2025-06-05 15:07:34,404 - DEBUG - HTTP error: 400 Client Error: Bad Request for url: https://dbc-df998298-4c7e.cloud.databricks.com/api/2.0/sql/warehouses/Starter%20Warehouse, Response: {"error_code":"INVALID_PARAMETER_VALUE","message":"Starter Warehouse is not a valid endpoint id.","details":[{"@type":"type.googleapis.com/google.rpc.RequestInfo","request_id":"73043946-e06f-4402-8e19-c8aa51033483","serving_data":""}]}
2025-06-05 15:07:34,406 - DEBUG - Saved configuration to /Users/johnrush/.chuck_config.json
2025-06-05 15:07:34,406 - DEBUG - Using selector: KqueueSelector
2025-06-05 15:07:40,895 - DEBUG - GET request to: https://dbc-df998298-4c7e.cloud.databricks.com/api/2.0/sql/warehouses/ed6a5cc30217adf0
2025-06-05 15:07:40,896 - DEBUG - Starting new HTTPS connection (1): dbc-df998298-4c7e.cloud.databricks.com:443
2025-06-05 15:07:41,036 - DEBUG - https://dbc-df998298-4c7e.cloud.databricks.com:443 "GET /api/2.0/sql/warehouses/ed6a5cc30217adf0 HTTP/1.1" 200 None
2025-06-05 15:07:41,037 - DEBUG - Saved configuration to /Users/johnrush/.chuck_config.json
2025-06-05 15:07:41,038 - DEBUG - Using selector: KqueueSelector
2025-06-05 15:07:43,503 - DEBUG - connect_tcp.started host='dbc-df998298-4c7e.cloud.databricks.com' port=443 local_address=None timeout=5.0 socket_options=None
2025-06-05 15:07:43,520 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x10600da90>
2025-06-05 15:07:43,520 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x105f94b90> server_hostname='dbc-df998298-4c7e.cloud.databricks.com' timeout=5.0
2025-06-05 15:07:43,548 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x106000180>
2025-06-05 15:07:43,548 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2025-06-05 15:07:43,548 - DEBUG - send_request_headers.complete
2025-06-05 15:07:43,548 - DEBUG - send_request_body.started request=<Request [b'POST']>
2025-06-05 15:07:43,548 - DEBUG - send_request_body.complete
2025-06-05 15:07:43,548 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2025-06-05 15:07:46,340 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'x-amzn-requestid', b'af83b595-6896-4b0f-9a29-5224978144e5'), (b'x-amzn-bedrock-invocation-latency', b'2582'), (b'x-amzn-bedrock-output-token-count', b'64'), (b'x-amzn-bedrock-input-token-count', b'4153'), (b'content-type', b'application/json'), (b'date', b'Thu, 5 Jun 2025 22:07:46 GMT'), (b'x-databricks-org-id', b'3416276235813320'), (b'x-request-id', b'455a2ee0-2b77-4d77-83d8-c56961d27142'), (b'content-encoding', b'gzip'), (b'vary', b'Accept-Encoding'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'x-content-type-options', b'nosniff'), (b'server', b'databricks'), (b'transfer-encoding', b'chunked')])
2025-06-05 15:07:46,341 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2025-06-05 15:07:46,341 - DEBUG - receive_response_body.complete
2025-06-05 15:07:46,341 - DEBUG - response_closed.started
2025-06-05 15:07:46,341 - DEBUG - response_closed.complete
2025-06-05 15:07:46,342 - DEBUG - Agent attempting to execute tool: list-warehouses with args: {}
2025-06-05 15:07:46,343 - DEBUG - Tool arguments for 'list-warehouses' validated successfully.
2025-06-05 15:07:46,343 - DEBUG - Executing agent tool 'list-warehouses' with handler: handle_command
2025-06-05 15:07:46,343 - DEBUG - GET request to: https://dbc-df998298-4c7e.cloud.databricks.com/api/2.0/sql/warehouses
2025-06-05 15:07:46,344 - DEBUG - Starting new HTTPS connection (1): dbc-df998298-4c7e.cloud.databricks.com:443
2025-06-05 15:07:46,445 - DEBUG - https://dbc-df998298-4c7e.cloud.databricks.com:443 "GET /api/2.0/sql/warehouses HTTP/1.1" 200 None
2025-06-05 15:07:46,447 - DEBUG - Tool 'list-warehouses' executed successfully. Data: {'warehouses': [{'id': '1bfc8803d32a69c3', 'name': 'Perlovsky Chuck Testing', 'size': 'XLARGE', 'state': 'STOPPED', 'creator_name': 'daniel.perlovsky@amperity.com', 'auto_stop_mins': 10, 'enable_serverless_compute': True, 'warehouse_type': 'PRO'}, {'id': '865b9b2dc901775c', 'name': 'Christian Serverless Compute', 'size': 'XLARGE', 'state': 'STOPPED', 'creator_name': 'christian.saffici@amperity.com', 'auto_stop_mins': 10, 'enable_serverless_compute': True, 'warehouse_type': 'PRO'}, {'id': '9b07e1f740586a24', 'name': 'Integration tests', 'size': 'XXSMALL', 'state': 'STOPPED', 'creator_name': 'john.rush@amperity.com', 'auto_stop_mins': 10, 'enable_serverless_compute': True, 'warehouse_type': 'PRO'}, {'id': 'aaa2993b572dcf34', 'name': 'Parker Chuck Testing', 'size': 'XLARGE', 'state': 'STOPPED', 'creator_name': 'jeff.parker@amperity.com', 'auto_stop_mins': 10, 'enable_serverless_compute': True, 'warehouse_type': 'PRO'}, {'id': 'cda9d8187af3f951', 'name': "Carson's Chuck Data", 'size': 'XLARGE', 'state': 'STOPPED', 'creator_name': 'carson.crooks@amperity.com', 'auto_stop_mins': 10, 'enable_serverless_compute': True, 'warehouse_type': 'PRO'}, {'id': 'ed6a5cc30217adf0', 'name': 'Starter Warehouse', 'size': 'SMALL', 'state': 'STOPPED', 'creator_name': 'cary+databricks@amperity.com', 'auto_stop_mins': 60, 'enable_serverless_compute': False, 'warehouse_type': 'PRO'}], 'total_count': 6}
2025-06-05 15:07:46,453 - DEBUG - Using selector: KqueueSelector
2025-06-05 15:07:49,187 - DEBUG - close.started
2025-06-05 15:07:49,188 - DEBUG - close.complete
2025-06-05 15:07:49,188 - DEBUG - close.started
2025-06-05 15:07:49,188 - DEBUG - close.complete
