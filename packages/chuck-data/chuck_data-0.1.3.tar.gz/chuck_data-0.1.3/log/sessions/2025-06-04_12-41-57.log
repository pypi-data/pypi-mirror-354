2025-06-04 12:41:57,760 - DEBUG - Logging initialized. Writing to /Users/johnrush/repos/clamp-internal/log/sessions/2025-06-04_12-41-57.log
2025-06-04 12:41:57,761 - DEBUG - Loaded configuration from /Users/johnrush/.chuck_config.json
2025-06-04 12:41:57,767 - DEBUG - Using selector: KqueueSelector
2025-06-04 12:41:58,834 - DEBUG - GET request to: https://dbc-df998298-4c7e.cloud.databricks.com/api/2.1/unity-catalog/schemas/amperity_marketplace.bronze
2025-06-04 12:41:58,849 - DEBUG - Starting new HTTPS connection (1): dbc-df998298-4c7e.cloud.databricks.com:443
2025-06-04 12:41:59,007 - DEBUG - https://dbc-df998298-4c7e.cloud.databricks.com:443 "GET /api/2.1/unity-catalog/schemas/amperity_marketplace.bronze HTTP/1.1" 200 None
2025-06-04 12:41:59,010 - DEBUG - Saved configuration to /Users/johnrush/.chuck_config.json
2025-06-04 12:41:59,014 - DEBUG - Using selector: KqueueSelector
2025-06-04 12:41:59,108 - DEBUG - connect_tcp.started host='dbc-df998298-4c7e.cloud.databricks.com' port=443 local_address=None timeout=5.0 socket_options=None
2025-06-04 12:41:59,130 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x10b0856a0>
2025-06-04 12:41:59,130 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x1096ffc80> server_hostname='dbc-df998298-4c7e.cloud.databricks.com' timeout=5.0
2025-06-04 12:41:59,175 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x10b04ca50>
2025-06-04 12:41:59,175 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2025-06-04 12:41:59,175 - DEBUG - send_request_headers.complete
2025-06-04 12:41:59,175 - DEBUG - send_request_body.started request=<Request [b'POST']>
2025-06-04 12:41:59,175 - DEBUG - send_request_body.complete
2025-06-04 12:41:59,175 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2025-06-04 12:42:02,832 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'x-amzn-requestid', b'6f45158d-2f4f-47a5-9526-673411425039'), (b'x-amzn-bedrock-invocation-latency', b'3571'), (b'x-amzn-bedrock-output-token-count', b'96'), (b'x-amzn-bedrock-input-token-count', b'4157'), (b'content-type', b'application/json'), (b'date', b'Wed, 4 Jun 2025 19:42:02 GMT'), (b'x-databricks-org-id', b'3416276235813320'), (b'x-request-id', b'f0ae7e41-015b-4ee2-8f18-47e75379e047'), (b'content-encoding', b'gzip'), (b'vary', b'Accept-Encoding'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'x-content-type-options', b'nosniff'), (b'server', b'databricks'), (b'transfer-encoding', b'chunked')])
2025-06-04 12:42:02,832 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2025-06-04 12:42:02,832 - DEBUG - receive_response_body.complete
2025-06-04 12:42:02,832 - DEBUG - response_closed.started
2025-06-04 12:42:02,832 - DEBUG - response_closed.complete
2025-06-04 12:42:02,835 - DEBUG - Agent attempting to execute tool: table with args: {'name': 'customers'}
2025-06-04 12:42:02,836 - DEBUG - Tool arguments for 'table' validated successfully.
2025-06-04 12:42:02,836 - DEBUG - Executing agent tool 'table' with handler: handle_command
2025-06-04 12:42:02,836 - DEBUG - GET request to: https://dbc-df998298-4c7e.cloud.databricks.com/api/2.1/unity-catalog/tables/amperity_marketplace.bronze.customers
2025-06-04 12:42:02,837 - DEBUG - Starting new HTTPS connection (1): dbc-df998298-4c7e.cloud.databricks.com:443
2025-06-04 12:42:02,977 - DEBUG - https://dbc-df998298-4c7e.cloud.databricks.com:443 "GET /api/2.1/unity-catalog/tables/amperity_marketplace.bronze.customers HTTP/1.1" 404 None
2025-06-04 12:42:02,978 - DEBUG - HTTP error: 404 Client Error: Not Found for url: https://dbc-df998298-4c7e.cloud.databricks.com/api/2.1/unity-catalog/tables/amperity_marketplace.bronze.customers, Response: {"error_code":"TABLE_DOES_NOT_EXIST","message":"Table 'amperity_marketplace.bronze.customers' does not exist.","details":[{"@type":"type.googleapis.com/google.rpc.ErrorInfo","reason":"RESOURCE_DOES_NOT_EXIST","domain":"unity-catalog.databricks.com","metadata":{"resourceType":"Table","resourceIdentifier":"amperity_marketplace.bronze.customers"}},{"@type":"type.googleapis.com/google.rpc.RequestInfo","request_id":"4e15b80e-3b4f-47b5-bd16-9afcec2657fb","serving_data":""}]}
2025-06-04 12:42:02,978 - ERROR - Error getting table details: HTTP error occurred: 404 Client Error: Not Found for url: https://dbc-df998298-4c7e.cloud.databricks.com/api/2.1/unity-catalog/tables/amperity_marketplace.bronze.customers, Response: {"error_code":"TABLE_DOES_NOT_EXIST","message":"Table 'amperity_marketplace.bronze.customers' does not exist.","details":[{"@type":"type.googleapis.com/google.rpc.ErrorInfo","reason":"RESOURCE_DOES_NOT_EXIST","domain":"unity-catalog.databricks.com","metadata":{"resourceType":"Table","resourceIdentifier":"amperity_marketplace.bronze.customers"}},{"@type":"type.googleapis.com/google.rpc.RequestInfo","request_id":"4e15b80e-3b4f-47b5-bd16-9afcec2657fb","serving_data":""}]}
2025-06-04 12:42:02,978 - ERROR - Tool 'table' execution failed. Message: Failed to get table details: HTTP error occurred: 404 Client Error: Not Found for url: https://dbc-df998298-4c7e.cloud.databricks.com/api/2.1/unity-catalog/tables/amperity_marketplace.bronze.customers, Response: {"error_code":"TABLE_DOES_NOT_EXIST","message":"Table 'amperity_marketplace.bronze.customers' does not exist.","details":[{"@type":"type.googleapis.com/google.rpc.ErrorInfo","reason":"RESOURCE_DOES_NOT_EXIST","domain":"unity-catalog.databricks.com","metadata":{"resourceType":"Table","resourceIdentifier":"amperity_marketplace.bronze.customers"}},{"@type":"type.googleapis.com/google.rpc.RequestInfo","request_id":"4e15b80e-3b4f-47b5-bd16-9afcec2657fb","serving_data":""}]}, Error: HTTP error occurred: 404 Client Error: Not Found for url: https://dbc-df998298-4c7e.cloud.databricks.com/api/2.1/unity-catalog/tables/amperity_marketplace.bronze.customers, Response: {"error_code":"TABLE_DOES_NOT_EXIST","message":"Table 'amperity_marketplace.bronze.customers' does not exist.","details":[{"@type":"type.googleapis.com/google.rpc.ErrorInfo","reason":"RESOURCE_DOES_NOT_EXIST","domain":"unity-catalog.databricks.com","metadata":{"resourceType":"Table","resourceIdentifier":"amperity_marketplace.bronze.customers"}},{"@type":"type.googleapis.com/google.rpc.RequestInfo","request_id":"4e15b80e-3b4f-47b5-bd16-9afcec2657fb","serving_data":""}]}
2025-06-04 12:42:02,985 - DEBUG - connect_tcp.started host='dbc-df998298-4c7e.cloud.databricks.com' port=443 local_address=None timeout=5.0 socket_options=None
2025-06-04 12:42:03,005 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x10b0b6e90>
2025-06-04 12:42:03,005 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x10b0745f0> server_hostname='dbc-df998298-4c7e.cloud.databricks.com' timeout=5.0
2025-06-04 12:42:03,049 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x10b098b00>
2025-06-04 12:42:03,049 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2025-06-04 12:42:03,049 - DEBUG - send_request_headers.complete
2025-06-04 12:42:03,049 - DEBUG - send_request_body.started request=<Request [b'POST']>
2025-06-04 12:42:03,049 - DEBUG - send_request_body.complete
2025-06-04 12:42:03,049 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2025-06-04 12:42:09,741 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'x-amzn-requestid', b'7447f9a1-8951-4c89-9c76-e24832cdbfcb'), (b'x-amzn-bedrock-invocation-latency', b'6579'), (b'x-amzn-bedrock-output-token-count', b'67'), (b'x-amzn-bedrock-input-token-count', b'4776'), (b'content-type', b'application/json'), (b'date', b'Wed, 4 Jun 2025 19:42:09 GMT'), (b'x-databricks-org-id', b'3416276235813320'), (b'x-request-id', b'892ba49d-b9d0-43f0-9920-e4b084466966'), (b'content-encoding', b'gzip'), (b'vary', b'Accept-Encoding'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'x-content-type-options', b'nosniff'), (b'server', b'databricks'), (b'transfer-encoding', b'chunked')])
2025-06-04 12:42:09,742 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2025-06-04 12:42:09,743 - DEBUG - receive_response_body.complete
2025-06-04 12:42:09,743 - DEBUG - response_closed.started
2025-06-04 12:42:09,743 - DEBUG - response_closed.complete
2025-06-04 12:42:09,744 - DEBUG - Agent attempting to execute tool: list-tables with args: {}
2025-06-04 12:42:09,747 - DEBUG - Tool arguments for 'list-tables' validated successfully.
2025-06-04 12:42:09,747 - DEBUG - Executing agent tool 'list-tables' with handler: handle_command
2025-06-04 12:42:09,747 - DEBUG - GET request with params to: https://dbc-df998298-4c7e.cloud.databricks.com/api/2.1/unity-catalog/tables
2025-06-04 12:42:09,749 - DEBUG - Starting new HTTPS connection (1): dbc-df998298-4c7e.cloud.databricks.com:443
2025-06-04 12:42:09,971 - DEBUG - https://dbc-df998298-4c7e.cloud.databricks.com:443 "GET /api/2.1/unity-catalog/tables?catalog_name=amperity_marketplace&schema_name=bronze HTTP/1.1" 200 None
2025-06-04 12:42:09,973 - DEBUG - Tool 'list-tables' executed successfully. Data: {'tables': [{'name': 'e_commerce_customers', 'full_name': 'amperity_marketplace.bronze.e_commerce_customers', 'table_type': 'MANAGED', 'data_source_format': 'DELTA', 'comment': '', 'created_at': 1705449612155, 'created_by': 'caleb@amperity.com', 'owner': 'caleb@amperity.com', 'row_count': 'Unknown', 'size_bytes': 'Unknown', 'column_count': 19, 'columns': [{'name': 'customer_id_uuid', 'type': 'string', 'nullable': True}, {'name': 'master_id', 'type': 'bigint', 'nullable': True}, {'name': 'customer_id', 'type': 'string', 'nullable': True}, {'name': 'name_prefix', 'type': 'string', 'nullable': True}, {'name': 'name_first', 'type': 'string', 'nullable': True}, {'name': 'name_last', 'type': 'string', 'nullable': True}, {'name': 'gender', 'type': 'string', 'nullable': True}, {'name': 'email', 'type': 'string', 'nullable': True}, {'name': 'account_status', 'type': 'string', 'nullable': True}, {'name': 'addr_ln_1_txt', 'type': 'string', 'nullable': True}, {'name': 'city', 'type': 'string', 'nullable': True}, {'name': 'state', 'type': 'string', 'nullable': True}, {'name': 'postal_code', 'type': 'string', 'nullable': True}, {'name': 'birth_dt', 'type': 'date', 'nullable': True}, {'name': 'employment', 'type': 'string', 'nullable': True}, {'name': 'job_title', 'type': 'string', 'nullable': True}, {'name': 'phone', 'type': 'string', 'nullable': True}, {'name': 'dtUpdateDate', 'type': 'string', 'nullable': True}, {'name': '_updated', 'type': 'bigint', 'nullable': True}]}, {'name': 'loyalty_members', 'full_name': 'amperity_marketplace.bronze.loyalty_members', 'table_type': 'MANAGED', 'data_source_format': 'DELTA', 'comment': '', 'created_at': 1705449669759, 'created_by': 'caleb@amperity.com', 'owner': 'caleb@amperity.com', 'row_count': 'Unknown', 'size_bytes': 'Unknown', 'column_count': 19, 'columns': [{'name': 'lm_id_uuid', 'type': 'string', 'nullable': True}, {'name': 'master_id', 'type': 'bigint', 'nullable': True}, {'name': 'lm_id', 'type': 'string', 'nullable': True}, {'name': 'name_first', 'type': 'string', 'nullable': True}, {'name': 'name_last', 'type': 'string', 'nullable': True}, {'name': 'email', 'type': 'string', 'nullable': True}, {'name': 'gender', 'type': 'string', 'nullable': True}, {'name': 'address1', 'type': 'string', 'nullable': True}, {'name': 'city', 'type': 'string', 'nullable': True}, {'name': 'state', 'type': 'string', 'nullable': True}, {'name': 'postal_code', 'type': 'string', 'nullable': True}, {'name': 'birthdate', 'type': 'date', 'nullable': True}, {'name': 'created', 'type': 'date', 'nullable': True}, {'name': 'phone', 'type': 'string', 'nullable': True}, {'name': 'points', 'type': 'bigint', 'nullable': True}, {'name': 'current_tier', 'type': 'string', 'nullable': True}, {'name': 'lmProgramName', 'type': 'string', 'nullable': True}, {'name': 'dtUpdateDate', 'type': 'string', 'nullable': True}, {'name': '_updated', 'type': 'bigint', 'nullable': True}]}, {'name': 'pos_customers', 'full_name': 'amperity_marketplace.bronze.pos_customers', 'table_type': 'MANAGED', 'data_source_format': 'DELTA', 'comment': '', 'created_at': 1705449748132, 'created_by': 'caleb@amperity.com', 'owner': 'caleb@amperity.com', 'row_count': 'Unknown', 'size_bytes': 'Unknown', 'column_count': 19, 'columns': [{'name': 'customer_id_uuid', 'type': 'string', 'nullable': True}, {'name': 'master_id', 'type': 'bigint', 'nullable': True}, {'name': 'customer_id', 'type': 'string', 'nullable': True}, {'name': 'name_prefix', 'type': 'string', 'nullable': True}, {'name': 'name_first', 'type': 'string', 'nullable': True}, {'name': 'name_last', 'type': 'string', 'nullable': True}, {'name': 'gender', 'type': 'string', 'nullable': True}, {'name': 'email', 'type': 'string', 'nullable': True}, {'name': 'account_status', 'type': 'string', 'nullable': True}, {'name': 'addr_ln_1_txt', 'type': 'string', 'nullable': True}, {'name': 'city', 'type': 'string', 'nullable': True}, {'name': 'state', 'type': 'string', 'nullable': True}, {'name': 'postal_code', 'type': 'string', 'nullable': True}, {'name': 'birth_dt', 'type': 'date', 'nullable': True}, {'name': 'employment', 'type': 'string', 'nullable': True}, {'name': 'job_title', 'type': 'string', 'nullable': True}, {'name': 'phone', 'type': 'string', 'nullable': True}, {'name': 'dtUpdateDate', 'type': 'string', 'nullable': True}, {'name': '_updated', 'type': 'bigint', 'nullable': True}]}, {'name': 'web_visitors', 'full_name': 'amperity_marketplace.bronze.web_visitors', 'table_type': 'MANAGED', 'data_source_format': 'DELTA', 'comment': '', 'created_at': 1745516169030, 'created_by': 'caleb@amperity.com', 'owner': 'caleb@amperity.com', 'row_count': 'Unknown', 'size_bytes': 'Unknown', 'column_count': 3, 'columns': [{'name': 'unique_key', 'type': 'string', 'nullable': True}, {'name': 'first_party_web_id', 'type': 'string', 'nullable': True}, {'name': 'visitor_id', 'type': 'string', 'nullable': True}]}, {'name': 'wifi_connections', 'full_name': 'amperity_marketplace.bronze.wifi_connections', 'table_type': 'MANAGED', 'data_source_format': 'DELTA', 'comment': '', 'created_at': 1745516310700, 'created_by': 'caleb@amperity.com', 'owner': 'caleb@amperity.com', 'row_count': 'Unknown', 'size_bytes': 'Unknown', 'column_count': 14, 'columns': [{'name': 'PK', 'type': 'string', 'nullable': True}, {'name': 'mobile_pk_uuid', 'type': 'string', 'nullable': True}, {'name': 'master_id', 'type': 'bigint', 'nullable': True}, {'name': 'email', 'type': 'string', 'nullable': True}, {'name': 'fname', 'type': 'string', 'nullable': True}, {'name': 'lname', 'type': 'string', 'nullable': True}, {'name': 'roomOrStoreID', 'type': 'bigint', 'nullable': True}, {'name': 'postal_code', 'type': 'string', 'nullable': True}, {'name': 'client_ip', 'type': 'string', 'nullable': True}, {'name': 'login_time', 'type': 'timestamp', 'nullable': True}, {'name': 'sha', 'type': 'string', 'nullable': True}, {'name': 'device_uuid', 'type': 'string', 'nullable': True}, {'name': 'dtUpdateDate', 'type': 'string', 'nullable': True}, {'name': '_updated', 'type': 'bigint', 'nullable': True}]}], 'total_count': 5, 'catalog_name': 'amperity_marketplace', 'schema_name': 'bronze'}
2025-06-04 12:42:09,975 - DEBUG - close.started
2025-06-04 12:42:09,975 - DEBUG - close.complete
2025-06-04 12:42:10,000 - DEBUG - connect_tcp.started host='dbc-df998298-4c7e.cloud.databricks.com' port=443 local_address=None timeout=5.0 socket_options=None
2025-06-04 12:42:10,024 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x10b0989d0>
2025-06-04 12:42:10,024 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x10b074830> server_hostname='dbc-df998298-4c7e.cloud.databricks.com' timeout=5.0
2025-06-04 12:42:10,068 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x10b01fbf0>
2025-06-04 12:42:10,068 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2025-06-04 12:42:10,068 - DEBUG - send_request_headers.complete
2025-06-04 12:42:10,068 - DEBUG - send_request_body.started request=<Request [b'POST']>
2025-06-04 12:42:10,068 - DEBUG - send_request_body.complete
2025-06-04 12:42:10,068 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2025-06-04 12:42:22,202 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'x-amzn-requestid', b'4af062a5-8541-4dfd-8dba-24398273a81f'), (b'x-amzn-bedrock-invocation-latency', b'12065'), (b'x-amzn-bedrock-output-token-count', b'126'), (b'x-amzn-bedrock-input-token-count', b'6876'), (b'content-type', b'application/json'), (b'date', b'Wed, 4 Jun 2025 19:42:22 GMT'), (b'x-databricks-org-id', b'3416276235813320'), (b'x-request-id', b'60c8bb2c-3dcd-45e3-8d59-cf5c56a04577'), (b'content-encoding', b'gzip'), (b'vary', b'Accept-Encoding'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'x-content-type-options', b'nosniff'), (b'server', b'databricks'), (b'transfer-encoding', b'chunked')])
2025-06-04 12:42:22,207 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2025-06-04 12:42:22,207 - DEBUG - receive_response_body.complete
2025-06-04 12:42:22,208 - DEBUG - response_closed.started
2025-06-04 12:42:22,208 - DEBUG - response_closed.complete
2025-06-04 12:42:22,213 - DEBUG - Agent attempting to execute tool: list-schemas with args: {}
2025-06-04 12:42:22,219 - DEBUG - Tool arguments for 'list-schemas' validated successfully.
2025-06-04 12:42:22,219 - DEBUG - Executing agent tool 'list-schemas' with handler: handle_command
2025-06-04 12:42:22,219 - DEBUG - GET request with params to: https://dbc-df998298-4c7e.cloud.databricks.com/api/2.1/unity-catalog/schemas
2025-06-04 12:42:22,223 - DEBUG - Starting new HTTPS connection (1): dbc-df998298-4c7e.cloud.databricks.com:443
2025-06-04 12:42:22,383 - DEBUG - https://dbc-df998298-4c7e.cloud.databricks.com:443 "GET /api/2.1/unity-catalog/schemas?catalog_name=amperity_marketplace HTTP/1.1" 200 None
2025-06-04 12:42:22,384 - DEBUG - Tool 'list-schemas' executed successfully. Data: {'schemas': [{'name': 'bronze', 'full_name': 'amperity_marketplace.bronze', 'catalog_name': 'amperity_marketplace', 'comment': 'Example bronze datasets', 'created_at': 1705447103818, 'created_by': 'caleb@amperity.com', 'owner': 'caleb@amperity.com'}, {'name': 'default', 'full_name': 'amperity_marketplace.default', 'catalog_name': 'amperity_marketplace', 'comment': 'Example gold datasets', 'created_at': 1705443380217, 'created_by': 'caleb@amperity.com', 'owner': 'caleb@amperity.com'}, {'name': 'idraccelerator', 'full_name': 'amperity_marketplace.idraccelerator', 'catalog_name': 'amperity_marketplace', 'comment': '', 'created_at': 1719245397123, 'created_by': 'christian.saffici@amperity.com', 'owner': 'christian.saffici@amperity.com'}, {'name': 'information_schema', 'full_name': 'amperity_marketplace.information_schema', 'catalog_name': 'amperity_marketplace', 'comment': 'Information schema (auto-created)', 'created_at': 1705443380219, 'created_by': 'System user', 'owner': 'System user'}, {'name': 'silver', 'full_name': 'amperity_marketplace.silver', 'catalog_name': 'amperity_marketplace', 'comment': 'Example silver datasets', 'created_at': 1705446630307, 'created_by': 'caleb@amperity.com', 'owner': 'caleb@amperity.com'}, {'name': 'solution_accelerator', 'full_name': 'amperity_marketplace.solution_accelerator', 'catalog_name': 'amperity_marketplace', 'comment': '', 'created_at': 1739216178991, 'created_by': 'allyson.hepp@amperity.com', 'owner': 'allyson.hepp@amperity.com'}, {'name': 'stitch_outputs', 'full_name': 'amperity_marketplace.stitch_outputs', 'catalog_name': 'amperity_marketplace', 'comment': '', 'created_at': 1747693346496, 'created_by': 'caleb@amperity.com', 'owner': 'caleb@amperity.com'}], 'total_count': 7, 'catalog_name': 'amperity_marketplace', 'next_page_token': None}
2025-06-04 12:42:22,418 - DEBUG - connect_tcp.started host='dbc-df998298-4c7e.cloud.databricks.com' port=443 local_address=None timeout=5.0 socket_options=None
2025-06-04 12:42:22,441 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x10948bbd0>
2025-06-04 12:42:22,442 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x10b0749e0> server_hostname='dbc-df998298-4c7e.cloud.databricks.com' timeout=5.0
2025-06-04 12:42:22,485 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x10b0a4270>
2025-06-04 12:42:22,485 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2025-06-04 12:42:22,486 - DEBUG - send_request_headers.complete
2025-06-04 12:42:22,486 - DEBUG - send_request_body.started request=<Request [b'POST']>
2025-06-04 12:42:22,486 - DEBUG - send_request_body.complete
2025-06-04 12:42:22,486 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2025-06-04 12:42:26,488 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'x-amzn-requestid', b'c42e9423-1d87-4288-8e31-f21f57d4cad5'), (b'x-amzn-bedrock-invocation-latency', b'3882'), (b'x-amzn-bedrock-output-token-count', b'96'), (b'x-amzn-bedrock-input-token-count', b'7629'), (b'content-type', b'application/json'), (b'date', b'Wed, 4 Jun 2025 19:42:26 GMT'), (b'x-databricks-org-id', b'3416276235813320'), (b'x-request-id', b'b93e4301-d877-45ef-a14f-a3225f5e8009'), (b'content-encoding', b'gzip'), (b'vary', b'Accept-Encoding'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'x-content-type-options', b'nosniff'), (b'server', b'databricks'), (b'transfer-encoding', b'chunked')])
2025-06-04 12:42:26,489 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2025-06-04 12:42:26,490 - DEBUG - receive_response_body.complete
2025-06-04 12:42:26,490 - DEBUG - response_closed.started
2025-06-04 12:42:26,490 - DEBUG - response_closed.complete
2025-06-04 12:42:26,491 - DEBUG - Agent attempting to execute tool: set-schema with args: {'schema_name': 'silver'}
2025-06-04 12:42:26,492 - DEBUG - Tool arguments for 'set-schema' validated successfully.
2025-06-04 12:42:26,492 - DEBUG - Executing agent tool 'set-schema' with handler: handle_command
2025-06-04 12:42:26,492 - DEBUG - GET request to: https://dbc-df998298-4c7e.cloud.databricks.com/api/2.1/unity-catalog/schemas/amperity_marketplace.silver
2025-06-04 12:42:26,494 - DEBUG - Starting new HTTPS connection (1): dbc-df998298-4c7e.cloud.databricks.com:443
2025-06-04 12:42:26,671 - DEBUG - https://dbc-df998298-4c7e.cloud.databricks.com:443 "GET /api/2.1/unity-catalog/schemas/amperity_marketplace.silver HTTP/1.1" 200 None
2025-06-04 12:42:26,674 - DEBUG - Saved configuration to /Users/johnrush/.chuck_config.json
2025-06-04 12:42:26,675 - DEBUG - Tool 'set-schema' executed successfully. Data: {'schema_name': 'silver', 'catalog_name': 'amperity_marketplace'}
2025-06-04 12:42:26,693 - DEBUG - connect_tcp.started host='dbc-df998298-4c7e.cloud.databricks.com' port=443 local_address=None timeout=5.0 socket_options=None
2025-06-04 12:42:26,722 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x10b002350>
2025-06-04 12:42:26,722 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x10b074a70> server_hostname='dbc-df998298-4c7e.cloud.databricks.com' timeout=5.0
2025-06-04 12:42:26,777 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x10b002750>
2025-06-04 12:42:26,777 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2025-06-04 12:42:26,778 - DEBUG - send_request_headers.complete
2025-06-04 12:42:26,778 - DEBUG - send_request_body.started request=<Request [b'POST']>
2025-06-04 12:42:26,778 - DEBUG - send_request_body.complete
2025-06-04 12:42:26,778 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2025-06-04 12:42:33,801 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'x-amzn-requestid', b'2fd3cbbf-5ed2-44a1-bc36-191b9b1eadb2'), (b'x-amzn-bedrock-invocation-latency', b'6928'), (b'x-amzn-bedrock-output-token-count', b'49'), (b'x-amzn-bedrock-input-token-count', b'7756'), (b'content-type', b'application/json'), (b'date', b'Wed, 4 Jun 2025 19:42:33 GMT'), (b'x-databricks-org-id', b'3416276235813320'), (b'x-request-id', b'a3f4a06d-5da8-478a-b204-c5ef845ccc31'), (b'content-encoding', b'gzip'), (b'vary', b'Accept-Encoding'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'x-content-type-options', b'nosniff'), (b'server', b'databricks'), (b'transfer-encoding', b'chunked')])
2025-06-04 12:42:33,802 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2025-06-04 12:42:33,802 - DEBUG - receive_response_body.complete
2025-06-04 12:42:33,802 - DEBUG - response_closed.started
2025-06-04 12:42:33,802 - DEBUG - response_closed.complete
2025-06-04 12:42:33,803 - DEBUG - Agent attempting to execute tool: list-tables with args: {}
2025-06-04 12:42:33,807 - DEBUG - Tool arguments for 'list-tables' validated successfully.
2025-06-04 12:42:33,807 - DEBUG - Executing agent tool 'list-tables' with handler: handle_command
2025-06-04 12:42:33,807 - DEBUG - GET request with params to: https://dbc-df998298-4c7e.cloud.databricks.com/api/2.1/unity-catalog/tables
2025-06-04 12:42:33,808 - DEBUG - Starting new HTTPS connection (1): dbc-df998298-4c7e.cloud.databricks.com:443
2025-06-04 12:42:34,124 - DEBUG - https://dbc-df998298-4c7e.cloud.databricks.com:443 "GET /api/2.1/unity-catalog/tables?catalog_name=amperity_marketplace&schema_name=silver HTTP/1.1" 200 None
2025-06-04 12:42:34,148 - DEBUG - close.started
2025-06-04 12:42:34,148 - DEBUG - close.complete
2025-06-04 12:42:34,149 - DEBUG - close.started
2025-06-04 12:42:34,149 - DEBUG - close.complete
2025-06-04 12:42:34,149 - DEBUG - close.started
2025-06-04 12:42:34,149 - DEBUG - close.complete
2025-06-04 12:42:34,155 - DEBUG - Tool 'list-tables' executed successfully. Data: {'tables': [{'name': 'fiscal_calendar', 'full_name': 'amperity_marketplace.silver.fiscal_calendar', 'table_type': 'MANAGED', 'data_source_format': 'DELTA', 'comment': '', 'created_at': 1705449521603, 'created_by': 'caleb@amperity.com', 'owner': 'caleb@amperity.com', 'row_count': 'Unknown', 'size_bytes': 'Unknown', 'column_count': 8, 'columns': [{'name': 'calendar_date', 'type': 'date', 'nullable': True}, {'name': 'fiscal_year', 'type': 'bigint', 'nullable': True}, {'name': 'fiscal_quarter', 'type': 'string', 'nullable': True}, {'name': 'fiscal_month', 'type': 'string', 'nullable': True}, {'name': 'fiscal_week_start', 'type': 'date', 'nullable': True}, {'name': 'fiscal_week_number', 'type': 'bigint', 'nullable': True}, {'name': 'day_of_week', 'type': 'string', 'nullable': True}, {'name': 'holiday_sale_name', 'type': 'string', 'nullable': True}]}, {'name': 'unified_coalesced', 'full_name': 'amperity_marketplace.silver.unified_coalesced', 'table_type': 'MANAGED', 'data_source_format': 'DELTA', 'comment': '', 'created_at': 1743519956896, 'created_by': 'allyson.hepp@amperity.com', 'owner': 'allyson.hepp@amperity.com', 'row_count': 'Unknown', 'size_bytes': 'Unknown', 'column_count': 53, 'columns': [{'name': 'amperity_id', 'type': 'string', 'nullable': True}, {'name': 'datasource', 'type': 'string', 'nullable': True}, {'name': 'has_blv', 'type': 'boolean', 'nullable': True}, {'name': 'title', 'type': 'string', 'nullable': True}, {'name': 'given_name', 'type': 'string', 'nullable': True}, {'name': 'surname', 'type': 'string', 'nullable': True}, {'name': 'full_name', 'type': 'string', 'nullable': True}, {'name': 'generational_suffix', 'type': 'string', 'nullable': True}, {'name': 'email', 'type': 'string', 'nullable': True}, {'name': 'phone', 'type': 'string', 'nullable': True}, {'name': 'address', 'type': 'string', 'nullable': True}, {'name': 'address2', 'type': 'string', 'nullable': True}, {'name': 'city', 'type': 'string', 'nullable': True}, {'name': 'state', 'type': 'string', 'nullable': True}, {'name': 'postal', 'type': 'string', 'nullable': True}, {'name': 'country', 'type': 'string', 'nullable': True}, {'name': 'birthdate', 'type': 'date', 'nullable': True}, {'name': 'gender', 'type': 'string', 'nullable': True}, {'name': 'company', 'type': 'string', 'nullable': True}, {'name': 'loyalty_id', 'type': 'string', 'nullable': True}, {'name': 'update_dt', 'type': 'string', 'nullable': True}, {'name': 'create_dt', 'type': 'string', 'nullable': True}, {'name': 'ecomm_account_status', 'type': 'string', 'nullable': True}, {'name': 'job_title', 'type': 'string', 'nullable': True}, {'name': 'loyalty_create_date', 'type': 'date', 'nullable': True}, {'name': 'loyalty_lm_id', 'type': 'string', 'nullable': True}, {'name': 'loyalty_points', 'type': 'bigint', 'nullable': True}, {'name': 'loyalty_program_name', 'type': 'string', 'nullable': True}, {'name': 'loyalty_tier', 'type': 'string', 'nullable': True}, {'name': 'parent_company', 'type': 'string', 'nullable': True}, {'name': 'pos_account_status', 'type': 'string', 'nullable': True}, {'name': 'pos_customer_id', 'type': 'string', 'nullable': True}, {'name': 'wifi_client_ip', 'type': 'string', 'nullable': True}, {'name': 'wifi_device_uuid', 'type': 'string', 'nullable': True}, {'name': 'wifi_login_time', 'type': 'timestamp', 'nullable': True}, {'name': 'wifi_roomorstoreid', 'type': 'bigint', 'nullable': True}, {'name': 'wifi_sha', 'type': 'string', 'nullable': True}, {'name': 'ck', 'type': 'string', 'nullable': True}, {'name': 'fk_customer_id', 'type': 'string', 'nullable': True}, {'name': 'fk_loyalty_id', 'type': 'string', 'nullable': True}, {'name': 'fk_pos_cust', 'type': 'string', 'nullable': True}, {'name': 'fk_visitorid', 'type': 'string', 'nullable': True}, {'name': 'blv_address', 'type': 'boolean', 'nullable': True}, {'name': 'blv_email', 'type': 'boolean', 'nullable': True}, {'name': 'blv_given_name', 'type': 'boolean', 'nullable': True}, {'name': 'blv_phone', 'type': 'boolean', 'nullable': True}, {'name': 'blv_surname', 'type': 'boolean', 'nullable': True}, {'name': 'pk', 'type': 'string', 'nullable': True}, {'name': 'rep_ds', 'type': 'string', 'nullable': True}, {'name': 'rep_pk', 'type': 'string', 'nullable': True}, {'name': 'is_supersized', 'type': 'boolean', 'nullable': True}, {'name': 'supersized_id', 'type': 'bigint', 'nullable': True}, {'name': 'component_id', 'type': 'bigint', 'nullable': True}]}, {'name': 'unified_compliance', 'full_name': 'amperity_marketplace.silver.unified_compliance', 'table_type': 'MANAGED', 'data_source_format': 'DELTA', 'comment': '', 'created_at': 1705449518260, 'created_by': 'caleb@amperity.com', 'owner': 'caleb@amperity.com', 'row_count': 'Unknown', 'size_bytes': 'Unknown', 'column_count': 15, 'columns': [{'name': 'request_datasource', 'type': 'string', 'nullable': True}, {'name': 'request_id', 'type': 'string', 'nullable': True}, {'name': 'request_type', 'type': 'string', 'nullable': True}, {'name': 'request_strategy', 'type': 'string', 'nullable': True}, {'name': 'amperity_id', 'type': 'string', 'nullable': True}, {'name': 'datasource', 'type': 'string', 'nullable': True}, {'name': 'pk', 'type': 'string', 'nullable': True}, {'name': 'loyalty_lm_id', 'type': 'string', 'nullable': True}, {'name': 'email', 'type': 'string', 'nullable': True}, {'name': 'fk_loyalty_id', 'type': 'string', 'nullable': True}, {'name': 'fk_visitorid', 'type': 'string', 'nullable': True}, {'name': 'pos_customer_id', 'type': 'string', 'nullable': True}, {'name': 'loyalty_id', 'type': 'string', 'nullable': True}, {'name': 'create_dt', 'type': 'string', 'nullable': True}, {'name': 'update_dt', 'type': 'string', 'nullable': True}]}, {'name': 'unified_customer', 'full_name': 'amperity_marketplace.silver.unified_customer', 'table_type': 'MANAGED', 'data_source_format': 'DELTA', 'comment': '', 'created_at': 1705447064095, 'created_by': 'caleb@amperity.com', 'owner': 'caleb@amperity.com', 'row_count': 'Unknown', 'size_bytes': 'Unknown', 'column_count': 23, 'columns': [{'name': 'amperity_id', 'type': 'string', 'nullable': True}, {'name': 'datasource', 'type': 'string', 'nullable': True}, {'name': 'title', 'type': 'string', 'nullable': True}, {'name': 'given_name', 'type': 'string', 'nullable': True}, {'name': 'surname', 'type': 'string', 'nullable': True}, {'name': 'full_name', 'type': 'string', 'nullable': True}, {'name': 'generational_suffix', 'type': 'string', 'nullable': True}, {'name': 'email', 'type': 'string', 'nullable': True}, {'name': 'phone', 'type': 'string', 'nullable': True}, {'name': 'address', 'type': 'string', 'nullable': True}, {'name': 'address2', 'type': 'string', 'nullable': True}, {'name': 'city', 'type': 'string', 'nullable': True}, {'name': 'state', 'type': 'string', 'nullable': True}, {'name': 'postal', 'type': 'string', 'nullable': True}, {'name': 'country', 'type': 'string', 'nullable': True}, {'name': 'birthdate', 'type': 'date', 'nullable': True}, {'name': 'gender', 'type': 'string', 'nullable': True}, {'name': 'company', 'type': 'string', 'nullable': True}, {'name': 'loyalty_id', 'type': 'string', 'nullable': True}, {'name': 'update_dt', 'type': 'string', 'nullable': True}, {'name': 'create_dt', 'type': 'string', 'nullable': True}, {'name': 'ck', 'type': 'string', 'nullable': True}, {'name': 'pk', 'type': 'string', 'nullable': True}]}, {'name': 'unified_household', 'full_name': 'amperity_marketplace.silver.unified_household', 'table_type': 'MANAGED', 'data_source_format': 'DELTA', 'comment': '', 'created_at': 1705449094021, 'created_by': 'caleb@amperity.com', 'owner': 'caleb@amperity.com', 'row_count': 'Unknown', 'size_bytes': 'Unknown', 'column_count': 12, 'columns': [{'name': 'amperity_id', 'type': 'string', 'nullable': True}, {'name': 'household_id', 'type': 'string', 'nullable': True}, {'name': 'household_size', 'type': 'bigint', 'nullable': True}, {'name': 'Is_Business_Address', 'type': 'boolean', 'nullable': True}, {'name': 'household_LTV', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'full_address', 'type': 'string', 'nullable': True}, {'name': 'given_name', 'type': 'string', 'nullable': True}, {'name': 'surname', 'type': 'string', 'nullable': True}, {'name': 'address', 'type': 'string', 'nullable': True}, {'name': 'city', 'type': 'string', 'nullable': True}, {'name': 'state', 'type': 'string', 'nullable': True}, {'name': 'postal', 'type': 'string', 'nullable': True}]}, {'name': 'unified_itemized_transactions', 'full_name': 'amperity_marketplace.silver.unified_itemized_transactions', 'table_type': 'MANAGED', 'data_source_format': 'DELTA', 'comment': '', 'created_at': 1705448833924, 'created_by': 'caleb@amperity.com', 'owner': 'caleb@amperity.com', 'row_count': 'Unknown', 'size_bytes': 'Unknown', 'column_count': 32, 'columns': [{'name': 'amperity_id', 'type': 'string', 'nullable': True}, {'name': 'datasource', 'type': 'string', 'nullable': True}, {'name': 'order_id', 'type': 'string', 'nullable': True}, {'name': 'product_id', 'type': 'string', 'nullable': True}, {'name': 'item_quantity', 'type': 'bigint', 'nullable': True}, {'name': 'is_return', 'type': 'boolean', 'nullable': True}, {'name': 'is_cancellation', 'type': 'boolean', 'nullable': True}, {'name': 'item_revenue', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'store_id', 'type': 'string', 'nullable': True}, {'name': 'purchase_channel', 'type': 'string', 'nullable': True}, {'name': 'purchase_brand', 'type': 'string', 'nullable': True}, {'name': 'item_discount_amount', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'day_of_week', 'type': 'string', 'nullable': True}, {'name': 'ga_medium', 'type': 'string', 'nullable': True}, {'name': 'ga_source', 'type': 'string', 'nullable': True}, {'name': 'item_discount_percent', 'type': 'decimal(30,5)', 'nullable': True}, {'name': 'item_list_price', 'type': 'decimal(30,2)', 'nullable': True}, {'name': 'nrf_fiscal_half_year', 'type': 'string', 'nullable': True}, {'name': 'nrf_fiscal_month', 'type': 'string', 'nullable': True}, {'name': 'nrf_fiscal_quarter', 'type': 'string', 'nullable': True}, {'name': 'nrf_fiscal_week', 'type': 'date', 'nullable': True}, {'name': 'nrf_fiscal_week_number', 'type': 'bigint', 'nullable': True}, {'name': 'nrf_fiscal_year', 'type': 'bigint', 'nullable': True}, {'name': 'order_date', 'type': 'date', 'nullable': True}, {'name': 'product_category', 'type': 'string', 'nullable': True}, {'name': 'product_subcategory', 'type': 'string', 'nullable': True}, {'name': 'promocode', 'type': 'string', 'nullable': True}, {'name': 'tender_type', 'type': 'string', 'nullable': True}, {'name': 'fk_customer_id', 'type': 'string', 'nullable': True}, {'name': 'fk_pos_cust', 'type': 'string', 'nullable': True}, {'name': 'pk', 'type': 'string', 'nullable': True}, {'name': 'order_datetime', 'type': 'timestamp', 'nullable': True}]}, {'name': 'unified_loyalty', 'full_name': 'amperity_marketplace.silver.unified_loyalty', 'table_type': 'MANAGED', 'data_source_format': 'DELTA', 'comment': '', 'created_at': 1705449413836, 'created_by': 'caleb@amperity.com', 'owner': 'caleb@amperity.com', 'row_count': 'Unknown', 'size_bytes': 'Unknown', 'column_count': 15, 'columns': [{'name': 'amperity_id', 'type': 'string', 'nullable': True}, {'name': 'datasource', 'type': 'string', 'nullable': True}, {'name': 'loyalty_id', 'type': 'string', 'nullable': True}, {'name': 'email', 'type': 'string', 'nullable': True}, {'name': 'birthdate', 'type': 'date', 'nullable': True}, {'name': 'current_balance', 'type': 'bigint', 'nullable': True}, {'name': 'current_balance_expiration_datetime', 'type': 'date', 'nullable': True}, {'name': 'current_tier', 'type': 'string', 'nullable': True}, {'name': 'is_opted_in', 'type': 'boolean', 'nullable': True}, {'name': 'latest_opt_in_datetime', 'type': 'date', 'nullable': True}, {'name': 'latest_opt_out_datetime', 'type': 'date', 'nullable': True}, {'name': 'latest_update_datetime', 'type': 'timestamp', 'nullable': True}, {'name': 'program_name', 'type': 'string', 'nullable': True}, {'name': 'spend_to_keep_tier', 'type': 'decimal(22,1)', 'nullable': True}, {'name': 'spend_to_next_tier', 'type': 'decimal(22,1)', 'nullable': True}]}, {'name': 'unified_loyalty_events', 'full_name': 'amperity_marketplace.silver.unified_loyalty_events', 'table_type': 'MANAGED', 'data_source_format': 'DELTA', 'comment': '', 'created_at': 1705449514631, 'created_by': 'caleb@amperity.com', 'owner': 'caleb@amperity.com', 'row_count': 'Unknown', 'size_bytes': 'Unknown', 'column_count': 14, 'columns': [{'name': 'amperity_id', 'type': 'string', 'nullable': True}, {'name': 'datasource', 'type': 'string', 'nullable': True}, {'name': 'loyalty_id', 'type': 'string', 'nullable': True}, {'name': 'event_datetime', 'type': 'timestamp', 'nullable': True}, {'name': 'event_type', 'type': 'string', 'nullable': True}, {'name': 'current_tier', 'type': 'string', 'nullable': True}, {'name': 'previous_tier', 'type': 'string', 'nullable': True}, {'name': 'tier_end_datetime', 'type': 'date', 'nullable': True}, {'name': 'tier_start_datetime', 'type': 'date', 'nullable': True}, {'name': 'accrual_amount', 'type': 'bigint', 'nullable': True}, {'name': 'accrual_datetime', 'type': 'date', 'nullable': True}, {'name': 'order_id', 'type': 'string', 'nullable': True}, {'name': 'redemption_amount', 'type': 'bigint', 'nullable': True}, {'name': 'redemption_datetime', 'type': 'timestamp', 'nullable': True}]}, {'name': 'unified_merged', 'full_name': 'amperity_marketplace.silver.unified_merged', 'table_type': 'MANAGED', 'data_source_format': 'DELTA', 'comment': '', 'created_at': 1705447651695, 'created_by': 'caleb@amperity.com', 'owner': 'caleb@amperity.com', 'row_count': 'Unknown', 'size_bytes': 'Unknown', 'column_count': 62, 'columns': [{'name': 'amperity_id', 'type': 'string', 'nullable': True}, {'name': 'given_name', 'type': 'string', 'nullable': True}, {'name': 'surname', 'type': 'string', 'nullable': True}, {'name': 'full_name', 'type': 'string', 'nullable': True}, {'name': 'name_pk', 'type': 'string', 'nullable': True}, {'name': 'name_update_dt', 'type': 'string', 'nullable': True}, {'name': 'name_datasource', 'type': 'string', 'nullable': True}, {'name': 'name_priority', 'type': 'int', 'nullable': True}, {'name': 'name_completion', 'type': 'int', 'nullable': True}, {'name': 'address', 'type': 'string', 'nullable': True}, {'name': 'address2', 'type': 'string', 'nullable': True}, {'name': 'city', 'type': 'string', 'nullable': True}, {'name': 'state', 'type': 'string', 'nullable': True}, {'name': 'postal', 'type': 'string', 'nullable': True}, {'name': 'country', 'type': 'string', 'nullable': True}, {'name': 'address_pk', 'type': 'string', 'nullable': True}, {'name': 'address_update_dt', 'type': 'string', 'nullable': True}, {'name': 'address_datasource', 'type': 'string', 'nullable': True}, {'name': 'address_priority', 'type': 'int', 'nullable': True}, {'name': 'address_completion', 'type': 'int', 'nullable': True}, {'name': 'email', 'type': 'string', 'nullable': True}, {'name': 'email_pk', 'type': 'string', 'nullable': True}, {'name': 'email_update_dt', 'type': 'string', 'nullable': True}, {'name': 'email_datasource', 'type': 'string', 'nullable': True}, {'name': 'email_priority', 'type': 'int', 'nullable': True}, {'name': 'email_completion', 'type': 'int', 'nullable': True}, {'name': 'phone', 'type': 'string', 'nullable': True}, {'name': 'phone_pk', 'type': 'string', 'nullable': True}, {'name': 'phone_update_dt', 'type': 'string', 'nullable': True}, {'name': 'phone_datasource', 'type': 'string', 'nullable': True}, {'name': 'phone_priority', 'type': 'int', 'nullable': True}, {'name': 'phone_completion', 'type': 'int', 'nullable': True}, {'name': 'birthdate', 'type': 'date', 'nullable': True}, {'name': 'birthdate_pk', 'type': 'string', 'nullable': True}, {'name': 'birthdate_update_dt', 'type': 'string', 'nullable': True}, {'name': 'birthdate_datasource', 'type': 'string', 'nullable': True}, {'name': 'birthdate_priority', 'type': 'int', 'nullable': True}, {'name': 'birthdate_completion', 'type': 'int', 'nullable': True}, {'name': 'gender', 'type': 'string', 'nullable': True}, {'name': 'gender_pk', 'type': 'string', 'nullable': True}, {'name': 'gender_update_dt', 'type': 'string', 'nullable': True}, {'name': 'gender_datasource', 'type': 'string', 'nullable': True}, {'name': 'gender_priority', 'type': 'int', 'nullable': True}, {'name': 'gender_completion', 'type': 'int', 'nullable': True}, {'name': 'title', 'type': 'string', 'nullable': True}, {'name': 'title_pk', 'type': 'string', 'nullable': True}, {'name': 'title_update_dt', 'type': 'string', 'nullable': True}, {'name': 'title_datasource', 'type': 'string', 'nullable': True}, {'name': 'title_priority', 'type': 'int', 'nullable': True}, {'name': 'title_completion', 'type': 'int', 'nullable': True}, {'name': 'job_title', 'type': 'string', 'nullable': True}, {'name': 'job_title_pk', 'type': 'string', 'nullable': True}, {'name': 'job_title_update_dt', 'type': 'string', 'nullable': True}, {'name': 'job_title_datasource', 'type': 'string', 'nullable': True}, {'name': 'job_title_priority', 'type': 'int', 'nullable': True}, {'name': 'job_title_completion', 'type': 'int', 'nullable': True}, {'name': 'parent_company', 'type': 'string', 'nullable': True}, {'name': 'parent_company_pk', 'type': 'string', 'nullable': True}, {'name': 'parent_company_update_dt', 'type': 'string', 'nullable': True}, {'name': 'parent_company_datasource', 'type': 'string', 'nullable': True}, {'name': 'parent_company_priority', 'type': 'int', 'nullable': True}, {'name': 'parent_company_completion', 'type': 'int', 'nullable': True}]}, {'name': 'unified_paid_media', 'full_name': 'amperity_marketplace.silver.unified_paid_media', 'table_type': 'MANAGED', 'data_source_format': 'DELTA', 'comment': '', 'created_at': 1705449370144, 'created_by': 'caleb@amperity.com', 'owner': 'caleb@amperity.com', 'row_count': 'Unknown', 'size_bytes': 'Unknown', 'column_count': 13, 'columns': [{'name': 'amperity_id', 'type': 'string', 'nullable': True}, {'name': 'given_name', 'type': 'string', 'nullable': True}, {'name': 'surname', 'type': 'string', 'nullable': True}, {'name': 'email', 'type': 'string', 'nullable': True}, {'name': 'phone', 'type': 'string', 'nullable': True}, {'name': 'address', 'type': 'string', 'nullable': True}, {'name': 'address_line_2', 'type': 'string', 'nullable': True}, {'name': 'city', 'type': 'string', 'nullable': True}, {'name': 'state', 'type': 'string', 'nullable': True}, {'name': 'zip', 'type': 'string', 'nullable': True}, {'name': 'country', 'type': 'string', 'nullable': True}, {'name': 'birthdate', 'type': 'date', 'nullable': True}, {'name': 'gender', 'type': 'string', 'nullable': True}]}, {'name': 'unified_scores', 'full_name': 'amperity_marketplace.silver.unified_scores', 'table_type': 'MANAGED', 'data_source_format': 'DELTA', 'comment': '', 'created_at': 1705449183739, 'created_by': 'caleb@amperity.com', 'owner': 'caleb@amperity.com', 'row_count': 'Unknown', 'size_bytes': 'Unknown', 'column_count': 8, 'columns': [{'name': 'amperity_id', 'type': 'string', 'nullable': True}, {'name': 'source1', 'type': 'string', 'nullable': True}, {'name': 'source2', 'type': 'string', 'nullable': True}, {'name': 'pk1', 'type': 'string', 'nullable': True}, {'name': 'pk2', 'type': 'string', 'nullable': True}, {'name': 'score', 'type': 'double', 'nullable': True}, {'name': 'match_category', 'type': 'string', 'nullable': True}, {'name': 'match_type', 'type': 'string', 'nullable': True}]}, {'name': 'unified_transactions', 'full_name': 'amperity_marketplace.silver.unified_transactions', 'table_type': 'MANAGED', 'data_source_format': 'DELTA', 'comment': '', 'created_at': 1705448993730, 'created_by': 'caleb@amperity.com', 'owner': 'caleb@amperity.com', 'row_count': 'Unknown', 'size_bytes': 'Unknown', 'column_count': 21, 'columns': [{'name': 'amperity_id', 'type': 'string', 'nullable': True}, {'name': 'order_id', 'type': 'string', 'nullable': True}, {'name': 'store_id', 'type': 'string', 'nullable': True}, {'name': 'purchase_channel', 'type': 'string', 'nullable': True}, {'name': 'purchase_brand', 'type': 'string', 'nullable': True}, {'name': 'order_datetime', 'type': 'timestamp', 'nullable': True}, {'name': 'order_quantity', 'type': 'bigint', 'nullable': True}, {'name': 'order_revenue', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'sum_item_discount_amount', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'order_discount_amount', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'order_returned_quantity', 'type': 'bigint', 'nullable': True}, {'name': 'order_returned_revenue', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'order_cancelled_quantity', 'type': 'bigint', 'nullable': True}, {'name': 'order_cancelled_revenue', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'fiscal_year', 'type': 'bigint', 'nullable': True}, {'name': 'fiscal_quarter', 'type': 'string', 'nullable': True}, {'name': 'fiscal_month', 'type': 'string', 'nullable': True}, {'name': 'fiscal_week_number', 'type': 'bigint', 'nullable': True}, {'name': 'fiscal_week_start', 'type': 'date', 'nullable': True}, {'name': 'fiscal_day_of_week', 'type': 'string', 'nullable': True}, {'name': 'holiday_sale_name', 'type': 'string', 'nullable': True}]}], 'total_count': 12, 'catalog_name': 'amperity_marketplace', 'schema_name': 'silver'}
2025-06-04 12:42:34,167 - DEBUG - close.started
2025-06-04 12:42:34,168 - DEBUG - close.complete
2025-06-04 12:42:34,217 - DEBUG - connect_tcp.started host='dbc-df998298-4c7e.cloud.databricks.com' port=443 local_address=None timeout=5.0 socket_options=None
2025-06-04 12:42:34,240 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x1096db2f0>
2025-06-04 12:42:34,240 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x1096ffc80> server_hostname='dbc-df998298-4c7e.cloud.databricks.com' timeout=5.0
2025-06-04 12:42:34,289 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x1096db4d0>
2025-06-04 12:42:34,289 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2025-06-04 12:42:34,290 - DEBUG - send_request_headers.complete
2025-06-04 12:42:34,290 - DEBUG - send_request_body.started request=<Request [b'POST']>
2025-06-04 12:42:34,290 - DEBUG - send_request_body.complete
2025-06-04 12:42:34,290 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2025-06-04 12:42:42,393 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'x-amzn-requestid', b'23ff845f-9d38-432a-a630-acf304f2e93b'), (b'x-amzn-bedrock-invocation-latency', b'7993'), (b'x-amzn-bedrock-output-token-count', b'154'), (b'x-amzn-bedrock-input-token-count', b'14745'), (b'content-type', b'application/json'), (b'date', b'Wed, 4 Jun 2025 19:42:42 GMT'), (b'x-databricks-org-id', b'3416276235813320'), (b'x-request-id', b'ffa79676-ee78-49bb-9cc4-2c02b8306b08'), (b'content-encoding', b'gzip'), (b'vary', b'Accept-Encoding'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'x-content-type-options', b'nosniff'), (b'server', b'databricks'), (b'transfer-encoding', b'chunked')])
2025-06-04 12:42:42,395 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2025-06-04 12:42:42,395 - DEBUG - receive_response_body.complete
2025-06-04 12:42:42,395 - DEBUG - response_closed.started
2025-06-04 12:42:42,396 - DEBUG - response_closed.complete
2025-06-04 12:42:42,399 - DEBUG - Agent attempting to execute tool: set-schema with args: {'schema_name': 'default'}
2025-06-04 12:42:42,401 - DEBUG - Tool arguments for 'set-schema' validated successfully.
2025-06-04 12:42:42,401 - DEBUG - Executing agent tool 'set-schema' with handler: handle_command
2025-06-04 12:42:42,401 - DEBUG - GET request to: https://dbc-df998298-4c7e.cloud.databricks.com/api/2.1/unity-catalog/schemas/amperity_marketplace.default
2025-06-04 12:42:42,405 - DEBUG - Starting new HTTPS connection (1): dbc-df998298-4c7e.cloud.databricks.com:443
2025-06-04 12:42:42,538 - DEBUG - https://dbc-df998298-4c7e.cloud.databricks.com:443 "GET /api/2.1/unity-catalog/schemas/amperity_marketplace.default HTTP/1.1" 200 None
2025-06-04 12:42:42,542 - DEBUG - Saved configuration to /Users/johnrush/.chuck_config.json
2025-06-04 12:42:42,542 - DEBUG - Tool 'set-schema' executed successfully. Data: {'schema_name': 'default', 'catalog_name': 'amperity_marketplace'}
2025-06-04 12:42:42,575 - DEBUG - connect_tcp.started host='dbc-df998298-4c7e.cloud.databricks.com' port=443 local_address=None timeout=5.0 socket_options=None
2025-06-04 12:42:42,599 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x10b03ba10>
2025-06-04 12:42:42,599 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x10b0752e0> server_hostname='dbc-df998298-4c7e.cloud.databricks.com' timeout=5.0
2025-06-04 12:42:42,645 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x10b03baf0>
2025-06-04 12:42:42,646 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2025-06-04 12:42:42,646 - DEBUG - send_request_headers.complete
2025-06-04 12:42:42,646 - DEBUG - send_request_body.started request=<Request [b'POST']>
2025-06-04 12:42:42,647 - DEBUG - send_request_body.complete
2025-06-04 12:42:42,647 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2025-06-04 12:42:49,356 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'x-amzn-requestid', b'cd9245fe-a4ca-4906-96f4-82cc8435b549'), (b'x-amzn-bedrock-invocation-latency', b'6605'), (b'x-amzn-bedrock-output-token-count', b'37'), (b'x-amzn-bedrock-input-token-count', b'14930'), (b'content-type', b'application/json'), (b'date', b'Wed, 4 Jun 2025 19:42:49 GMT'), (b'x-databricks-org-id', b'3416276235813320'), (b'x-request-id', b'48ea922d-43d5-4001-bf64-98293b6af706'), (b'content-encoding', b'gzip'), (b'vary', b'Accept-Encoding'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'x-content-type-options', b'nosniff'), (b'server', b'databricks'), (b'transfer-encoding', b'chunked')])
2025-06-04 12:42:49,358 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2025-06-04 12:42:49,358 - DEBUG - receive_response_body.complete
2025-06-04 12:42:49,358 - DEBUG - response_closed.started
2025-06-04 12:42:49,358 - DEBUG - response_closed.complete
2025-06-04 12:42:49,359 - DEBUG - Agent attempting to execute tool: list-tables with args: {}
2025-06-04 12:42:49,362 - DEBUG - Tool arguments for 'list-tables' validated successfully.
2025-06-04 12:42:49,362 - DEBUG - Executing agent tool 'list-tables' with handler: handle_command
2025-06-04 12:42:49,362 - DEBUG - GET request with params to: https://dbc-df998298-4c7e.cloud.databricks.com/api/2.1/unity-catalog/tables
2025-06-04 12:42:49,364 - DEBUG - Starting new HTTPS connection (1): dbc-df998298-4c7e.cloud.databricks.com:443
2025-06-04 12:42:49,551 - DEBUG - https://dbc-df998298-4c7e.cloud.databricks.com:443 "GET /api/2.1/unity-catalog/tables?catalog_name=amperity_marketplace&schema_name=default HTTP/1.1" 200 None
2025-06-04 12:42:49,555 - DEBUG - Tool 'list-tables' executed successfully. Data: {'tables': [{'name': 'analytics_tae', 'full_name': 'amperity_marketplace.default.analytics_tae', 'table_type': 'MANAGED', 'data_source_format': 'DELTA', 'comment': '', 'created_at': 1705525696115, 'created_by': 'caleb@amperity.com', 'owner': 'caleb@amperity.com', 'row_count': 'Unknown', 'size_bytes': 'Unknown', 'column_count': 108, 'columns': [{'name': 'amperity_id', 'type': 'string', 'nullable': True}, {'name': 'one_and_done', 'type': 'boolean', 'nullable': True}, {'name': 'multi_purchase_brand', 'type': 'boolean', 'nullable': True}, {'name': 'multi_purchase_channel', 'type': 'boolean', 'nullable': True}, {'name': 'early_repeat_purchaser', 'type': 'boolean', 'nullable': True}, {'name': 'first_order_purchase_brand', 'type': 'string', 'nullable': True}, {'name': 'first_order_purchase_channel', 'type': 'string', 'nullable': True}, {'name': 'first_order_store_id', 'type': 'string', 'nullable': True}, {'name': 'first_order_id', 'type': 'string', 'nullable': True}, {'name': 'first_order_datetime', 'type': 'timestamp', 'nullable': True}, {'name': 'first_order_revenue', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'first_order_total_items', 'type': 'bigint', 'nullable': True}, {'name': 'first_order_is_retained', 'type': 'boolean', 'nullable': True}, {'name': 'second_order_purchase_brand', 'type': 'string', 'nullable': True}, {'name': 'second_order_purchase_channel', 'type': 'string', 'nullable': True}, {'name': 'second_order_store_id', 'type': 'string', 'nullable': True}, {'name': 'second_order_id', 'type': 'string', 'nullable': True}, {'name': 'second_order_datetime', 'type': 'timestamp', 'nullable': True}, {'name': 'second_order_revenue', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'second_order_total_items', 'type': 'bigint', 'nullable': True}, {'name': 'second_order_is_retained', 'type': 'boolean', 'nullable': True}, {'name': 'latest_order_purchase_brand', 'type': 'string', 'nullable': True}, {'name': 'latest_order_purchase_channel', 'type': 'string', 'nullable': True}, {'name': 'latest_order_store_id', 'type': 'string', 'nullable': True}, {'name': 'latest_order_id', 'type': 'string', 'nullable': True}, {'name': 'latest_order_datetime', 'type': 'timestamp', 'nullable': True}, {'name': 'latest_order_revenue', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'latest_order_total_items', 'type': 'bigint', 'nullable': True}, {'name': 'first_to_second_order_days', 'type': 'int', 'nullable': True}, {'name': 'first_to_latest_order_days', 'type': 'int', 'nullable': True}, {'name': 'days_since_latest_order', 'type': 'int', 'nullable': True}, {'name': 'lifetime_purchase_brands', 'type': 'bigint', 'nullable': True}, {'name': 'lifetime_preferred_purchase_brand', 'type': 'string', 'nullable': True}, {'name': 'lifetime_purchase_channels', 'type': 'bigint', 'nullable': True}, {'name': 'lifetime_preferred_purchase_channel', 'type': 'string', 'nullable': True}, {'name': 'lifetime_stores', 'type': 'bigint', 'nullable': True}, {'name': 'lifetime_preferred_store_id', 'type': 'string', 'nullable': True}, {'name': 'lifetime_order_revenue', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'lifetime_order_frequency', 'type': 'bigint', 'nullable': True}, {'name': 'lifetime_total_items', 'type': 'bigint', 'nullable': True}, {'name': 'lifetime_largest_order_value', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'lifetime_average_order_value', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'lifetime_average_item_price', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'lifetime_average_num_items', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'LY12M_purchase_brands', 'type': 'bigint', 'nullable': True}, {'name': 'LY12M_preferred_purchase_brand', 'type': 'string', 'nullable': True}, {'name': 'LY12M_purchase_channels', 'type': 'bigint', 'nullable': True}, {'name': 'LY12M_preferred_purchase_channel', 'type': 'string', 'nullable': True}, {'name': 'LY12M_stores', 'type': 'bigint', 'nullable': True}, {'name': 'LY12M_preferred_store_id', 'type': 'string', 'nullable': True}, {'name': 'LY12M_order_revenue', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'LY12M_order_frequency', 'type': 'bigint', 'nullable': True}, {'name': 'LY12M_total_items', 'type': 'bigint', 'nullable': True}, {'name': 'LY12M_average_order_value', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'LY12M_average_item_price', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'LY12M_average_num_items', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'L12M_purchase_brands', 'type': 'bigint', 'nullable': True}, {'name': 'L12M_preferred_purchase_brand', 'type': 'string', 'nullable': True}, {'name': 'L12M_purchase_channels', 'type': 'bigint', 'nullable': True}, {'name': 'L12M_preferred_purchase_channel', 'type': 'string', 'nullable': True}, {'name': 'L12M_stores', 'type': 'bigint', 'nullable': True}, {'name': 'L12M_preferred_store_id', 'type': 'string', 'nullable': True}, {'name': 'L12M_order_revenue', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'L12M_order_frequency', 'type': 'bigint', 'nullable': True}, {'name': 'L12M_total_items', 'type': 'bigint', 'nullable': True}, {'name': 'L12M_average_order_value', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'L12M_average_item_price', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'L12M_average_num_items', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'L30D_purchase_brands', 'type': 'bigint', 'nullable': True}, {'name': 'L30D_preferred_purchase_brand', 'type': 'string', 'nullable': True}, {'name': 'L30D_purchase_channels', 'type': 'bigint', 'nullable': True}, {'name': 'L30D_preferred_purchase_channel', 'type': 'string', 'nullable': True}, {'name': 'L30D_stores', 'type': 'bigint', 'nullable': True}, {'name': 'L30D_preferred_store_id', 'type': 'string', 'nullable': True}, {'name': 'L30D_order_revenue', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'L30D_order_frequency', 'type': 'bigint', 'nullable': True}, {'name': 'L30D_total_items', 'type': 'bigint', 'nullable': True}, {'name': 'L30D_average_order_value', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'L30D_average_item_price', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'L30D_average_num_items', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'L3M_purchase_brands', 'type': 'bigint', 'nullable': True}, {'name': 'L3M_preferred_purchase_brand', 'type': 'string', 'nullable': True}, {'name': 'L3M_purchase_channels', 'type': 'bigint', 'nullable': True}, {'name': 'L3M_preferred_purchase_channel', 'type': 'string', 'nullable': True}, {'name': 'L3M_stores', 'type': 'bigint', 'nullable': True}, {'name': 'L3M_preferred_store_id', 'type': 'string', 'nullable': True}, {'name': 'L3M_order_revenue', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'L3M_order_frequency', 'type': 'bigint', 'nullable': True}, {'name': 'L3M_total_items', 'type': 'bigint', 'nullable': True}, {'name': 'L3M_average_order_value', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'L3M_average_item_price', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'L3M_average_num_items', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'L6M_purchase_brands', 'type': 'bigint', 'nullable': True}, {'name': 'L6M_preferred_purchase_brand', 'type': 'string', 'nullable': True}, {'name': 'L6M_purchase_channels', 'type': 'bigint', 'nullable': True}, {'name': 'L6M_preferred_purchase_channel', 'type': 'string', 'nullable': True}, {'name': 'L6M_stores', 'type': 'bigint', 'nullable': True}, {'name': 'L6M_preferred_store_id', 'type': 'string', 'nullable': True}, {'name': 'L6M_order_revenue', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'L6M_order_frequency', 'type': 'bigint', 'nullable': True}, {'name': 'L6M_total_items', 'type': 'bigint', 'nullable': True}, {'name': 'L6M_average_order_value', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'L6M_average_item_price', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'L6M_average_num_items', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'L12M_rfm_score', 'type': 'int', 'nullable': True}, {'name': 'L12M_recency', 'type': 'int', 'nullable': True}, {'name': 'L12M_frequency', 'type': 'int', 'nullable': True}, {'name': 'L12M_monetary', 'type': 'int', 'nullable': True}]}, {'name': 'customer_360', 'full_name': 'amperity_marketplace.default.customer_360', 'table_type': 'MANAGED', 'data_source_format': 'DELTA', 'comment': "The 'customer_360' table contains comprehensive data about our customers. It includes personal and transactional details, as well as information about their shopping habits and loyalty status. This data can be utilized for understanding customer behavior, personalizing customer experiences, and optimizing marketing strategies. It's particularly useful for teams working on customer relationship management, marketing strategy, and data-driven decision making.", 'created_at': 1705445851596, 'created_by': 'caleb@amperity.com', 'owner': 'caleb@amperity.com', 'row_count': 'Unknown', 'size_bytes': 'Unknown', 'column_count': 69, 'columns': [{'name': 'amperity_id', 'type': 'string', 'nullable': True}, {'name': 'Email', 'type': 'string', 'nullable': True}, {'name': 'FirstName', 'type': 'string', 'nullable': True}, {'name': 'LastName', 'type': 'string', 'nullable': True}, {'name': 'Gender', 'type': 'string', 'nullable': True}, {'name': 'AddressLine1', 'type': 'string', 'nullable': True}, {'name': 'City', 'type': 'string', 'nullable': True}, {'name': 'State', 'type': 'string', 'nullable': True}, {'name': 'StateAbbr', 'type': 'string', 'nullable': True}, {'name': 'PostalCode', 'type': 'string', 'nullable': True}, {'name': 'Phone', 'type': 'string', 'nullable': True}, {'name': 'Birthdate', 'type': 'date', 'nullable': True}, {'name': 'email_sha256_hashed', 'type': 'string', 'nullable': True}, {'name': 'BirthMonth', 'type': 'string', 'nullable': True}, {'name': 'Loyalty_Members_id', 'type': 'string', 'nullable': True}, {'name': 'POS_customer_id', 'type': 'string', 'nullable': True}, {'name': 'eCommerce_customer_id', 'type': 'string', 'nullable': True}, {'name': 'LastPageViewed', 'type': 'string', 'nullable': True}, {'name': 'LastProductViewed', 'type': 'string', 'nullable': True}, {'name': 'DaysSinceLastSiteVisit', 'type': 'int', 'nullable': True}, {'name': 'NumberDevices', 'type': 'bigint', 'nullable': True}, {'name': 'Household_ID', 'type': 'string', 'nullable': True}, {'name': 'Household_Primary_Spender', 'type': 'boolean', 'nullable': True}, {'name': 'LifetimeSpend', 'type': 'decimal(38,0)', 'nullable': True}, {'name': 'TotalTransactions', 'type': 'bigint', 'nullable': True}, {'name': 'LastPurchase', 'type': 'timestamp', 'nullable': True}, {'name': 'FirstPurchase', 'type': 'timestamp', 'nullable': True}, {'name': 'FavoriteBrand', 'type': 'string', 'nullable': True}, {'name': 'FavoriteStore', 'type': 'string', 'nullable': True}, {'name': 'AOV', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'RfmScore', 'type': 'double', 'nullable': True}, {'name': 'Persona', 'type': 'string', 'nullable': True}, {'name': 'LoyaltyMember', 'type': 'boolean', 'nullable': True}, {'name': 'LoyaltyTier', 'type': 'string', 'nullable': True}, {'name': 'LoyaltyPoints', 'type': 'bigint', 'nullable': True}, {'name': 'lastProductCategory', 'type': 'string', 'nullable': True}, {'name': 'AgeGroup', 'type': 'string', 'nullable': True}, {'name': 'email_Loyalty', 'type': 'string', 'nullable': True}, {'name': 'email_POS', 'type': 'string', 'nullable': True}, {'name': 'email_eCommerce', 'type': 'string', 'nullable': True}, {'name': 'EmailOptIn', 'type': 'boolean', 'nullable': True}, {'name': 'SmsOptIn', 'type': 'boolean', 'nullable': True}, {'name': 'Clienteling_Customer_Flag', 'type': 'boolean', 'nullable': True}, {'name': 'productaffinity_1', 'type': 'string', 'nullable': True}, {'name': 'productaffinity_2', 'type': 'string', 'nullable': True}, {'name': 'productaffinity_3', 'type': 'string', 'nullable': True}, {'name': 'productaffinity_4', 'type': 'string', 'nullable': True}, {'name': 'productaffinity_5', 'type': 'string', 'nullable': True}, {'name': 'most_recent_email_send_datetime', 'type': 'date', 'nullable': True}, {'name': 'most_recent_email_open_datetime', 'type': 'date', 'nullable': True}, {'name': 'most_recent_email_click_date', 'type': 'timestamp', 'nullable': True}, {'name': 'email_opens_last_7_days', 'type': 'bigint', 'nullable': True}, {'name': 'email_clicks_last_7_days', 'type': 'bigint', 'nullable': True}, {'name': 'predicted_customer_lifecycle_status', 'type': 'string', 'nullable': True}, {'name': 'predicted_customer_lifetime_value_tier', 'type': 'string', 'nullable': True}, {'name': 'predicted_LifeTimeValue', 'type': 'double', 'nullable': True}, {'name': 'Holiday_Shopper', 'type': 'string', 'nullable': True}, {'name': 'Gifter', 'type': 'string', 'nullable': True}, {'name': 'Campaigns_Received_L7D', 'type': 'bigint', 'nullable': True}, {'name': 'Campaigns_Planned_N7D', 'type': 'bigint', 'nullable': True}, {'name': 'count_emails', 'type': 'bigint', 'nullable': True}, {'name': 'count_addresses', 'type': 'bigint', 'nullable': True}, {'name': 'count_phones', 'type': 'bigint', 'nullable': True}, {'name': 'count_given_names', 'type': 'bigint', 'nullable': True}, {'name': 'count_surnames', 'type': 'bigint', 'nullable': True}, {'name': 'count_records', 'type': 'bigint', 'nullable': True}, {'name': 'most_recent_email', 'type': 'string', 'nullable': True}, {'name': 'most_recent_phone', 'type': 'string', 'nullable': True}, {'name': 'most_recent_address', 'type': 'string', 'nullable': True}]}, {'name': 'customer_attributes', 'full_name': 'amperity_marketplace.default.customer_attributes', 'table_type': 'MANAGED', 'data_source_format': 'DELTA', 'comment': '', 'created_at': 1705446449108, 'created_by': 'caleb@amperity.com', 'owner': 'caleb@amperity.com', 'row_count': 'Unknown', 'size_bytes': 'Unknown', 'column_count': 27, 'columns': [{'name': 'amperity_id', 'type': 'string', 'nullable': True}, {'name': 'is_purchaser', 'type': 'boolean', 'nullable': True}, {'name': 'is_prospect', 'type': 'boolean', 'nullable': True}, {'name': 'is_primary_buyer_household', 'type': 'boolean', 'nullable': True}, {'name': 'is_test_account', 'type': 'boolean', 'nullable': True}, {'name': 'is_gift_giver', 'type': 'boolean', 'nullable': True}, {'name': 'is_business', 'type': 'boolean', 'nullable': True}, {'name': 'is_employee', 'type': 'boolean', 'nullable': True}, {'name': 'is_outlier', 'type': 'boolean', 'nullable': True}, {'name': 'historical_purchaser_lifecycle_status', 'type': 'string', 'nullable': True}, {'name': 'MosaicSegment', 'type': 'string', 'nullable': True}, {'name': 'AssignedStylist', 'type': 'string', 'nullable': True}, {'name': 'Event_Attendee', 'type': 'string', 'nullable': True}, {'name': 'PLCC_Card_Member', 'type': 'string', 'nullable': True}, {'name': 'PLCC_Card_Type', 'type': 'string', 'nullable': True}, {'name': 'contactable_email', 'type': 'boolean', 'nullable': True}, {'name': 'is_opted_into_email', 'type': 'boolean', 'nullable': True}, {'name': 'contactable_phone', 'type': 'boolean', 'nullable': True}, {'name': 'is_opted_into_sms', 'type': 'boolean', 'nullable': True}, {'name': 'contactable_address', 'type': 'boolean', 'nullable': True}, {'name': 'contactable_paid_social', 'type': 'boolean', 'nullable': True}, {'name': 'is_no_pii_amperity_id', 'type': 'boolean', 'nullable': True}, {'name': 'contactable_global', 'type': 'boolean', 'nullable': True}, {'name': 'churn_trigger', 'type': 'string', 'nullable': True}, {'name': 'churn_trigger_start_datetime', 'type': 'timestamp', 'nullable': True}, {'name': 'Campaigns_Received_L7D', 'type': 'string', 'nullable': True}, {'name': 'Campaigns_Planned_N7D', 'type': 'string', 'nullable': True}]}, {'name': 'email_engagement_attributes', 'full_name': 'amperity_marketplace.default.email_engagement_attributes', 'table_type': 'MANAGED', 'data_source_format': 'DELTA', 'comment': '', 'created_at': 1705446690609, 'created_by': 'caleb@amperity.com', 'owner': 'caleb@amperity.com', 'row_count': 'Unknown', 'size_bytes': 'Unknown', 'column_count': 29, 'columns': [{'name': 'amperity_id', 'type': 'string', 'nullable': True}, {'name': 'email', 'type': 'string', 'nullable': True}, {'name': 'brand', 'type': 'string', 'nullable': True}, {'name': 'first_email_send_datetime', 'type': 'date', 'nullable': True}, {'name': 'most_recent_email_send_datetime', 'type': 'date', 'nullable': True}, {'name': 'first_email_open_datetime', 'type': 'date', 'nullable': True}, {'name': 'most_recent_email_open_datetime', 'type': 'date', 'nullable': True}, {'name': 'first_email_click_datetime', 'type': 'date', 'nullable': True}, {'name': 'most_recent_email_click_datetime', 'type': 'date', 'nullable': True}, {'name': 'engagement_status_last_15_months', 'type': 'string', 'nullable': True}, {'name': 'engagement_frequency_last_15_months', 'type': 'string', 'nullable': True}, {'name': 'email_opens_last_1_day', 'type': 'bigint', 'nullable': True}, {'name': 'email_opens_last_3_days', 'type': 'bigint', 'nullable': True}, {'name': 'email_opens_last_5_days', 'type': 'bigint', 'nullable': True}, {'name': 'email_opens_last_7_days', 'type': 'bigint', 'nullable': True}, {'name': 'email_opens_last_14_days', 'type': 'bigint', 'nullable': True}, {'name': 'email_opens_last_3_months', 'type': 'bigint', 'nullable': True}, {'name': 'email_opens_last_6_months', 'type': 'bigint', 'nullable': True}, {'name': 'email_opens_last_9_months', 'type': 'bigint', 'nullable': True}, {'name': 'email_opens_last_12_months', 'type': 'bigint', 'nullable': True}, {'name': 'email_clicks_last_1_day', 'type': 'bigint', 'nullable': True}, {'name': 'email_clicks_last_3_days', 'type': 'bigint', 'nullable': True}, {'name': 'email_clicks_last_5_days', 'type': 'bigint', 'nullable': True}, {'name': 'email_clicks_last_7_days', 'type': 'bigint', 'nullable': True}, {'name': 'email_clicks_last_14_days', 'type': 'bigint', 'nullable': True}, {'name': 'email_clicks_last_3_months', 'type': 'bigint', 'nullable': True}, {'name': 'email_clicks_last_6_months', 'type': 'bigint', 'nullable': True}, {'name': 'email_clicks_last_9_months', 'type': 'bigint', 'nullable': True}, {'name': 'email_clicks_last_12_months', 'type': 'bigint', 'nullable': True}]}, {'name': 'email_engagement_summary', 'full_name': 'amperity_marketplace.default.email_engagement_summary', 'table_type': 'MANAGED', 'data_source_format': 'DELTA', 'comment': '', 'created_at': 1705446675152, 'created_by': 'caleb@amperity.com', 'owner': 'caleb@amperity.com', 'row_count': 'Unknown', 'size_bytes': 'Unknown', 'column_count': 30, 'columns': [{'name': 'email', 'type': 'string', 'nullable': True}, {'name': 'brand', 'type': 'string', 'nullable': True}, {'name': 'first_email_send_datetime', 'type': 'date', 'nullable': True}, {'name': 'most_recent_email_send_datetime', 'type': 'date', 'nullable': True}, {'name': 'first_email_open_datetime', 'type': 'date', 'nullable': True}, {'name': 'most_recent_email_open_datetime', 'type': 'date', 'nullable': True}, {'name': 'first_email_click_datetime', 'type': 'date', 'nullable': True}, {'name': 'most_recent_email_click_datetime', 'type': 'date', 'nullable': True}, {'name': 'engagement_status_last_15_months', 'type': 'string', 'nullable': True}, {'name': 'engagement_frequency_last_15_months', 'type': 'string', 'nullable': True}, {'name': 'email_opens_last_1_day', 'type': 'bigint', 'nullable': True}, {'name': 'email_opens_last_3_days', 'type': 'bigint', 'nullable': True}, {'name': 'email_opens_last_5_days', 'type': 'bigint', 'nullable': True}, {'name': 'email_opens_last_7_days', 'type': 'bigint', 'nullable': True}, {'name': 'email_opens_last_14_days', 'type': 'bigint', 'nullable': True}, {'name': 'email_opens_last_30_days', 'type': 'bigint', 'nullable': True}, {'name': 'email_opens_last_3_months', 'type': 'bigint', 'nullable': True}, {'name': 'email_opens_last_6_months', 'type': 'bigint', 'nullable': True}, {'name': 'email_opens_last_9_months', 'type': 'bigint', 'nullable': True}, {'name': 'email_opens_last_12_months', 'type': 'bigint', 'nullable': True}, {'name': 'email_clicks_last_1_day', 'type': 'bigint', 'nullable': True}, {'name': 'email_clicks_last_3_days', 'type': 'bigint', 'nullable': True}, {'name': 'email_clicks_last_5_days', 'type': 'bigint', 'nullable': True}, {'name': 'email_clicks_last_7_days', 'type': 'bigint', 'nullable': True}, {'name': 'email_clicks_last_14_days', 'type': 'bigint', 'nullable': True}, {'name': 'email_clicks_last_30_days', 'type': 'bigint', 'nullable': True}, {'name': 'email_clicks_last_3_months', 'type': 'bigint', 'nullable': True}, {'name': 'email_clicks_last_6_months', 'type': 'bigint', 'nullable': True}, {'name': 'email_clicks_last_9_months', 'type': 'bigint', 'nullable': True}, {'name': 'email_clicks_last_12_months', 'type': 'bigint', 'nullable': True}]}, {'name': 'predicted_affinity', 'full_name': 'amperity_marketplace.default.predicted_affinity', 'table_type': 'MANAGED', 'data_source_format': 'DELTA', 'comment': '', 'created_at': 1705446536920, 'created_by': 'caleb@amperity.com', 'owner': 'caleb@amperity.com', 'row_count': 'Unknown', 'size_bytes': 'Unknown', 'column_count': 7, 'columns': [{'name': 'product_attribute', 'type': 'string', 'nullable': True}, {'name': 'amperity_id', 'type': 'string', 'nullable': True}, {'name': 'score', 'type': 'double', 'nullable': True}, {'name': 'ranking', 'type': 'bigint', 'nullable': True}, {'name': 'audience_size_small', 'type': 'boolean', 'nullable': True}, {'name': 'audience_size_medium', 'type': 'boolean', 'nullable': True}, {'name': 'audience_size_large', 'type': 'boolean', 'nullable': True}]}, {'name': 'predicted_clv_attributes', 'full_name': 'amperity_marketplace.default.predicted_clv_attributes', 'table_type': 'MANAGED', 'data_source_format': 'DELTA', 'comment': '', 'created_at': 1705446482055, 'created_by': 'caleb@amperity.com', 'owner': 'caleb@amperity.com', 'row_count': 'Unknown', 'size_bytes': 'Unknown', 'column_count': 7, 'columns': [{'name': 'amperity_id', 'type': 'string', 'nullable': True}, {'name': 'predicted_probability_of_transaction_next_365d', 'type': 'double', 'nullable': True}, {'name': 'predicted_order_frequency_next_365d', 'type': 'double', 'nullable': True}, {'name': 'predicted_average_order_revenue_next_365d', 'type': 'double', 'nullable': True}, {'name': 'predicted_clv_next_365d', 'type': 'double', 'nullable': True}, {'name': 'predicted_customer_lifecycle_status', 'type': 'string', 'nullable': True}, {'name': 'predicted_customer_lifetime_value_tier', 'type': 'string', 'nullable': True}]}, {'name': 'transaction_attributes', 'full_name': 'amperity_marketplace.default.transaction_attributes', 'table_type': 'MANAGED', 'data_source_format': 'DELTA', 'comment': '', 'created_at': 1705446572768, 'created_by': 'caleb@amperity.com', 'owner': 'caleb@amperity.com', 'row_count': 'Unknown', 'size_bytes': 'Unknown', 'column_count': 28, 'columns': [{'name': 'amperity_id', 'type': 'string', 'nullable': True}, {'name': 'multi_purchase_brand', 'type': 'boolean', 'nullable': True}, {'name': 'multi_purchase_channel', 'type': 'boolean', 'nullable': True}, {'name': 'one_and_done', 'type': 'boolean', 'nullable': True}, {'name': 'early_repeat_purchaser', 'type': 'boolean', 'nullable': True}, {'name': 'first_order_id', 'type': 'string', 'nullable': True}, {'name': 'first_order_datetime', 'type': 'timestamp', 'nullable': True}, {'name': 'first_order_revenue', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'first_order_total_items', 'type': 'bigint', 'nullable': True}, {'name': 'first_order_is_retained', 'type': 'boolean', 'nullable': True}, {'name': 'second_order_id', 'type': 'string', 'nullable': True}, {'name': 'second_order_datetime', 'type': 'timestamp', 'nullable': True}, {'name': 'second_order_revenue', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'second_order_total_items', 'type': 'bigint', 'nullable': True}, {'name': 'second_order_is_retained', 'type': 'boolean', 'nullable': True}, {'name': 'latest_order_id', 'type': 'string', 'nullable': True}, {'name': 'latest_order_datetime', 'type': 'timestamp', 'nullable': True}, {'name': 'latest_order_revenue', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'latest_order_total_items', 'type': 'bigint', 'nullable': True}, {'name': 'lifetime_preferred_purchase_brand', 'type': 'string', 'nullable': True}, {'name': 'lifetime_preferred_purchase_channel', 'type': 'string', 'nullable': True}, {'name': 'lifetime_order_revenue', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'lifetime_order_frequency', 'type': 'bigint', 'nullable': True}, {'name': 'lifetime_total_items', 'type': 'bigint', 'nullable': True}, {'name': 'lifetime_largest_order_value', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'lifetime_average_order_value', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'lifetime_average_item_price', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'lifetime_average_num_items', 'type': 'decimal(38,2)', 'nullable': True}]}, {'name': 'transaction_attributes_extended', 'full_name': 'amperity_marketplace.default.transaction_attributes_extended', 'table_type': 'MANAGED', 'data_source_format': 'DELTA', 'comment': '', 'created_at': 1705446651213, 'created_by': 'caleb@amperity.com', 'owner': 'caleb@amperity.com', 'row_count': 'Unknown', 'size_bytes': 'Unknown', 'column_count': 108, 'columns': [{'name': 'amperity_id', 'type': 'string', 'nullable': True}, {'name': 'one_and_done', 'type': 'boolean', 'nullable': True}, {'name': 'multi_purchase_brand', 'type': 'boolean', 'nullable': True}, {'name': 'multi_purchase_channel', 'type': 'boolean', 'nullable': True}, {'name': 'early_repeat_purchaser', 'type': 'boolean', 'nullable': True}, {'name': 'first_order_purchase_brand', 'type': 'string', 'nullable': True}, {'name': 'first_order_purchase_channel', 'type': 'string', 'nullable': True}, {'name': 'first_order_store_id', 'type': 'string', 'nullable': True}, {'name': 'first_order_id', 'type': 'string', 'nullable': True}, {'name': 'first_order_datetime', 'type': 'timestamp', 'nullable': True}, {'name': 'first_order_revenue', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'first_order_total_items', 'type': 'bigint', 'nullable': True}, {'name': 'first_order_is_retained', 'type': 'boolean', 'nullable': True}, {'name': 'second_order_purchase_brand', 'type': 'string', 'nullable': True}, {'name': 'second_order_purchase_channel', 'type': 'string', 'nullable': True}, {'name': 'second_order_store_id', 'type': 'string', 'nullable': True}, {'name': 'second_order_id', 'type': 'string', 'nullable': True}, {'name': 'second_order_datetime', 'type': 'timestamp', 'nullable': True}, {'name': 'second_order_revenue', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'second_order_total_items', 'type': 'bigint', 'nullable': True}, {'name': 'second_order_is_retained', 'type': 'boolean', 'nullable': True}, {'name': 'latest_order_purchase_brand', 'type': 'string', 'nullable': True}, {'name': 'latest_order_purchase_channel', 'type': 'string', 'nullable': True}, {'name': 'latest_order_store_id', 'type': 'string', 'nullable': True}, {'name': 'latest_order_id', 'type': 'string', 'nullable': True}, {'name': 'latest_order_datetime', 'type': 'timestamp', 'nullable': True}, {'name': 'latest_order_revenue', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'latest_order_total_items', 'type': 'bigint', 'nullable': True}, {'name': 'first_to_second_order_days', 'type': 'int', 'nullable': True}, {'name': 'first_to_latest_order_days', 'type': 'int', 'nullable': True}, {'name': 'days_since_latest_order', 'type': 'int', 'nullable': True}, {'name': 'lifetime_purchase_brands', 'type': 'bigint', 'nullable': True}, {'name': 'lifetime_preferred_purchase_brand', 'type': 'string', 'nullable': True}, {'name': 'lifetime_purchase_channels', 'type': 'bigint', 'nullable': True}, {'name': 'lifetime_preferred_purchase_channel', 'type': 'string', 'nullable': True}, {'name': 'lifetime_stores', 'type': 'bigint', 'nullable': True}, {'name': 'lifetime_preferred_store_id', 'type': 'string', 'nullable': True}, {'name': 'lifetime_order_revenue', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'lifetime_order_frequency', 'type': 'bigint', 'nullable': True}, {'name': 'lifetime_total_items', 'type': 'bigint', 'nullable': True}, {'name': 'lifetime_largest_order_value', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'lifetime_average_order_value', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'lifetime_average_item_price', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'lifetime_average_num_items', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'LY12M_purchase_brands', 'type': 'bigint', 'nullable': True}, {'name': 'LY12M_preferred_purchase_brand', 'type': 'string', 'nullable': True}, {'name': 'LY12M_purchase_channels', 'type': 'bigint', 'nullable': True}, {'name': 'LY12M_preferred_purchase_channel', 'type': 'string', 'nullable': True}, {'name': 'LY12M_stores', 'type': 'bigint', 'nullable': True}, {'name': 'LY12M_preferred_store_id', 'type': 'string', 'nullable': True}, {'name': 'LY12M_order_revenue', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'LY12M_order_frequency', 'type': 'bigint', 'nullable': True}, {'name': 'LY12M_total_items', 'type': 'bigint', 'nullable': True}, {'name': 'LY12M_average_order_value', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'LY12M_average_item_price', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'LY12M_average_num_items', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'L12M_purchase_brands', 'type': 'bigint', 'nullable': True}, {'name': 'L12M_preferred_purchase_brand', 'type': 'string', 'nullable': True}, {'name': 'L12M_purchase_channels', 'type': 'bigint', 'nullable': True}, {'name': 'L12M_preferred_purchase_channel', 'type': 'string', 'nullable': True}, {'name': 'L12M_stores', 'type': 'bigint', 'nullable': True}, {'name': 'L12M_preferred_store_id', 'type': 'string', 'nullable': True}, {'name': 'L12M_order_revenue', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'L12M_order_frequency', 'type': 'bigint', 'nullable': True}, {'name': 'L12M_total_items', 'type': 'bigint', 'nullable': True}, {'name': 'L12M_average_order_value', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'L12M_average_item_price', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'L12M_average_num_items', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'L30D_purchase_brands', 'type': 'bigint', 'nullable': True}, {'name': 'L30D_preferred_purchase_brand', 'type': 'string', 'nullable': True}, {'name': 'L30D_purchase_channels', 'type': 'bigint', 'nullable': True}, {'name': 'L30D_preferred_purchase_channel', 'type': 'string', 'nullable': True}, {'name': 'L30D_stores', 'type': 'bigint', 'nullable': True}, {'name': 'L30D_preferred_store_id', 'type': 'string', 'nullable': True}, {'name': 'L30D_order_revenue', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'L30D_order_frequency', 'type': 'bigint', 'nullable': True}, {'name': 'L30D_total_items', 'type': 'bigint', 'nullable': True}, {'name': 'L30D_average_order_value', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'L30D_average_item_price', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'L30D_average_num_items', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'L3M_purchase_brands', 'type': 'bigint', 'nullable': True}, {'name': 'L3M_preferred_purchase_brand', 'type': 'string', 'nullable': True}, {'name': 'L3M_purchase_channels', 'type': 'bigint', 'nullable': True}, {'name': 'L3M_preferred_purchase_channel', 'type': 'string', 'nullable': True}, {'name': 'L3M_stores', 'type': 'bigint', 'nullable': True}, {'name': 'L3M_preferred_store_id', 'type': 'string', 'nullable': True}, {'name': 'L3M_order_revenue', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'L3M_order_frequency', 'type': 'bigint', 'nullable': True}, {'name': 'L3M_total_items', 'type': 'bigint', 'nullable': True}, {'name': 'L3M_average_order_value', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'L3M_average_item_price', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'L3M_average_num_items', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'L6M_purchase_brands', 'type': 'bigint', 'nullable': True}, {'name': 'L6M_preferred_purchase_brand', 'type': 'string', 'nullable': True}, {'name': 'L6M_purchase_channels', 'type': 'bigint', 'nullable': True}, {'name': 'L6M_preferred_purchase_channel', 'type': 'string', 'nullable': True}, {'name': 'L6M_stores', 'type': 'bigint', 'nullable': True}, {'name': 'L6M_preferred_store_id', 'type': 'string', 'nullable': True}, {'name': 'L6M_order_revenue', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'L6M_order_frequency', 'type': 'bigint', 'nullable': True}, {'name': 'L6M_total_items', 'type': 'bigint', 'nullable': True}, {'name': 'L6M_average_order_value', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'L6M_average_item_price', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'L6M_average_num_items', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'L12M_rfm_score', 'type': 'int', 'nullable': True}, {'name': 'L12M_recency', 'type': 'int', 'nullable': True}, {'name': 'L12M_frequency', 'type': 'int', 'nullable': True}, {'name': 'L12M_monetary', 'type': 'int', 'nullable': True}]}, {'name': 'unified_transactions_reporting', 'full_name': 'amperity_marketplace.default.unified_transactions_reporting', 'table_type': 'MANAGED', 'data_source_format': 'DELTA', 'comment': '', 'created_at': 1705530032515, 'created_by': 'caleb@amperity.com', 'owner': 'caleb@amperity.com', 'row_count': 'Unknown', 'size_bytes': 'Unknown', 'column_count': 23, 'columns': [{'name': 'amperity_id', 'type': 'string', 'nullable': True}, {'name': 'order_id', 'type': 'string', 'nullable': True}, {'name': 'order_datetime', 'type': 'timestamp', 'nullable': True}, {'name': 'order_date', 'type': 'date', 'nullable': True}, {'name': 'fiscal_year', 'type': 'bigint', 'nullable': True}, {'name': 'fiscal_quarter', 'type': 'string', 'nullable': True}, {'name': 'fiscal_month', 'type': 'string', 'nullable': True}, {'name': 'fiscal_week_number', 'type': 'bigint', 'nullable': True}, {'name': 'purchase_channel', 'type': 'string', 'nullable': True}, {'name': 'purchase_brand', 'type': 'string', 'nullable': True}, {'name': 'order_quantity', 'type': 'bigint', 'nullable': True}, {'name': 'store_id', 'type': 'string', 'nullable': True}, {'name': 'order_revenue', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'order_discount_amount', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'order_returned_quantity', 'type': 'bigint', 'nullable': True}, {'name': 'order_returned_revenue', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'order_cancelled_quantity', 'type': 'bigint', 'nullable': True}, {'name': 'order_cancelled_revenue', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'first_overall_order_date', 'type': 'timestamp', 'nullable': True}, {'name': 'Customer_Type_at_Order_Date', 'type': 'string', 'nullable': True}, {'name': 'prev_order_date', 'type': 'timestamp', 'nullable': True}, {'name': 'days_to_next_order', 'type': 'int', 'nullable': True}, {'name': 'order_number_count', 'type': 'int', 'nullable': True}]}], 'total_count': 10, 'catalog_name': 'amperity_marketplace', 'schema_name': 'default'}
2025-06-04 12:42:49,561 - DEBUG - close.started
2025-06-04 12:42:49,561 - DEBUG - close.complete
2025-06-04 12:42:49,561 - DEBUG - close.started
2025-06-04 12:42:49,561 - DEBUG - close.complete
2025-06-04 12:42:49,641 - DEBUG - connect_tcp.started host='dbc-df998298-4c7e.cloud.databricks.com' port=443 local_address=None timeout=5.0 socket_options=None
2025-06-04 12:42:49,666 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x10b0cf930>
2025-06-04 12:42:49,666 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x1096ffc80> server_hostname='dbc-df998298-4c7e.cloud.databricks.com' timeout=5.0
2025-06-04 12:42:49,716 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x1096f2150>
2025-06-04 12:42:49,716 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2025-06-04 12:42:49,716 - DEBUG - send_request_headers.complete
2025-06-04 12:42:49,716 - DEBUG - send_request_body.started request=<Request [b'POST']>
2025-06-04 12:42:49,716 - DEBUG - send_request_body.complete
2025-06-04 12:42:49,716 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2025-06-04 12:42:49,890 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 400, b'Bad Request', [(b'x-amzn-requestid', b'1c101a48-1389-4280-a2a0-58fc71678d2f'), (b'x-amzn-errortype', b'ValidationException:http://internal.amazon.com/coral/com.amazon.bedrock/'), (b'content-type', b'application/json'), (b'date', b'Wed, 4 Jun 2025 19:42:49 GMT'), (b'x-databricks-org-id', b'3416276235813320'), (b'x-request-id', b'e6db7232-cc30-4c6c-9cc4-fd649b2a3c13'), (b'content-encoding', b'gzip'), (b'vary', b'Accept-Encoding'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'x-content-type-options', b'nosniff'), (b'server', b'databricks'), (b'transfer-encoding', b'chunked')])
2025-06-04 12:42:49,890 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2025-06-04 12:42:49,891 - DEBUG - receive_response_body.complete
2025-06-04 12:42:49,891 - DEBUG - response_closed.started
2025-06-04 12:42:49,891 - DEBUG - response_closed.complete
2025-06-04 12:42:49,893 - ERROR - Agent error: Error code: 400 - {'error_code': 'BAD_REQUEST', 'message': '{"message":"messages: text content blocks must be non-empty"}'}
Traceback (most recent call last):
  File "/Users/johnrush/repos/clamp-internal/src/commands/agent.py", line 108, in handle_command
    response = agent.process_query(query)
  File "/Users/johnrush/repos/clamp-internal/src/agent/manager.py", line 305, in process_query
    return self.process_with_tools(tools)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "/Users/johnrush/repos/clamp-internal/src/agent/manager.py", line 193, in process_with_tools
    response = self.llm_client.chat(
        messages=current_history,  # Use the modified temporary history for the call
    ...<2 lines>...
        stream=False,  # Important: No streaming within the loop
    )
  File "/Users/johnrush/repos/clamp-internal/src/llm/client.py", line 56, in chat
    response = client.chat.completions.create(
        model=model,
    ...<3 lines>...
        tool_choice=tool_choice,
    )
  File "/Users/johnrush/repos/clamp-internal/.venv/lib/python3.13/site-packages/openai/_utils/_utils.py", line 287, in wrapper
    return func(*args, **kwargs)
  File "/Users/johnrush/repos/clamp-internal/.venv/lib/python3.13/site-packages/openai/resources/chat/completions/completions.py", line 925, in create
    return self._post(
           ~~~~~~~~~~^
        "/chat/completions",
        ^^^^^^^^^^^^^^^^^^^^
    ...<43 lines>...
        stream_cls=Stream[ChatCompletionChunk],
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/johnrush/repos/clamp-internal/.venv/lib/python3.13/site-packages/openai/_base_client.py", line 1239, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
                           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnrush/repos/clamp-internal/.venv/lib/python3.13/site-packages/openai/_base_client.py", line 1034, in request
    raise self._make_status_error_from_response(err.response) from None
openai.BadRequestError: Error code: 400 - {'error_code': 'BAD_REQUEST', 'message': '{"message":"messages: text content blocks must be non-empty"}'}
2025-06-04 12:42:49,900 - DEBUG - Using selector: KqueueSelector
