2025-06-04 12:41:24,733 - DEBUG - Logging initialized. Writing to /Users/johnrush/repos/clamp-internal/log/sessions/2025-06-04_12-41-24.log
2025-06-04 12:41:24,734 - DEBUG - Loaded configuration from /Users/johnrush/.chuck_config.json
2025-06-04 12:41:24,740 - DEBUG - Using selector: KqueueSelector
2025-06-04 12:41:25,813 - DEBUG - GET request to: https://dbc-df998298-4c7e.cloud.databricks.com/api/2.1/unity-catalog/schemas/amperity_marketplace.bronze
2025-06-04 12:41:25,823 - DEBUG - Starting new HTTPS connection (1): dbc-df998298-4c7e.cloud.databricks.com:443
2025-06-04 12:41:25,950 - DEBUG - https://dbc-df998298-4c7e.cloud.databricks.com:443 "GET /api/2.1/unity-catalog/schemas/amperity_marketplace.bronze HTTP/1.1" 200 None
2025-06-04 12:41:25,953 - DEBUG - Saved configuration to /Users/johnrush/.chuck_config.json
2025-06-04 12:41:25,958 - DEBUG - Using selector: KqueueSelector
2025-06-04 12:41:26,048 - DEBUG - connect_tcp.started host='dbc-df998298-4c7e.cloud.databricks.com' port=443 local_address=None timeout=5.0 socket_options=None
2025-06-04 12:41:26,068 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x10577d6a0>
2025-06-04 12:41:26,068 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x1052f3c80> server_hostname='dbc-df998298-4c7e.cloud.databricks.com' timeout=5.0
2025-06-04 12:41:26,113 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x105748a50>
2025-06-04 12:41:26,113 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2025-06-04 12:41:26,113 - DEBUG - send_request_headers.complete
2025-06-04 12:41:26,113 - DEBUG - send_request_body.started request=<Request [b'POST']>
2025-06-04 12:41:26,113 - DEBUG - send_request_body.complete
2025-06-04 12:41:26,113 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2025-06-04 12:41:30,195 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'x-amzn-requestid', b'832c1dc5-d321-4646-ba40-d3e69d2875ba'), (b'x-amzn-bedrock-invocation-latency', b'3976'), (b'x-amzn-bedrock-output-token-count', b'77'), (b'x-amzn-bedrock-input-token-count', b'4154'), (b'content-type', b'application/json'), (b'date', b'Wed, 4 Jun 2025 19:41:30 GMT'), (b'x-databricks-org-id', b'3416276235813320'), (b'x-request-id', b'f948cf9c-0d5f-48ab-bd9b-90e11acbddd4'), (b'content-encoding', b'gzip'), (b'vary', b'Accept-Encoding'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'x-content-type-options', b'nosniff'), (b'server', b'databricks'), (b'transfer-encoding', b'chunked')])
2025-06-04 12:41:30,196 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2025-06-04 12:41:30,197 - DEBUG - receive_response_body.complete
2025-06-04 12:41:30,197 - DEBUG - response_closed.started
2025-06-04 12:41:30,197 - DEBUG - response_closed.complete
2025-06-04 12:41:30,201 - DEBUG - Agent attempting to execute tool: list-tables with args: {}
2025-06-04 12:41:30,204 - DEBUG - Tool arguments for 'list-tables' validated successfully.
2025-06-04 12:41:30,205 - DEBUG - Executing agent tool 'list-tables' with handler: handle_command
2025-06-04 12:41:30,205 - DEBUG - GET request with params to: https://dbc-df998298-4c7e.cloud.databricks.com/api/2.1/unity-catalog/tables
2025-06-04 12:41:30,207 - DEBUG - Starting new HTTPS connection (1): dbc-df998298-4c7e.cloud.databricks.com:443
2025-06-04 12:41:30,386 - DEBUG - https://dbc-df998298-4c7e.cloud.databricks.com:443 "GET /api/2.1/unity-catalog/tables?catalog_name=amperity_marketplace&schema_name=bronze HTTP/1.1" 200 None
2025-06-04 12:41:30,387 - DEBUG - Tool 'list-tables' executed successfully. Data: {'tables': [{'name': 'e_commerce_customers', 'full_name': 'amperity_marketplace.bronze.e_commerce_customers', 'table_type': 'MANAGED', 'data_source_format': 'DELTA', 'comment': '', 'created_at': 1705449612155, 'created_by': 'caleb@amperity.com', 'owner': 'caleb@amperity.com', 'row_count': 'Unknown', 'size_bytes': 'Unknown', 'column_count': 19, 'columns': [{'name': 'customer_id_uuid', 'type': 'string', 'nullable': True}, {'name': 'master_id', 'type': 'bigint', 'nullable': True}, {'name': 'customer_id', 'type': 'string', 'nullable': True}, {'name': 'name_prefix', 'type': 'string', 'nullable': True}, {'name': 'name_first', 'type': 'string', 'nullable': True}, {'name': 'name_last', 'type': 'string', 'nullable': True}, {'name': 'gender', 'type': 'string', 'nullable': True}, {'name': 'email', 'type': 'string', 'nullable': True}, {'name': 'account_status', 'type': 'string', 'nullable': True}, {'name': 'addr_ln_1_txt', 'type': 'string', 'nullable': True}, {'name': 'city', 'type': 'string', 'nullable': True}, {'name': 'state', 'type': 'string', 'nullable': True}, {'name': 'postal_code', 'type': 'string', 'nullable': True}, {'name': 'birth_dt', 'type': 'date', 'nullable': True}, {'name': 'employment', 'type': 'string', 'nullable': True}, {'name': 'job_title', 'type': 'string', 'nullable': True}, {'name': 'phone', 'type': 'string', 'nullable': True}, {'name': 'dtUpdateDate', 'type': 'string', 'nullable': True}, {'name': '_updated', 'type': 'bigint', 'nullable': True}]}, {'name': 'loyalty_members', 'full_name': 'amperity_marketplace.bronze.loyalty_members', 'table_type': 'MANAGED', 'data_source_format': 'DELTA', 'comment': '', 'created_at': 1705449669759, 'created_by': 'caleb@amperity.com', 'owner': 'caleb@amperity.com', 'row_count': 'Unknown', 'size_bytes': 'Unknown', 'column_count': 19, 'columns': [{'name': 'lm_id_uuid', 'type': 'string', 'nullable': True}, {'name': 'master_id', 'type': 'bigint', 'nullable': True}, {'name': 'lm_id', 'type': 'string', 'nullable': True}, {'name': 'name_first', 'type': 'string', 'nullable': True}, {'name': 'name_last', 'type': 'string', 'nullable': True}, {'name': 'email', 'type': 'string', 'nullable': True}, {'name': 'gender', 'type': 'string', 'nullable': True}, {'name': 'address1', 'type': 'string', 'nullable': True}, {'name': 'city', 'type': 'string', 'nullable': True}, {'name': 'state', 'type': 'string', 'nullable': True}, {'name': 'postal_code', 'type': 'string', 'nullable': True}, {'name': 'birthdate', 'type': 'date', 'nullable': True}, {'name': 'created', 'type': 'date', 'nullable': True}, {'name': 'phone', 'type': 'string', 'nullable': True}, {'name': 'points', 'type': 'bigint', 'nullable': True}, {'name': 'current_tier', 'type': 'string', 'nullable': True}, {'name': 'lmProgramName', 'type': 'string', 'nullable': True}, {'name': 'dtUpdateDate', 'type': 'string', 'nullable': True}, {'name': '_updated', 'type': 'bigint', 'nullable': True}]}, {'name': 'pos_customers', 'full_name': 'amperity_marketplace.bronze.pos_customers', 'table_type': 'MANAGED', 'data_source_format': 'DELTA', 'comment': '', 'created_at': 1705449748132, 'created_by': 'caleb@amperity.com', 'owner': 'caleb@amperity.com', 'row_count': 'Unknown', 'size_bytes': 'Unknown', 'column_count': 19, 'columns': [{'name': 'customer_id_uuid', 'type': 'string', 'nullable': True}, {'name': 'master_id', 'type': 'bigint', 'nullable': True}, {'name': 'customer_id', 'type': 'string', 'nullable': True}, {'name': 'name_prefix', 'type': 'string', 'nullable': True}, {'name': 'name_first', 'type': 'string', 'nullable': True}, {'name': 'name_last', 'type': 'string', 'nullable': True}, {'name': 'gender', 'type': 'string', 'nullable': True}, {'name': 'email', 'type': 'string', 'nullable': True}, {'name': 'account_status', 'type': 'string', 'nullable': True}, {'name': 'addr_ln_1_txt', 'type': 'string', 'nullable': True}, {'name': 'city', 'type': 'string', 'nullable': True}, {'name': 'state', 'type': 'string', 'nullable': True}, {'name': 'postal_code', 'type': 'string', 'nullable': True}, {'name': 'birth_dt', 'type': 'date', 'nullable': True}, {'name': 'employment', 'type': 'string', 'nullable': True}, {'name': 'job_title', 'type': 'string', 'nullable': True}, {'name': 'phone', 'type': 'string', 'nullable': True}, {'name': 'dtUpdateDate', 'type': 'string', 'nullable': True}, {'name': '_updated', 'type': 'bigint', 'nullable': True}]}, {'name': 'web_visitors', 'full_name': 'amperity_marketplace.bronze.web_visitors', 'table_type': 'MANAGED', 'data_source_format': 'DELTA', 'comment': '', 'created_at': 1745516169030, 'created_by': 'caleb@amperity.com', 'owner': 'caleb@amperity.com', 'row_count': 'Unknown', 'size_bytes': 'Unknown', 'column_count': 3, 'columns': [{'name': 'unique_key', 'type': 'string', 'nullable': True}, {'name': 'first_party_web_id', 'type': 'string', 'nullable': True}, {'name': 'visitor_id', 'type': 'string', 'nullable': True}]}, {'name': 'wifi_connections', 'full_name': 'amperity_marketplace.bronze.wifi_connections', 'table_type': 'MANAGED', 'data_source_format': 'DELTA', 'comment': '', 'created_at': 1745516310700, 'created_by': 'caleb@amperity.com', 'owner': 'caleb@amperity.com', 'row_count': 'Unknown', 'size_bytes': 'Unknown', 'column_count': 14, 'columns': [{'name': 'PK', 'type': 'string', 'nullable': True}, {'name': 'mobile_pk_uuid', 'type': 'string', 'nullable': True}, {'name': 'master_id', 'type': 'bigint', 'nullable': True}, {'name': 'email', 'type': 'string', 'nullable': True}, {'name': 'fname', 'type': 'string', 'nullable': True}, {'name': 'lname', 'type': 'string', 'nullable': True}, {'name': 'roomOrStoreID', 'type': 'bigint', 'nullable': True}, {'name': 'postal_code', 'type': 'string', 'nullable': True}, {'name': 'client_ip', 'type': 'string', 'nullable': True}, {'name': 'login_time', 'type': 'timestamp', 'nullable': True}, {'name': 'sha', 'type': 'string', 'nullable': True}, {'name': 'device_uuid', 'type': 'string', 'nullable': True}, {'name': 'dtUpdateDate', 'type': 'string', 'nullable': True}, {'name': '_updated', 'type': 'bigint', 'nullable': True}]}], 'total_count': 5, 'catalog_name': 'amperity_marketplace', 'schema_name': 'bronze'}
2025-06-04 12:41:30,403 - DEBUG - connect_tcp.started host='dbc-df998298-4c7e.cloud.databricks.com' port=443 local_address=None timeout=5.0 socket_options=None
2025-06-04 12:41:30,427 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x1057fa0d0>
2025-06-04 12:41:30,427 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x1057705f0> server_hostname='dbc-df998298-4c7e.cloud.databricks.com' timeout=5.0
2025-06-04 12:41:30,475 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x105790640>
2025-06-04 12:41:30,475 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2025-06-04 12:41:30,475 - DEBUG - send_request_headers.complete
2025-06-04 12:41:30,475 - DEBUG - send_request_body.started request=<Request [b'POST']>
2025-06-04 12:41:30,475 - DEBUG - send_request_body.complete
2025-06-04 12:41:30,475 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2025-06-04 12:41:38,584 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'x-amzn-requestid', b'a277175e-c6be-421a-822f-05e0d45dfc81'), (b'x-amzn-bedrock-invocation-latency', b'8029'), (b'x-amzn-bedrock-output-token-count', b'218'), (b'x-amzn-bedrock-input-token-count', b'6264'), (b'content-type', b'application/json'), (b'date', b'Wed, 4 Jun 2025 19:41:38 GMT'), (b'x-databricks-org-id', b'3416276235813320'), (b'x-request-id', b'ab270812-650f-433b-8436-90cb1af727a7'), (b'content-encoding', b'gzip'), (b'vary', b'Accept-Encoding'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'x-content-type-options', b'nosniff'), (b'server', b'databricks'), (b'transfer-encoding', b'chunked')])
2025-06-04 12:41:38,586 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2025-06-04 12:41:38,586 - DEBUG - receive_response_body.complete
2025-06-04 12:41:38,586 - DEBUG - response_closed.started
2025-06-04 12:41:38,586 - DEBUG - response_closed.complete
2025-06-04 12:41:38,588 - DEBUG - Sending metric: {"event": "USAGE", "configuration": {"workspace_url": "https://dbc-df998298-4c7e.cloud.databricks.co...
2025-06-04 12:41:38,591 - DEBUG - Starting new HTTPS connection (1): chuck.amperity.com:443
2025-06-04 12:41:38,733 - DEBUG - https://chuck.amperity.com:443 "POST /api/usage HTTP/1.1" 204 0
2025-06-04 12:41:38,734 - DEBUG - Failed to send metrics: 204 - 
2025-06-04 12:41:38,739 - DEBUG - Using selector: KqueueSelector
