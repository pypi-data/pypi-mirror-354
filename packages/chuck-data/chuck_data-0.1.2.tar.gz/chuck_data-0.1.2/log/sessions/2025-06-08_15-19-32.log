2025-06-08 15:19:32,514 - DEBUG - Logging initialized. Writing to /Users/johnrush/repos/chuck-data/log/sessions/2025-06-08_15-19-32.log
2025-06-08 15:19:32,516 - DEBUG - GET request to: https://test-workspace.cloud.databricks.com/test-endpoint
2025-06-08 15:19:32,517 - DEBUG - GET request to: https://test-workspace.cloud.databricks.com/test-endpoint
2025-06-08 15:19:32,517 - DEBUG - HTTP error: HTTP 404, Response: Not Found
2025-06-08 15:19:32,518 - DEBUG - GET request to: https://test-workspace.cloud.databricks.com/test-endpoint
2025-06-08 15:19:32,518 - DEBUG - Connection error: Connection failed
2025-06-08 15:19:32,518 - DEBUG - POST request to: https://test-workspace.cloud.databricks.com/test-endpoint
2025-06-08 15:19:32,519 - DEBUG - POST request to: https://test-workspace.cloud.databricks.com/test-endpoint
2025-06-08 15:19:32,519 - DEBUG - HTTP error: HTTP 400, Response: Bad Request
2025-06-08 15:19:32,520 - DEBUG - POST request to: https://test-workspace.cloud.databricks.com/test-endpoint
2025-06-08 15:19:32,520 - DEBUG - Connection error: Connection failed
2025-06-08 15:19:32,521 - DEBUG - HTTP error: HTTP 401, Response: {"status":401,"message":"Unauthorized"}
2025-06-08 15:19:32,523 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmppy30ege7/test_config.json
2025-06-08 15:19:32,523 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmppy30ege7/test_config.json
2025-06-08 15:19:32,524 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp08safocj/test_config.json
2025-06-08 15:19:32,524 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp08safocj/test_config.json
2025-06-08 15:19:32,526 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp25dnn63m/test_config.json
2025-06-08 15:19:32,526 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp25dnn63m/test_config.json
2025-06-08 15:19:32,526 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp25dnn63m/test_config.json
2025-06-08 15:19:32,526 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp25dnn63m/test_config.json
2025-06-08 15:19:32,526 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp25dnn63m/test_config.json
2025-06-08 15:19:32,526 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp25dnn63m/test_config.json
2025-06-08 15:19:32,527 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp25dnn63m/test_config.json
2025-06-08 15:19:32,527 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp25dnn63m/test_config.json
2025-06-08 15:19:32,527 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp25dnn63m/test_config.json
2025-06-08 15:19:32,527 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp25dnn63m/test_config.json
2025-06-08 15:19:32,527 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp25dnn63m/test_config.json
2025-06-08 15:19:32,527 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp25dnn63m/test_config.json
2025-06-08 15:19:32,528 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp25dnn63m/test_config.json
2025-06-08 15:19:32,528 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp25dnn63m/test_config.json
2025-06-08 15:19:32,528 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp25dnn63m/test_config.json
2025-06-08 15:19:32,529 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpf0p0l79d/test_config.json
2025-06-08 15:19:32,529 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpf0p0l79d/test_config.json
2025-06-08 15:19:32,529 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpf0p0l79d/test_config.json
2025-06-08 15:19:32,530 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpf0p0l79d/test_config.json
2025-06-08 15:19:32,530 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpf0p0l79d/test_config.json
2025-06-08 15:19:32,530 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpf0p0l79d/test_config.json
2025-06-08 15:19:32,530 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpf0p0l79d/test_config.json
2025-06-08 15:19:32,530 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpf0p0l79d/test_config.json
2025-06-08 15:19:32,531 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpf0p0l79d/test_config.json
2025-06-08 15:19:32,531 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpf0p0l79d/test_config.json
2025-06-08 15:19:32,531 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpf0p0l79d/test_config.json
2025-06-08 15:19:32,531 - DEBUG - Using workspace_url from environment variable CHUCK_WORKSPACE_URL
2025-06-08 15:19:32,531 - DEBUG - Using active_model from environment variable CHUCK_ACTIVE_MODEL
2025-06-08 15:19:32,531 - DEBUG - Using warehouse_id from environment variable CHUCK_WAREHOUSE_ID
2025-06-08 15:19:32,531 - DEBUG - Using active_catalog from environment variable CHUCK_ACTIVE_CATALOG
2025-06-08 15:19:32,531 - DEBUG - Using active_schema from environment variable CHUCK_ACTIVE_SCHEMA
2025-06-08 15:19:32,532 - ERROR - Config file is corrupted. Using default config.
2025-06-08 15:19:32,534 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp_80kow7_/test_config.json
2025-06-08 15:19:32,535 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmphlrhihcz/test_config.json
2025-06-08 15:19:32,535 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmphlrhihcz/test_config.json
2025-06-08 15:19:32,535 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmphlrhihcz/test_config.json
2025-06-08 15:19:32,535 - DEBUG - Using databricks_token from environment variable CHUCK_DATABRICKS_TOKEN
2025-06-08 15:19:32,537 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmprky_tzvl/test_config.json
2025-06-08 15:19:32,537 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmprky_tzvl/test_config.json
2025-06-08 15:19:32,537 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmprky_tzvl/test_config.json
2025-06-08 15:19:32,537 - DEBUG - Using workspace_url from environment variable CHUCK_WORKSPACE_URL
2025-06-08 15:19:32,539 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpqkqqtk2r/test_config.json
2025-06-08 15:19:32,540 - ERROR - Config file is corrupted. Using default config.
2025-06-08 15:19:32,540 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpl4t1ch8r
2025-06-08 15:19:32,540 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpl4t1ch8r
2025-06-08 15:19:32,541 - ERROR - Config file is corrupted. Using default config.
2025-06-08 15:19:32,541 - DEBUG - Using workspace_url from environment variable CHUCK_WORKSPACE_URL
2025-06-08 15:19:32,541 - DEBUG - Using active_model from environment variable CHUCK_ACTIVE_MODEL
2025-06-08 15:19:32,541 - DEBUG - Using warehouse_id from environment variable CHUCK_WAREHOUSE_ID
2025-06-08 15:19:32,541 - DEBUG - Using active_catalog from environment variable CHUCK_ACTIVE_CATALOG
2025-06-08 15:19:32,541 - DEBUG - Using active_schema from environment variable CHUCK_ACTIVE_SCHEMA
2025-06-08 15:19:32,541 - DEBUG - Using amperity_token from environment variable CHUCK_AMPERITY_TOKEN
2025-06-08 15:19:32,541 - DEBUG - Using databricks_token from environment variable CHUCK_DATABRICKS_TOKEN
2025-06-08 15:19:32,541 - DEBUG - Using usage_tracking_consent from environment variable CHUCK_USAGE_TRACKING_CONSENT
2025-06-08 15:19:32,542 - ERROR - Config file is corrupted. Using default config.
2025-06-08 15:19:32,543 - ERROR - Config file is corrupted. Using default config.
2025-06-08 15:19:32,543 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpf9owxu27
2025-06-08 15:19:32,544 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpf9owxu27
2025-06-08 15:19:32,544 - ERROR - Config file is corrupted. Using default config.
2025-06-08 15:19:32,545 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp6y1he847
2025-06-08 15:19:32,545 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp6y1he847
2025-06-08 15:19:32,546 - ERROR - Config file is corrupted. Using default config.
2025-06-08 15:19:32,546 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmppv_6t_da
2025-06-08 15:19:32,546 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmppv_6t_da
2025-06-08 15:19:32,546 - ERROR - Connection error during token validation: Network error
2025-06-08 15:19:32,547 - ERROR - Config file is corrupted. Using default config.
2025-06-08 15:19:32,547 - INFO - Using Databricks token from environment variable. Consider using /set-token to save it to config.
2025-06-08 15:19:32,548 - ERROR - Config file is corrupted. Using default config.
2025-06-08 15:19:32,548 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpyv3su2rt
2025-06-08 15:19:32,549 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpyv3su2rt
2025-06-08 15:19:32,550 - ERROR - Config file is corrupted. Using default config.
2025-06-08 15:19:32,550 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp383jhtvc
2025-06-08 15:19:32,550 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp383jhtvc
2025-06-08 15:19:32,552 - DEBUG - GET request to: https://adb-3856707039489412.12.azuredatabricks.net/test-endpoint
2025-06-08 15:19:32,554 - DEBUG - GET request to: https://test-workspace.cloud.databricks.com/test-endpoint
2025-06-08 15:19:32,555 - DEBUG - GET request to: https://test-workspace.cloud.databricks.com/test-endpoint
2025-06-08 15:19:32,555 - DEBUG - HTTP error: HTTP 404, Response: Not Found
2025-06-08 15:19:32,556 - DEBUG - GET request to: https://test-workspace.cloud.databricks.com/test-endpoint
2025-06-08 15:19:32,556 - DEBUG - Connection error: Connection failed
2025-06-08 15:19:32,557 - DEBUG - POST request to: https://test-workspace.cloud.databricks.com/test-endpoint
2025-06-08 15:19:32,558 - DEBUG - POST request to: https://test-workspace.cloud.databricks.com/test-endpoint
2025-06-08 15:19:32,558 - DEBUG - HTTP error: HTTP 400, Response: Bad Request
2025-06-08 15:19:32,558 - DEBUG - POST request to: https://test-workspace.cloud.databricks.com/test-endpoint
2025-06-08 15:19:32,558 - DEBUG - Connection error: Connection failed
2025-06-08 15:19:32,559 - DEBUG - Token validation failed: Token validation failed
2025-06-08 15:19:32,561 - DEBUG - File upload request to: https://test-workspace.cloud.databricks.com/api/2.0/fs/files/test/path.txt
2025-06-08 15:19:32,562 - DEBUG - File upload request to: https://test-workspace.cloud.databricks.com/api/2.0/fs/files/test/path.txt
2025-06-08 15:19:32,564 - WARNING - Model 'nonexistent-model' not found
2025-06-08 15:19:32,568 - ERROR - Config file is corrupted. Using default config.
2025-06-08 15:19:32,569 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpuce_g1_9
2025-06-08 15:19:32,569 - DEBUG - Metrics tracking skipped - user has not provided consent
2025-06-08 15:19:32,570 - ERROR - Config file is corrupted. Using default config.
2025-06-08 15:19:32,570 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpdtax1np3
2025-06-08 15:19:32,571 - ERROR - Config file is corrupted. Using default config.
2025-06-08 15:19:32,571 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp6w4hqq7r
2025-06-08 15:19:32,571 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp6w4hqq7r
2025-06-08 15:19:32,571 - DEBUG - Sending metric: {"event": "USAGE", "prompt": "test prompt"}...
2025-06-08 15:19:32,572 - ERROR - Config file is corrupted. Using default config.
2025-06-08 15:19:32,572 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpzt2jtm5f
2025-06-08 15:19:32,572 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpzt2jtm5f
2025-06-08 15:19:32,572 - DEBUG - Sending metric: {"event": "USAGE", "prompt": "test prompt"}...
2025-06-08 15:19:32,573 - ERROR - Config file is corrupted. Using default config.
2025-06-08 15:19:32,573 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpfffsx9_g
2025-06-08 15:19:32,573 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpfffsx9_g
2025-06-08 15:19:32,573 - DEBUG - Sending metric: {"event": "USAGE", "prompt": "test prompt"}...
2025-06-08 15:19:32,573 - DEBUG - Error sending metrics: Test exception
Traceback (most recent call last):
  File "/Users/johnrush/repos/chuck-data/chuck_data/metrics_collector.py", line 123, in send_metric
    return self._client.submit_metrics(payload, token)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "/Users/johnrush/repos/chuck-data/tests/fixtures/amperity.py", line 60, in submit_metrics
    raise Exception("Test exception")
Exception: Test exception
2025-06-08 15:19:32,575 - ERROR - Config file is corrupted. Using default config.
2025-06-08 15:19:32,575 - DEBUG - Cannot send metrics - no authentication token available
2025-06-08 15:19:32,577 - ERROR - Failed to list models: HTTP error occurred: 404 Not Found
2025-06-08 15:19:32,577 - ERROR - Connection error when listing models: Connection failed
2025-06-08 15:19:32,579 - ERROR - Failed to get model: HTTP error occurred: 500 Internal Server Error
2025-06-08 15:19:32,579 - ERROR - Connection error when getting model: Connection failed
2025-06-08 15:19:32,584 - DEBUG - Unity Catalog check failed: Access denied
2025-06-08 15:19:32,584 - DEBUG - Jobs check failed: Forbidden
2025-06-08 15:19:32,585 - DEBUG - Volumes check failed: Access denied
2025-06-08 15:19:32,614 - DEBUG - Executing SQL: SELECT * FROM table
2025-06-08 15:19:32,616 - DEBUG - Executing SQL: SELECT * FROM table
2025-06-08 15:19:32,616 - DEBUG - Executing SQL: SELECT * FROM table
2025-06-08 15:19:32,617 - DEBUG - Executing SQL: SELECT * FROM table
2025-06-08 15:19:32,617 - DEBUG - Executing SQL: SELECT * INVALID SQL
2025-06-08 15:19:32,618 - DEBUG - Executing SQL: SELECT * INVALID SQL
