2025-06-08 13:55:10,700 - DEBUG - Logging initialized. Writing to /Users/johnrush/repos/chuck-data/log/sessions/2025-06-08_13-55-10.log
2025-06-08 13:55:10,705 - DEBUG - GET request to: https://test-workspace.cloud.databricks.com/test-endpoint
2025-06-08 13:55:10,706 - DEBUG - GET request to: https://test-workspace.cloud.databricks.com/test-endpoint
2025-06-08 13:55:10,706 - DEBUG - HTTP error: HTTP 404, Response: Not Found
2025-06-08 13:55:10,707 - DEBUG - GET request to: https://test-workspace.cloud.databricks.com/test-endpoint
2025-06-08 13:55:10,707 - DEBUG - Connection error: Connection failed
2025-06-08 13:55:10,708 - DEBUG - POST request to: https://test-workspace.cloud.databricks.com/test-endpoint
2025-06-08 13:55:10,710 - DEBUG - POST request to: https://test-workspace.cloud.databricks.com/test-endpoint
2025-06-08 13:55:10,710 - DEBUG - HTTP error: HTTP 400, Response: Bad Request
2025-06-08 13:55:10,711 - DEBUG - POST request to: https://test-workspace.cloud.databricks.com/test-endpoint
2025-06-08 13:55:10,711 - DEBUG - Connection error: Connection failed
2025-06-08 13:55:10,712 - DEBUG - HTTP error: HTTP 401, Response: {"status":401,"message":"Unauthorized"}
2025-06-08 13:55:10,715 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpx9rthlz3/test_config.json
2025-06-08 13:55:10,716 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpx9rthlz3/test_config.json
2025-06-08 13:55:10,718 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp3_j8bepq/test_config.json
2025-06-08 13:55:10,718 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp3_j8bepq/test_config.json
2025-06-08 13:55:10,720 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp9jq08wlw/test_config.json
2025-06-08 13:55:10,720 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp9jq08wlw/test_config.json
2025-06-08 13:55:10,720 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp9jq08wlw/test_config.json
2025-06-08 13:55:10,720 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp9jq08wlw/test_config.json
2025-06-08 13:55:10,721 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp9jq08wlw/test_config.json
2025-06-08 13:55:10,721 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp9jq08wlw/test_config.json
2025-06-08 13:55:10,721 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp9jq08wlw/test_config.json
2025-06-08 13:55:10,721 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp9jq08wlw/test_config.json
2025-06-08 13:55:10,722 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp9jq08wlw/test_config.json
2025-06-08 13:55:10,722 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp9jq08wlw/test_config.json
2025-06-08 13:55:10,722 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp9jq08wlw/test_config.json
2025-06-08 13:55:10,722 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp9jq08wlw/test_config.json
2025-06-08 13:55:10,722 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp9jq08wlw/test_config.json
2025-06-08 13:55:10,723 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp9jq08wlw/test_config.json
2025-06-08 13:55:10,723 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp9jq08wlw/test_config.json
2025-06-08 13:55:10,724 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpnwz2ppfa/test_config.json
2025-06-08 13:55:10,725 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpnwz2ppfa/test_config.json
2025-06-08 13:55:10,725 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpnwz2ppfa/test_config.json
2025-06-08 13:55:10,725 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpnwz2ppfa/test_config.json
2025-06-08 13:55:10,725 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpnwz2ppfa/test_config.json
2025-06-08 13:55:10,726 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpnwz2ppfa/test_config.json
2025-06-08 13:55:10,726 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpnwz2ppfa/test_config.json
2025-06-08 13:55:10,726 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpnwz2ppfa/test_config.json
2025-06-08 13:55:10,726 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpnwz2ppfa/test_config.json
2025-06-08 13:55:10,727 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpnwz2ppfa/test_config.json
2025-06-08 13:55:10,727 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpnwz2ppfa/test_config.json
2025-06-08 13:55:10,727 - DEBUG - Using workspace_url from environment variable CHUCK_WORKSPACE_URL
2025-06-08 13:55:10,727 - DEBUG - Using active_model from environment variable CHUCK_ACTIVE_MODEL
2025-06-08 13:55:10,727 - DEBUG - Using warehouse_id from environment variable CHUCK_WAREHOUSE_ID
2025-06-08 13:55:10,727 - DEBUG - Using active_catalog from environment variable CHUCK_ACTIVE_CATALOG
2025-06-08 13:55:10,727 - DEBUG - Using active_schema from environment variable CHUCK_ACTIVE_SCHEMA
2025-06-08 13:55:10,728 - ERROR - Config file is corrupted. Using default config.
2025-06-08 13:55:10,730 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpy3x9u35p/test_config.json
2025-06-08 13:55:10,731 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp7u8go5je/test_config.json
2025-06-08 13:55:10,732 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp7u8go5je/test_config.json
2025-06-08 13:55:10,732 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp7u8go5je/test_config.json
2025-06-08 13:55:10,732 - DEBUG - Using databricks_token from environment variable CHUCK_DATABRICKS_TOKEN
2025-06-08 13:55:10,734 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmptzqali98/test_config.json
2025-06-08 13:55:10,734 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmptzqali98/test_config.json
2025-06-08 13:55:10,734 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmptzqali98/test_config.json
2025-06-08 13:55:10,734 - DEBUG - Using workspace_url from environment variable CHUCK_WORKSPACE_URL
2025-06-08 13:55:10,736 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpkqdho0qi/test_config.json
2025-06-08 13:55:10,737 - ERROR - Config file is corrupted. Using default config.
2025-06-08 13:55:10,738 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpop6tkt8_
2025-06-08 13:55:10,738 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpop6tkt8_
2025-06-08 13:55:10,739 - ERROR - Config file is corrupted. Using default config.
2025-06-08 13:55:10,739 - DEBUG - Using workspace_url from environment variable CHUCK_WORKSPACE_URL
2025-06-08 13:55:10,739 - DEBUG - Using active_model from environment variable CHUCK_ACTIVE_MODEL
2025-06-08 13:55:10,739 - DEBUG - Using warehouse_id from environment variable CHUCK_WAREHOUSE_ID
2025-06-08 13:55:10,739 - DEBUG - Using active_catalog from environment variable CHUCK_ACTIVE_CATALOG
2025-06-08 13:55:10,739 - DEBUG - Using active_schema from environment variable CHUCK_ACTIVE_SCHEMA
2025-06-08 13:55:10,739 - DEBUG - Using amperity_token from environment variable CHUCK_AMPERITY_TOKEN
2025-06-08 13:55:10,739 - DEBUG - Using databricks_token from environment variable CHUCK_DATABRICKS_TOKEN
2025-06-08 13:55:10,739 - DEBUG - Using usage_tracking_consent from environment variable CHUCK_USAGE_TRACKING_CONSENT
2025-06-08 13:55:10,741 - ERROR - Config file is corrupted. Using default config.
2025-06-08 13:55:10,742 - ERROR - Config file is corrupted. Using default config.
2025-06-08 13:55:10,742 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpvrk2o_ui
2025-06-08 13:55:10,743 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpvrk2o_ui
2025-06-08 13:55:10,744 - ERROR - Config file is corrupted. Using default config.
2025-06-08 13:55:10,744 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpqf6gvnql
2025-06-08 13:55:10,745 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpqf6gvnql
2025-06-08 13:55:10,746 - ERROR - Config file is corrupted. Using default config.
2025-06-08 13:55:10,746 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpr88d8w8m
2025-06-08 13:55:10,746 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpr88d8w8m
2025-06-08 13:55:10,746 - ERROR - Connection error during token validation: Network error
2025-06-08 13:55:10,748 - ERROR - Config file is corrupted. Using default config.
2025-06-08 13:55:10,748 - INFO - Using Databricks token from environment variable. Consider using /set-token to save it to config.
2025-06-08 13:55:10,749 - ERROR - Config file is corrupted. Using default config.
2025-06-08 13:55:10,749 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpcv5a_8dg
2025-06-08 13:55:10,749 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpcv5a_8dg
2025-06-08 13:55:10,750 - ERROR - Config file is corrupted. Using default config.
2025-06-08 13:55:10,751 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpvzs7nxal
2025-06-08 13:55:10,751 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpvzs7nxal
2025-06-08 13:55:10,755 - DEBUG - GET request to: https://adb-3856707039489412.12.azuredatabricks.net/test-endpoint
2025-06-08 13:55:10,758 - DEBUG - GET request to: https://test-workspace.cloud.databricks.com/test-endpoint
2025-06-08 13:55:10,759 - DEBUG - GET request to: https://test-workspace.cloud.databricks.com/test-endpoint
2025-06-08 13:55:10,759 - DEBUG - HTTP error: HTTP 404, Response: Not Found
2025-06-08 13:55:10,760 - DEBUG - GET request to: https://test-workspace.cloud.databricks.com/test-endpoint
2025-06-08 13:55:10,760 - DEBUG - Connection error: Connection failed
2025-06-08 13:55:10,761 - DEBUG - POST request to: https://test-workspace.cloud.databricks.com/test-endpoint
2025-06-08 13:55:10,762 - DEBUG - POST request to: https://test-workspace.cloud.databricks.com/test-endpoint
2025-06-08 13:55:10,762 - DEBUG - HTTP error: HTTP 400, Response: Bad Request
2025-06-08 13:55:10,763 - DEBUG - POST request to: https://test-workspace.cloud.databricks.com/test-endpoint
2025-06-08 13:55:10,763 - DEBUG - Connection error: Connection failed
2025-06-08 13:55:10,765 - DEBUG - Token validation failed: Token validation failed
2025-06-08 13:55:10,768 - DEBUG - File upload request to: https://test-workspace.cloud.databricks.com/api/2.0/fs/files/test/path.txt
2025-06-08 13:55:10,770 - DEBUG - File upload request to: https://test-workspace.cloud.databricks.com/api/2.0/fs/files/test/path.txt
2025-06-08 13:55:10,774 - WARNING - Model 'nonexistent-model' not found
2025-06-08 13:55:10,781 - ERROR - Config file is corrupted. Using default config.
2025-06-08 13:55:10,781 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp8tu5exjs
2025-06-08 13:55:10,781 - DEBUG - Metrics tracking skipped - user has not provided consent
2025-06-08 13:55:10,782 - ERROR - Config file is corrupted. Using default config.
2025-06-08 13:55:10,783 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpavl48rsq
2025-06-08 13:55:10,784 - ERROR - Config file is corrupted. Using default config.
2025-06-08 13:55:10,785 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpb68hojes
2025-06-08 13:55:10,785 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpb68hojes
2025-06-08 13:55:10,785 - DEBUG - Sending metric: {"event": "USAGE", "prompt": "test prompt"}...
2025-06-08 13:55:10,786 - ERROR - Config file is corrupted. Using default config.
2025-06-08 13:55:10,787 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpw92003mh
2025-06-08 13:55:10,787 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpw92003mh
2025-06-08 13:55:10,787 - DEBUG - Sending metric: {"event": "USAGE", "prompt": "test prompt"}...
2025-06-08 13:55:10,788 - ERROR - Config file is corrupted. Using default config.
2025-06-08 13:55:10,788 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpvxe0etyt
2025-06-08 13:55:10,788 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpvxe0etyt
2025-06-08 13:55:10,788 - DEBUG - Sending metric: {"event": "USAGE", "prompt": "test prompt"}...
2025-06-08 13:55:10,789 - DEBUG - Error sending metrics: Test exception
Traceback (most recent call last):
  File "/Users/johnrush/repos/chuck-data/chuck_data/metrics_collector.py", line 123, in send_metric
    return self._client.submit_metrics(payload, token)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnrush/repos/chuck-data/tests/fixtures/amperity.py", line 60, in submit_metrics
    raise Exception("Test exception")
Exception: Test exception
2025-06-08 13:55:10,791 - ERROR - Config file is corrupted. Using default config.
2025-06-08 13:55:10,791 - DEBUG - Cannot send metrics - no authentication token available
2025-06-08 13:55:10,794 - ERROR - Failed to list models: HTTP error occurred: 404 Not Found
2025-06-08 13:55:10,796 - ERROR - Connection error when listing models: Connection failed
2025-06-08 13:55:10,798 - ERROR - Failed to get model: HTTP error occurred: 500 Internal Server Error
2025-06-08 13:55:10,799 - ERROR - Connection error when getting model: Connection failed
2025-06-08 13:55:10,809 - DEBUG - Unity Catalog check failed: Access denied
2025-06-08 13:55:10,809 - DEBUG - Jobs check failed: Forbidden
2025-06-08 13:55:10,809 - DEBUG - Volumes check failed: Access denied
2025-06-08 13:55:10,857 - DEBUG - Executing SQL: SELECT * FROM table
2025-06-08 13:55:10,858 - DEBUG - Executing SQL: SELECT * FROM table
2025-06-08 13:55:10,859 - DEBUG - Executing SQL: SELECT * FROM table
2025-06-08 13:55:10,860 - DEBUG - Executing SQL: SELECT * FROM table
2025-06-08 13:55:10,862 - DEBUG - Executing SQL: SELECT * INVALID SQL
2025-06-08 13:55:10,863 - DEBUG - Executing SQL: SELECT * INVALID SQL
