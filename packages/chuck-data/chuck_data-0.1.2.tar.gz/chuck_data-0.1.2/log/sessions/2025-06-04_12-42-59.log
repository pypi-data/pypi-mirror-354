2025-06-04 12:42:59,851 - DEBUG - Logging initialized. Writing to /Users/johnrush/repos/clamp-internal/log/sessions/2025-06-04_12-42-59.log
2025-06-04 12:42:59,852 - DEBUG - Loaded configuration from /Users/johnrush/.chuck_config.json
2025-06-04 12:42:59,859 - DEBUG - Using selector: KqueueSelector
2025-06-04 12:43:01,014 - DEBUG - connect_tcp.started host='dbc-df998298-4c7e.cloud.databricks.com' port=443 local_address=None timeout=5.0 socket_options=None
2025-06-04 12:43:01,036 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x105d756a0>
2025-06-04 12:43:01,036 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x1059e3b60> server_hostname='dbc-df998298-4c7e.cloud.databricks.com' timeout=5.0
2025-06-04 12:43:01,081 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x105d90550>
2025-06-04 12:43:01,081 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2025-06-04 12:43:01,081 - DEBUG - send_request_headers.complete
2025-06-04 12:43:01,081 - DEBUG - send_request_body.started request=<Request [b'POST']>
2025-06-04 12:43:01,081 - DEBUG - send_request_body.complete
2025-06-04 12:43:01,081 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2025-06-04 12:43:10,848 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'x-amzn-requestid', b'd15438b9-af61-4f0b-8669-0af2e00fae8c'), (b'x-amzn-bedrock-invocation-latency', b'9686'), (b'x-amzn-bedrock-output-token-count', b'111'), (b'x-amzn-bedrock-input-token-count', b'4155'), (b'content-type', b'application/json'), (b'date', b'Wed, 4 Jun 2025 19:43:10 GMT'), (b'x-databricks-org-id', b'3416276235813320'), (b'x-request-id', b'23ded4e9-0354-46d3-855b-780708de720c'), (b'content-encoding', b'gzip'), (b'vary', b'Accept-Encoding'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'x-content-type-options', b'nosniff'), (b'server', b'databricks'), (b'transfer-encoding', b'chunked')])
2025-06-04 12:43:10,850 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2025-06-04 12:43:10,850 - DEBUG - receive_response_body.complete
2025-06-04 12:43:10,850 - DEBUG - response_closed.started
2025-06-04 12:43:10,850 - DEBUG - response_closed.complete
2025-06-04 12:43:10,854 - DEBUG - Agent attempting to execute tool: list-schemas with args: {'catalog_name': 'amperity_marketplace'}
2025-06-04 12:43:10,855 - DEBUG - Tool arguments for 'list-schemas' validated successfully.
2025-06-04 12:43:10,855 - DEBUG - Executing agent tool 'list-schemas' with handler: handle_command
2025-06-04 12:43:10,855 - DEBUG - GET request with params to: https://dbc-df998298-4c7e.cloud.databricks.com/api/2.1/unity-catalog/schemas
2025-06-04 12:43:10,859 - DEBUG - Starting new HTTPS connection (1): dbc-df998298-4c7e.cloud.databricks.com:443
2025-06-04 12:43:11,021 - DEBUG - https://dbc-df998298-4c7e.cloud.databricks.com:443 "GET /api/2.1/unity-catalog/schemas?catalog_name=amperity_marketplace HTTP/1.1" 200 None
2025-06-04 12:43:11,022 - DEBUG - Tool 'list-schemas' executed successfully. Data: {'schemas': [{'name': 'bronze', 'full_name': 'amperity_marketplace.bronze', 'catalog_name': 'amperity_marketplace', 'comment': 'Example bronze datasets', 'created_at': 1705447103818, 'created_by': 'caleb@amperity.com', 'owner': 'caleb@amperity.com'}, {'name': 'default', 'full_name': 'amperity_marketplace.default', 'catalog_name': 'amperity_marketplace', 'comment': 'Example gold datasets', 'created_at': 1705443380217, 'created_by': 'caleb@amperity.com', 'owner': 'caleb@amperity.com'}, {'name': 'idraccelerator', 'full_name': 'amperity_marketplace.idraccelerator', 'catalog_name': 'amperity_marketplace', 'comment': '', 'created_at': 1719245397123, 'created_by': 'christian.saffici@amperity.com', 'owner': 'christian.saffici@amperity.com'}, {'name': 'information_schema', 'full_name': 'amperity_marketplace.information_schema', 'catalog_name': 'amperity_marketplace', 'comment': 'Information schema (auto-created)', 'created_at': 1705443380219, 'created_by': 'System user', 'owner': 'System user'}, {'name': 'silver', 'full_name': 'amperity_marketplace.silver', 'catalog_name': 'amperity_marketplace', 'comment': 'Example silver datasets', 'created_at': 1705446630307, 'created_by': 'caleb@amperity.com', 'owner': 'caleb@amperity.com'}, {'name': 'solution_accelerator', 'full_name': 'amperity_marketplace.solution_accelerator', 'catalog_name': 'amperity_marketplace', 'comment': '', 'created_at': 1739216178991, 'created_by': 'allyson.hepp@amperity.com', 'owner': 'allyson.hepp@amperity.com'}, {'name': 'stitch_outputs', 'full_name': 'amperity_marketplace.stitch_outputs', 'catalog_name': 'amperity_marketplace', 'comment': '', 'created_at': 1747693346496, 'created_by': 'caleb@amperity.com', 'owner': 'caleb@amperity.com'}], 'total_count': 7, 'catalog_name': 'amperity_marketplace', 'next_page_token': None}
2025-06-04 12:43:11,033 - DEBUG - connect_tcp.started host='dbc-df998298-4c7e.cloud.databricks.com' port=443 local_address=None timeout=5.0 socket_options=None
2025-06-04 12:43:11,055 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x105db1e50>
2025-06-04 12:43:11,055 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x105d58560> server_hostname='dbc-df998298-4c7e.cloud.databricks.com' timeout=5.0
2025-06-04 12:43:11,097 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x105dc0050>
2025-06-04 12:43:11,097 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2025-06-04 12:43:11,097 - DEBUG - send_request_headers.complete
2025-06-04 12:43:11,097 - DEBUG - send_request_body.started request=<Request [b'POST']>
2025-06-04 12:43:11,097 - DEBUG - send_request_body.complete
2025-06-04 12:43:11,097 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2025-06-04 12:43:14,946 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'x-amzn-requestid', b'01aff249-691a-4bb8-958c-ff1cb388d1e8'), (b'x-amzn-bedrock-invocation-latency', b'3774'), (b'x-amzn-bedrock-output-token-count', b'116'), (b'x-amzn-bedrock-input-token-count', b'4893'), (b'content-type', b'application/json'), (b'date', b'Wed, 4 Jun 2025 19:43:14 GMT'), (b'x-databricks-org-id', b'3416276235813320'), (b'x-request-id', b'9d392623-e389-4c36-95d2-8e684c9fbb1e'), (b'content-encoding', b'gzip'), (b'vary', b'Accept-Encoding'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'x-content-type-options', b'nosniff'), (b'server', b'databricks'), (b'transfer-encoding', b'chunked')])
2025-06-04 12:43:14,946 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2025-06-04 12:43:14,946 - DEBUG - receive_response_body.complete
2025-06-04 12:43:14,946 - DEBUG - response_closed.started
2025-06-04 12:43:14,946 - DEBUG - response_closed.complete
2025-06-04 12:43:14,947 - DEBUG - Agent attempting to execute tool: set-schema with args: {'schema_name': 'default'}
2025-06-04 12:43:14,947 - DEBUG - Tool arguments for 'set-schema' validated successfully.
2025-06-04 12:43:14,947 - DEBUG - Executing agent tool 'set-schema' with handler: handle_command
2025-06-04 12:43:14,947 - DEBUG - GET request to: https://dbc-df998298-4c7e.cloud.databricks.com/api/2.1/unity-catalog/schemas/amperity_marketplace.default
2025-06-04 12:43:14,948 - DEBUG - Starting new HTTPS connection (1): dbc-df998298-4c7e.cloud.databricks.com:443
2025-06-04 12:43:15,089 - DEBUG - https://dbc-df998298-4c7e.cloud.databricks.com:443 "GET /api/2.1/unity-catalog/schemas/amperity_marketplace.default HTTP/1.1" 200 None
2025-06-04 12:43:15,090 - DEBUG - Saved configuration to /Users/johnrush/.chuck_config.json
2025-06-04 12:43:15,090 - DEBUG - Tool 'set-schema' executed successfully. Data: {'schema_name': 'default', 'catalog_name': 'amperity_marketplace'}
2025-06-04 12:43:15,100 - DEBUG - connect_tcp.started host='dbc-df998298-4c7e.cloud.databricks.com' port=443 local_address=None timeout=5.0 socket_options=None
2025-06-04 12:43:15,125 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x105dc0d60>
2025-06-04 12:43:15,125 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x105d588c0> server_hostname='dbc-df998298-4c7e.cloud.databricks.com' timeout=5.0
2025-06-04 12:43:15,184 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x105d0f9b0>
2025-06-04 12:43:15,185 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2025-06-04 12:43:15,185 - DEBUG - send_request_headers.complete
2025-06-04 12:43:15,185 - DEBUG - send_request_body.started request=<Request [b'POST']>
2025-06-04 12:43:15,185 - DEBUG - send_request_body.complete
2025-06-04 12:43:15,185 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2025-06-04 12:43:19,594 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'x-amzn-requestid', b'6aba713b-aae7-45e2-8716-d4d63eca3b59'), (b'x-amzn-bedrock-invocation-latency', b'4345'), (b'x-amzn-bedrock-output-token-count', b'102'), (b'x-amzn-bedrock-input-token-count', b'5039'), (b'content-type', b'application/json'), (b'date', b'Wed, 4 Jun 2025 19:43:19 GMT'), (b'x-databricks-org-id', b'3416276235813320'), (b'x-request-id', b'c4b1e81b-4ba1-40ff-bb9e-9d6c056f3c8b'), (b'content-encoding', b'gzip'), (b'vary', b'Accept-Encoding'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'x-content-type-options', b'nosniff'), (b'server', b'databricks'), (b'transfer-encoding', b'chunked')])
2025-06-04 12:43:19,595 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2025-06-04 12:43:19,595 - DEBUG - receive_response_body.complete
2025-06-04 12:43:19,595 - DEBUG - response_closed.started
2025-06-04 12:43:19,595 - DEBUG - response_closed.complete
2025-06-04 12:43:19,598 - DEBUG - Agent attempting to execute tool: list-tables with args: {'catalog_name': 'amperity_marketplace', 'schema_name': 'default'}
2025-06-04 12:43:19,604 - DEBUG - Tool arguments for 'list-tables' validated successfully.
2025-06-04 12:43:19,604 - DEBUG - Executing agent tool 'list-tables' with handler: handle_command
2025-06-04 12:43:19,604 - DEBUG - GET request with params to: https://dbc-df998298-4c7e.cloud.databricks.com/api/2.1/unity-catalog/tables
2025-06-04 12:43:19,606 - DEBUG - Starting new HTTPS connection (1): dbc-df998298-4c7e.cloud.databricks.com:443
2025-06-04 12:43:19,812 - DEBUG - https://dbc-df998298-4c7e.cloud.databricks.com:443 "GET /api/2.1/unity-catalog/tables?catalog_name=amperity_marketplace&schema_name=default HTTP/1.1" 200 None
2025-06-04 12:43:19,815 - DEBUG - Tool 'list-tables' executed successfully. Data: {'tables': [{'name': 'analytics_tae', 'full_name': 'amperity_marketplace.default.analytics_tae', 'table_type': 'MANAGED', 'data_source_format': 'DELTA', 'comment': '', 'created_at': 1705525696115, 'created_by': 'caleb@amperity.com', 'owner': 'caleb@amperity.com', 'row_count': 'Unknown', 'size_bytes': 'Unknown', 'column_count': 108, 'columns': [{'name': 'amperity_id', 'type': 'string', 'nullable': True}, {'name': 'one_and_done', 'type': 'boolean', 'nullable': True}, {'name': 'multi_purchase_brand', 'type': 'boolean', 'nullable': True}, {'name': 'multi_purchase_channel', 'type': 'boolean', 'nullable': True}, {'name': 'early_repeat_purchaser', 'type': 'boolean', 'nullable': True}, {'name': 'first_order_purchase_brand', 'type': 'string', 'nullable': True}, {'name': 'first_order_purchase_channel', 'type': 'string', 'nullable': True}, {'name': 'first_order_store_id', 'type': 'string', 'nullable': True}, {'name': 'first_order_id', 'type': 'string', 'nullable': True}, {'name': 'first_order_datetime', 'type': 'timestamp', 'nullable': True}, {'name': 'first_order_revenue', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'first_order_total_items', 'type': 'bigint', 'nullable': True}, {'name': 'first_order_is_retained', 'type': 'boolean', 'nullable': True}, {'name': 'second_order_purchase_brand', 'type': 'string', 'nullable': True}, {'name': 'second_order_purchase_channel', 'type': 'string', 'nullable': True}, {'name': 'second_order_store_id', 'type': 'string', 'nullable': True}, {'name': 'second_order_id', 'type': 'string', 'nullable': True}, {'name': 'second_order_datetime', 'type': 'timestamp', 'nullable': True}, {'name': 'second_order_revenue', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'second_order_total_items', 'type': 'bigint', 'nullable': True}, {'name': 'second_order_is_retained', 'type': 'boolean', 'nullable': True}, {'name': 'latest_order_purchase_brand', 'type': 'string', 'nullable': True}, {'name': 'latest_order_purchase_channel', 'type': 'string', 'nullable': True}, {'name': 'latest_order_store_id', 'type': 'string', 'nullable': True}, {'name': 'latest_order_id', 'type': 'string', 'nullable': True}, {'name': 'latest_order_datetime', 'type': 'timestamp', 'nullable': True}, {'name': 'latest_order_revenue', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'latest_order_total_items', 'type': 'bigint', 'nullable': True}, {'name': 'first_to_second_order_days', 'type': 'int', 'nullable': True}, {'name': 'first_to_latest_order_days', 'type': 'int', 'nullable': True}, {'name': 'days_since_latest_order', 'type': 'int', 'nullable': True}, {'name': 'lifetime_purchase_brands', 'type': 'bigint', 'nullable': True}, {'name': 'lifetime_preferred_purchase_brand', 'type': 'string', 'nullable': True}, {'name': 'lifetime_purchase_channels', 'type': 'bigint', 'nullable': True}, {'name': 'lifetime_preferred_purchase_channel', 'type': 'string', 'nullable': True}, {'name': 'lifetime_stores', 'type': 'bigint', 'nullable': True}, {'name': 'lifetime_preferred_store_id', 'type': 'string', 'nullable': True}, {'name': 'lifetime_order_revenue', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'lifetime_order_frequency', 'type': 'bigint', 'nullable': True}, {'name': 'lifetime_total_items', 'type': 'bigint', 'nullable': True}, {'name': 'lifetime_largest_order_value', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'lifetime_average_order_value', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'lifetime_average_item_price', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'lifetime_average_num_items', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'LY12M_purchase_brands', 'type': 'bigint', 'nullable': True}, {'name': 'LY12M_preferred_purchase_brand', 'type': 'string', 'nullable': True}, {'name': 'LY12M_purchase_channels', 'type': 'bigint', 'nullable': True}, {'name': 'LY12M_preferred_purchase_channel', 'type': 'string', 'nullable': True}, {'name': 'LY12M_stores', 'type': 'bigint', 'nullable': True}, {'name': 'LY12M_preferred_store_id', 'type': 'string', 'nullable': True}, {'name': 'LY12M_order_revenue', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'LY12M_order_frequency', 'type': 'bigint', 'nullable': True}, {'name': 'LY12M_total_items', 'type': 'bigint', 'nullable': True}, {'name': 'LY12M_average_order_value', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'LY12M_average_item_price', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'LY12M_average_num_items', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'L12M_purchase_brands', 'type': 'bigint', 'nullable': True}, {'name': 'L12M_preferred_purchase_brand', 'type': 'string', 'nullable': True}, {'name': 'L12M_purchase_channels', 'type': 'bigint', 'nullable': True}, {'name': 'L12M_preferred_purchase_channel', 'type': 'string', 'nullable': True}, {'name': 'L12M_stores', 'type': 'bigint', 'nullable': True}, {'name': 'L12M_preferred_store_id', 'type': 'string', 'nullable': True}, {'name': 'L12M_order_revenue', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'L12M_order_frequency', 'type': 'bigint', 'nullable': True}, {'name': 'L12M_total_items', 'type': 'bigint', 'nullable': True}, {'name': 'L12M_average_order_value', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'L12M_average_item_price', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'L12M_average_num_items', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'L30D_purchase_brands', 'type': 'bigint', 'nullable': True}, {'name': 'L30D_preferred_purchase_brand', 'type': 'string', 'nullable': True}, {'name': 'L30D_purchase_channels', 'type': 'bigint', 'nullable': True}, {'name': 'L30D_preferred_purchase_channel', 'type': 'string', 'nullable': True}, {'name': 'L30D_stores', 'type': 'bigint', 'nullable': True}, {'name': 'L30D_preferred_store_id', 'type': 'string', 'nullable': True}, {'name': 'L30D_order_revenue', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'L30D_order_frequency', 'type': 'bigint', 'nullable': True}, {'name': 'L30D_total_items', 'type': 'bigint', 'nullable': True}, {'name': 'L30D_average_order_value', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'L30D_average_item_price', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'L30D_average_num_items', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'L3M_purchase_brands', 'type': 'bigint', 'nullable': True}, {'name': 'L3M_preferred_purchase_brand', 'type': 'string', 'nullable': True}, {'name': 'L3M_purchase_channels', 'type': 'bigint', 'nullable': True}, {'name': 'L3M_preferred_purchase_channel', 'type': 'string', 'nullable': True}, {'name': 'L3M_stores', 'type': 'bigint', 'nullable': True}, {'name': 'L3M_preferred_store_id', 'type': 'string', 'nullable': True}, {'name': 'L3M_order_revenue', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'L3M_order_frequency', 'type': 'bigint', 'nullable': True}, {'name': 'L3M_total_items', 'type': 'bigint', 'nullable': True}, {'name': 'L3M_average_order_value', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'L3M_average_item_price', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'L3M_average_num_items', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'L6M_purchase_brands', 'type': 'bigint', 'nullable': True}, {'name': 'L6M_preferred_purchase_brand', 'type': 'string', 'nullable': True}, {'name': 'L6M_purchase_channels', 'type': 'bigint', 'nullable': True}, {'name': 'L6M_preferred_purchase_channel', 'type': 'string', 'nullable': True}, {'name': 'L6M_stores', 'type': 'bigint', 'nullable': True}, {'name': 'L6M_preferred_store_id', 'type': 'string', 'nullable': True}, {'name': 'L6M_order_revenue', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'L6M_order_frequency', 'type': 'bigint', 'nullable': True}, {'name': 'L6M_total_items', 'type': 'bigint', 'nullable': True}, {'name': 'L6M_average_order_value', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'L6M_average_item_price', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'L6M_average_num_items', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'L12M_rfm_score', 'type': 'int', 'nullable': True}, {'name': 'L12M_recency', 'type': 'int', 'nullable': True}, {'name': 'L12M_frequency', 'type': 'int', 'nullable': True}, {'name': 'L12M_monetary', 'type': 'int', 'nullable': True}]}, {'name': 'customer_360', 'full_name': 'amperity_marketplace.default.customer_360', 'table_type': 'MANAGED', 'data_source_format': 'DELTA', 'comment': "The 'customer_360' table contains comprehensive data about our customers. It includes personal and transactional details, as well as information about their shopping habits and loyalty status. This data can be utilized for understanding customer behavior, personalizing customer experiences, and optimizing marketing strategies. It's particularly useful for teams working on customer relationship management, marketing strategy, and data-driven decision making.", 'created_at': 1705445851596, 'created_by': 'caleb@amperity.com', 'owner': 'caleb@amperity.com', 'row_count': 'Unknown', 'size_bytes': 'Unknown', 'column_count': 69, 'columns': [{'name': 'amperity_id', 'type': 'string', 'nullable': True}, {'name': 'Email', 'type': 'string', 'nullable': True}, {'name': 'FirstName', 'type': 'string', 'nullable': True}, {'name': 'LastName', 'type': 'string', 'nullable': True}, {'name': 'Gender', 'type': 'string', 'nullable': True}, {'name': 'AddressLine1', 'type': 'string', 'nullable': True}, {'name': 'City', 'type': 'string', 'nullable': True}, {'name': 'State', 'type': 'string', 'nullable': True}, {'name': 'StateAbbr', 'type': 'string', 'nullable': True}, {'name': 'PostalCode', 'type': 'string', 'nullable': True}, {'name': 'Phone', 'type': 'string', 'nullable': True}, {'name': 'Birthdate', 'type': 'date', 'nullable': True}, {'name': 'email_sha256_hashed', 'type': 'string', 'nullable': True}, {'name': 'BirthMonth', 'type': 'string', 'nullable': True}, {'name': 'Loyalty_Members_id', 'type': 'string', 'nullable': True}, {'name': 'POS_customer_id', 'type': 'string', 'nullable': True}, {'name': 'eCommerce_customer_id', 'type': 'string', 'nullable': True}, {'name': 'LastPageViewed', 'type': 'string', 'nullable': True}, {'name': 'LastProductViewed', 'type': 'string', 'nullable': True}, {'name': 'DaysSinceLastSiteVisit', 'type': 'int', 'nullable': True}, {'name': 'NumberDevices', 'type': 'bigint', 'nullable': True}, {'name': 'Household_ID', 'type': 'string', 'nullable': True}, {'name': 'Household_Primary_Spender', 'type': 'boolean', 'nullable': True}, {'name': 'LifetimeSpend', 'type': 'decimal(38,0)', 'nullable': True}, {'name': 'TotalTransactions', 'type': 'bigint', 'nullable': True}, {'name': 'LastPurchase', 'type': 'timestamp', 'nullable': True}, {'name': 'FirstPurchase', 'type': 'timestamp', 'nullable': True}, {'name': 'FavoriteBrand', 'type': 'string', 'nullable': True}, {'name': 'FavoriteStore', 'type': 'string', 'nullable': True}, {'name': 'AOV', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'RfmScore', 'type': 'double', 'nullable': True}, {'name': 'Persona', 'type': 'string', 'nullable': True}, {'name': 'LoyaltyMember', 'type': 'boolean', 'nullable': True}, {'name': 'LoyaltyTier', 'type': 'string', 'nullable': True}, {'name': 'LoyaltyPoints', 'type': 'bigint', 'nullable': True}, {'name': 'lastProductCategory', 'type': 'string', 'nullable': True}, {'name': 'AgeGroup', 'type': 'string', 'nullable': True}, {'name': 'email_Loyalty', 'type': 'string', 'nullable': True}, {'name': 'email_POS', 'type': 'string', 'nullable': True}, {'name': 'email_eCommerce', 'type': 'string', 'nullable': True}, {'name': 'EmailOptIn', 'type': 'boolean', 'nullable': True}, {'name': 'SmsOptIn', 'type': 'boolean', 'nullable': True}, {'name': 'Clienteling_Customer_Flag', 'type': 'boolean', 'nullable': True}, {'name': 'productaffinity_1', 'type': 'string', 'nullable': True}, {'name': 'productaffinity_2', 'type': 'string', 'nullable': True}, {'name': 'productaffinity_3', 'type': 'string', 'nullable': True}, {'name': 'productaffinity_4', 'type': 'string', 'nullable': True}, {'name': 'productaffinity_5', 'type': 'string', 'nullable': True}, {'name': 'most_recent_email_send_datetime', 'type': 'date', 'nullable': True}, {'name': 'most_recent_email_open_datetime', 'type': 'date', 'nullable': True}, {'name': 'most_recent_email_click_date', 'type': 'timestamp', 'nullable': True}, {'name': 'email_opens_last_7_days', 'type': 'bigint', 'nullable': True}, {'name': 'email_clicks_last_7_days', 'type': 'bigint', 'nullable': True}, {'name': 'predicted_customer_lifecycle_status', 'type': 'string', 'nullable': True}, {'name': 'predicted_customer_lifetime_value_tier', 'type': 'string', 'nullable': True}, {'name': 'predicted_LifeTimeValue', 'type': 'double', 'nullable': True}, {'name': 'Holiday_Shopper', 'type': 'string', 'nullable': True}, {'name': 'Gifter', 'type': 'string', 'nullable': True}, {'name': 'Campaigns_Received_L7D', 'type': 'bigint', 'nullable': True}, {'name': 'Campaigns_Planned_N7D', 'type': 'bigint', 'nullable': True}, {'name': 'count_emails', 'type': 'bigint', 'nullable': True}, {'name': 'count_addresses', 'type': 'bigint', 'nullable': True}, {'name': 'count_phones', 'type': 'bigint', 'nullable': True}, {'name': 'count_given_names', 'type': 'bigint', 'nullable': True}, {'name': 'count_surnames', 'type': 'bigint', 'nullable': True}, {'name': 'count_records', 'type': 'bigint', 'nullable': True}, {'name': 'most_recent_email', 'type': 'string', 'nullable': True}, {'name': 'most_recent_phone', 'type': 'string', 'nullable': True}, {'name': 'most_recent_address', 'type': 'string', 'nullable': True}]}, {'name': 'customer_attributes', 'full_name': 'amperity_marketplace.default.customer_attributes', 'table_type': 'MANAGED', 'data_source_format': 'DELTA', 'comment': '', 'created_at': 1705446449108, 'created_by': 'caleb@amperity.com', 'owner': 'caleb@amperity.com', 'row_count': 'Unknown', 'size_bytes': 'Unknown', 'column_count': 27, 'columns': [{'name': 'amperity_id', 'type': 'string', 'nullable': True}, {'name': 'is_purchaser', 'type': 'boolean', 'nullable': True}, {'name': 'is_prospect', 'type': 'boolean', 'nullable': True}, {'name': 'is_primary_buyer_household', 'type': 'boolean', 'nullable': True}, {'name': 'is_test_account', 'type': 'boolean', 'nullable': True}, {'name': 'is_gift_giver', 'type': 'boolean', 'nullable': True}, {'name': 'is_business', 'type': 'boolean', 'nullable': True}, {'name': 'is_employee', 'type': 'boolean', 'nullable': True}, {'name': 'is_outlier', 'type': 'boolean', 'nullable': True}, {'name': 'historical_purchaser_lifecycle_status', 'type': 'string', 'nullable': True}, {'name': 'MosaicSegment', 'type': 'string', 'nullable': True}, {'name': 'AssignedStylist', 'type': 'string', 'nullable': True}, {'name': 'Event_Attendee', 'type': 'string', 'nullable': True}, {'name': 'PLCC_Card_Member', 'type': 'string', 'nullable': True}, {'name': 'PLCC_Card_Type', 'type': 'string', 'nullable': True}, {'name': 'contactable_email', 'type': 'boolean', 'nullable': True}, {'name': 'is_opted_into_email', 'type': 'boolean', 'nullable': True}, {'name': 'contactable_phone', 'type': 'boolean', 'nullable': True}, {'name': 'is_opted_into_sms', 'type': 'boolean', 'nullable': True}, {'name': 'contactable_address', 'type': 'boolean', 'nullable': True}, {'name': 'contactable_paid_social', 'type': 'boolean', 'nullable': True}, {'name': 'is_no_pii_amperity_id', 'type': 'boolean', 'nullable': True}, {'name': 'contactable_global', 'type': 'boolean', 'nullable': True}, {'name': 'churn_trigger', 'type': 'string', 'nullable': True}, {'name': 'churn_trigger_start_datetime', 'type': 'timestamp', 'nullable': True}, {'name': 'Campaigns_Received_L7D', 'type': 'string', 'nullable': True}, {'name': 'Campaigns_Planned_N7D', 'type': 'string', 'nullable': True}]}, {'name': 'email_engagement_attributes', 'full_name': 'amperity_marketplace.default.email_engagement_attributes', 'table_type': 'MANAGED', 'data_source_format': 'DELTA', 'comment': '', 'created_at': 1705446690609, 'created_by': 'caleb@amperity.com', 'owner': 'caleb@amperity.com', 'row_count': 'Unknown', 'size_bytes': 'Unknown', 'column_count': 29, 'columns': [{'name': 'amperity_id', 'type': 'string', 'nullable': True}, {'name': 'email', 'type': 'string', 'nullable': True}, {'name': 'brand', 'type': 'string', 'nullable': True}, {'name': 'first_email_send_datetime', 'type': 'date', 'nullable': True}, {'name': 'most_recent_email_send_datetime', 'type': 'date', 'nullable': True}, {'name': 'first_email_open_datetime', 'type': 'date', 'nullable': True}, {'name': 'most_recent_email_open_datetime', 'type': 'date', 'nullable': True}, {'name': 'first_email_click_datetime', 'type': 'date', 'nullable': True}, {'name': 'most_recent_email_click_datetime', 'type': 'date', 'nullable': True}, {'name': 'engagement_status_last_15_months', 'type': 'string', 'nullable': True}, {'name': 'engagement_frequency_last_15_months', 'type': 'string', 'nullable': True}, {'name': 'email_opens_last_1_day', 'type': 'bigint', 'nullable': True}, {'name': 'email_opens_last_3_days', 'type': 'bigint', 'nullable': True}, {'name': 'email_opens_last_5_days', 'type': 'bigint', 'nullable': True}, {'name': 'email_opens_last_7_days', 'type': 'bigint', 'nullable': True}, {'name': 'email_opens_last_14_days', 'type': 'bigint', 'nullable': True}, {'name': 'email_opens_last_3_months', 'type': 'bigint', 'nullable': True}, {'name': 'email_opens_last_6_months', 'type': 'bigint', 'nullable': True}, {'name': 'email_opens_last_9_months', 'type': 'bigint', 'nullable': True}, {'name': 'email_opens_last_12_months', 'type': 'bigint', 'nullable': True}, {'name': 'email_clicks_last_1_day', 'type': 'bigint', 'nullable': True}, {'name': 'email_clicks_last_3_days', 'type': 'bigint', 'nullable': True}, {'name': 'email_clicks_last_5_days', 'type': 'bigint', 'nullable': True}, {'name': 'email_clicks_last_7_days', 'type': 'bigint', 'nullable': True}, {'name': 'email_clicks_last_14_days', 'type': 'bigint', 'nullable': True}, {'name': 'email_clicks_last_3_months', 'type': 'bigint', 'nullable': True}, {'name': 'email_clicks_last_6_months', 'type': 'bigint', 'nullable': True}, {'name': 'email_clicks_last_9_months', 'type': 'bigint', 'nullable': True}, {'name': 'email_clicks_last_12_months', 'type': 'bigint', 'nullable': True}]}, {'name': 'email_engagement_summary', 'full_name': 'amperity_marketplace.default.email_engagement_summary', 'table_type': 'MANAGED', 'data_source_format': 'DELTA', 'comment': '', 'created_at': 1705446675152, 'created_by': 'caleb@amperity.com', 'owner': 'caleb@amperity.com', 'row_count': 'Unknown', 'size_bytes': 'Unknown', 'column_count': 30, 'columns': [{'name': 'email', 'type': 'string', 'nullable': True}, {'name': 'brand', 'type': 'string', 'nullable': True}, {'name': 'first_email_send_datetime', 'type': 'date', 'nullable': True}, {'name': 'most_recent_email_send_datetime', 'type': 'date', 'nullable': True}, {'name': 'first_email_open_datetime', 'type': 'date', 'nullable': True}, {'name': 'most_recent_email_open_datetime', 'type': 'date', 'nullable': True}, {'name': 'first_email_click_datetime', 'type': 'date', 'nullable': True}, {'name': 'most_recent_email_click_datetime', 'type': 'date', 'nullable': True}, {'name': 'engagement_status_last_15_months', 'type': 'string', 'nullable': True}, {'name': 'engagement_frequency_last_15_months', 'type': 'string', 'nullable': True}, {'name': 'email_opens_last_1_day', 'type': 'bigint', 'nullable': True}, {'name': 'email_opens_last_3_days', 'type': 'bigint', 'nullable': True}, {'name': 'email_opens_last_5_days', 'type': 'bigint', 'nullable': True}, {'name': 'email_opens_last_7_days', 'type': 'bigint', 'nullable': True}, {'name': 'email_opens_last_14_days', 'type': 'bigint', 'nullable': True}, {'name': 'email_opens_last_30_days', 'type': 'bigint', 'nullable': True}, {'name': 'email_opens_last_3_months', 'type': 'bigint', 'nullable': True}, {'name': 'email_opens_last_6_months', 'type': 'bigint', 'nullable': True}, {'name': 'email_opens_last_9_months', 'type': 'bigint', 'nullable': True}, {'name': 'email_opens_last_12_months', 'type': 'bigint', 'nullable': True}, {'name': 'email_clicks_last_1_day', 'type': 'bigint', 'nullable': True}, {'name': 'email_clicks_last_3_days', 'type': 'bigint', 'nullable': True}, {'name': 'email_clicks_last_5_days', 'type': 'bigint', 'nullable': True}, {'name': 'email_clicks_last_7_days', 'type': 'bigint', 'nullable': True}, {'name': 'email_clicks_last_14_days', 'type': 'bigint', 'nullable': True}, {'name': 'email_clicks_last_30_days', 'type': 'bigint', 'nullable': True}, {'name': 'email_clicks_last_3_months', 'type': 'bigint', 'nullable': True}, {'name': 'email_clicks_last_6_months', 'type': 'bigint', 'nullable': True}, {'name': 'email_clicks_last_9_months', 'type': 'bigint', 'nullable': True}, {'name': 'email_clicks_last_12_months', 'type': 'bigint', 'nullable': True}]}, {'name': 'predicted_affinity', 'full_name': 'amperity_marketplace.default.predicted_affinity', 'table_type': 'MANAGED', 'data_source_format': 'DELTA', 'comment': '', 'created_at': 1705446536920, 'created_by': 'caleb@amperity.com', 'owner': 'caleb@amperity.com', 'row_count': 'Unknown', 'size_bytes': 'Unknown', 'column_count': 7, 'columns': [{'name': 'product_attribute', 'type': 'string', 'nullable': True}, {'name': 'amperity_id', 'type': 'string', 'nullable': True}, {'name': 'score', 'type': 'double', 'nullable': True}, {'name': 'ranking', 'type': 'bigint', 'nullable': True}, {'name': 'audience_size_small', 'type': 'boolean', 'nullable': True}, {'name': 'audience_size_medium', 'type': 'boolean', 'nullable': True}, {'name': 'audience_size_large', 'type': 'boolean', 'nullable': True}]}, {'name': 'predicted_clv_attributes', 'full_name': 'amperity_marketplace.default.predicted_clv_attributes', 'table_type': 'MANAGED', 'data_source_format': 'DELTA', 'comment': '', 'created_at': 1705446482055, 'created_by': 'caleb@amperity.com', 'owner': 'caleb@amperity.com', 'row_count': 'Unknown', 'size_bytes': 'Unknown', 'column_count': 7, 'columns': [{'name': 'amperity_id', 'type': 'string', 'nullable': True}, {'name': 'predicted_probability_of_transaction_next_365d', 'type': 'double', 'nullable': True}, {'name': 'predicted_order_frequency_next_365d', 'type': 'double', 'nullable': True}, {'name': 'predicted_average_order_revenue_next_365d', 'type': 'double', 'nullable': True}, {'name': 'predicted_clv_next_365d', 'type': 'double', 'nullable': True}, {'name': 'predicted_customer_lifecycle_status', 'type': 'string', 'nullable': True}, {'name': 'predicted_customer_lifetime_value_tier', 'type': 'string', 'nullable': True}]}, {'name': 'transaction_attributes', 'full_name': 'amperity_marketplace.default.transaction_attributes', 'table_type': 'MANAGED', 'data_source_format': 'DELTA', 'comment': '', 'created_at': 1705446572768, 'created_by': 'caleb@amperity.com', 'owner': 'caleb@amperity.com', 'row_count': 'Unknown', 'size_bytes': 'Unknown', 'column_count': 28, 'columns': [{'name': 'amperity_id', 'type': 'string', 'nullable': True}, {'name': 'multi_purchase_brand', 'type': 'boolean', 'nullable': True}, {'name': 'multi_purchase_channel', 'type': 'boolean', 'nullable': True}, {'name': 'one_and_done', 'type': 'boolean', 'nullable': True}, {'name': 'early_repeat_purchaser', 'type': 'boolean', 'nullable': True}, {'name': 'first_order_id', 'type': 'string', 'nullable': True}, {'name': 'first_order_datetime', 'type': 'timestamp', 'nullable': True}, {'name': 'first_order_revenue', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'first_order_total_items', 'type': 'bigint', 'nullable': True}, {'name': 'first_order_is_retained', 'type': 'boolean', 'nullable': True}, {'name': 'second_order_id', 'type': 'string', 'nullable': True}, {'name': 'second_order_datetime', 'type': 'timestamp', 'nullable': True}, {'name': 'second_order_revenue', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'second_order_total_items', 'type': 'bigint', 'nullable': True}, {'name': 'second_order_is_retained', 'type': 'boolean', 'nullable': True}, {'name': 'latest_order_id', 'type': 'string', 'nullable': True}, {'name': 'latest_order_datetime', 'type': 'timestamp', 'nullable': True}, {'name': 'latest_order_revenue', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'latest_order_total_items', 'type': 'bigint', 'nullable': True}, {'name': 'lifetime_preferred_purchase_brand', 'type': 'string', 'nullable': True}, {'name': 'lifetime_preferred_purchase_channel', 'type': 'string', 'nullable': True}, {'name': 'lifetime_order_revenue', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'lifetime_order_frequency', 'type': 'bigint', 'nullable': True}, {'name': 'lifetime_total_items', 'type': 'bigint', 'nullable': True}, {'name': 'lifetime_largest_order_value', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'lifetime_average_order_value', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'lifetime_average_item_price', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'lifetime_average_num_items', 'type': 'decimal(38,2)', 'nullable': True}]}, {'name': 'transaction_attributes_extended', 'full_name': 'amperity_marketplace.default.transaction_attributes_extended', 'table_type': 'MANAGED', 'data_source_format': 'DELTA', 'comment': '', 'created_at': 1705446651213, 'created_by': 'caleb@amperity.com', 'owner': 'caleb@amperity.com', 'row_count': 'Unknown', 'size_bytes': 'Unknown', 'column_count': 108, 'columns': [{'name': 'amperity_id', 'type': 'string', 'nullable': True}, {'name': 'one_and_done', 'type': 'boolean', 'nullable': True}, {'name': 'multi_purchase_brand', 'type': 'boolean', 'nullable': True}, {'name': 'multi_purchase_channel', 'type': 'boolean', 'nullable': True}, {'name': 'early_repeat_purchaser', 'type': 'boolean', 'nullable': True}, {'name': 'first_order_purchase_brand', 'type': 'string', 'nullable': True}, {'name': 'first_order_purchase_channel', 'type': 'string', 'nullable': True}, {'name': 'first_order_store_id', 'type': 'string', 'nullable': True}, {'name': 'first_order_id', 'type': 'string', 'nullable': True}, {'name': 'first_order_datetime', 'type': 'timestamp', 'nullable': True}, {'name': 'first_order_revenue', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'first_order_total_items', 'type': 'bigint', 'nullable': True}, {'name': 'first_order_is_retained', 'type': 'boolean', 'nullable': True}, {'name': 'second_order_purchase_brand', 'type': 'string', 'nullable': True}, {'name': 'second_order_purchase_channel', 'type': 'string', 'nullable': True}, {'name': 'second_order_store_id', 'type': 'string', 'nullable': True}, {'name': 'second_order_id', 'type': 'string', 'nullable': True}, {'name': 'second_order_datetime', 'type': 'timestamp', 'nullable': True}, {'name': 'second_order_revenue', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'second_order_total_items', 'type': 'bigint', 'nullable': True}, {'name': 'second_order_is_retained', 'type': 'boolean', 'nullable': True}, {'name': 'latest_order_purchase_brand', 'type': 'string', 'nullable': True}, {'name': 'latest_order_purchase_channel', 'type': 'string', 'nullable': True}, {'name': 'latest_order_store_id', 'type': 'string', 'nullable': True}, {'name': 'latest_order_id', 'type': 'string', 'nullable': True}, {'name': 'latest_order_datetime', 'type': 'timestamp', 'nullable': True}, {'name': 'latest_order_revenue', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'latest_order_total_items', 'type': 'bigint', 'nullable': True}, {'name': 'first_to_second_order_days', 'type': 'int', 'nullable': True}, {'name': 'first_to_latest_order_days', 'type': 'int', 'nullable': True}, {'name': 'days_since_latest_order', 'type': 'int', 'nullable': True}, {'name': 'lifetime_purchase_brands', 'type': 'bigint', 'nullable': True}, {'name': 'lifetime_preferred_purchase_brand', 'type': 'string', 'nullable': True}, {'name': 'lifetime_purchase_channels', 'type': 'bigint', 'nullable': True}, {'name': 'lifetime_preferred_purchase_channel', 'type': 'string', 'nullable': True}, {'name': 'lifetime_stores', 'type': 'bigint', 'nullable': True}, {'name': 'lifetime_preferred_store_id', 'type': 'string', 'nullable': True}, {'name': 'lifetime_order_revenue', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'lifetime_order_frequency', 'type': 'bigint', 'nullable': True}, {'name': 'lifetime_total_items', 'type': 'bigint', 'nullable': True}, {'name': 'lifetime_largest_order_value', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'lifetime_average_order_value', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'lifetime_average_item_price', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'lifetime_average_num_items', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'LY12M_purchase_brands', 'type': 'bigint', 'nullable': True}, {'name': 'LY12M_preferred_purchase_brand', 'type': 'string', 'nullable': True}, {'name': 'LY12M_purchase_channels', 'type': 'bigint', 'nullable': True}, {'name': 'LY12M_preferred_purchase_channel', 'type': 'string', 'nullable': True}, {'name': 'LY12M_stores', 'type': 'bigint', 'nullable': True}, {'name': 'LY12M_preferred_store_id', 'type': 'string', 'nullable': True}, {'name': 'LY12M_order_revenue', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'LY12M_order_frequency', 'type': 'bigint', 'nullable': True}, {'name': 'LY12M_total_items', 'type': 'bigint', 'nullable': True}, {'name': 'LY12M_average_order_value', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'LY12M_average_item_price', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'LY12M_average_num_items', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'L12M_purchase_brands', 'type': 'bigint', 'nullable': True}, {'name': 'L12M_preferred_purchase_brand', 'type': 'string', 'nullable': True}, {'name': 'L12M_purchase_channels', 'type': 'bigint', 'nullable': True}, {'name': 'L12M_preferred_purchase_channel', 'type': 'string', 'nullable': True}, {'name': 'L12M_stores', 'type': 'bigint', 'nullable': True}, {'name': 'L12M_preferred_store_id', 'type': 'string', 'nullable': True}, {'name': 'L12M_order_revenue', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'L12M_order_frequency', 'type': 'bigint', 'nullable': True}, {'name': 'L12M_total_items', 'type': 'bigint', 'nullable': True}, {'name': 'L12M_average_order_value', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'L12M_average_item_price', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'L12M_average_num_items', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'L30D_purchase_brands', 'type': 'bigint', 'nullable': True}, {'name': 'L30D_preferred_purchase_brand', 'type': 'string', 'nullable': True}, {'name': 'L30D_purchase_channels', 'type': 'bigint', 'nullable': True}, {'name': 'L30D_preferred_purchase_channel', 'type': 'string', 'nullable': True}, {'name': 'L30D_stores', 'type': 'bigint', 'nullable': True}, {'name': 'L30D_preferred_store_id', 'type': 'string', 'nullable': True}, {'name': 'L30D_order_revenue', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'L30D_order_frequency', 'type': 'bigint', 'nullable': True}, {'name': 'L30D_total_items', 'type': 'bigint', 'nullable': True}, {'name': 'L30D_average_order_value', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'L30D_average_item_price', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'L30D_average_num_items', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'L3M_purchase_brands', 'type': 'bigint', 'nullable': True}, {'name': 'L3M_preferred_purchase_brand', 'type': 'string', 'nullable': True}, {'name': 'L3M_purchase_channels', 'type': 'bigint', 'nullable': True}, {'name': 'L3M_preferred_purchase_channel', 'type': 'string', 'nullable': True}, {'name': 'L3M_stores', 'type': 'bigint', 'nullable': True}, {'name': 'L3M_preferred_store_id', 'type': 'string', 'nullable': True}, {'name': 'L3M_order_revenue', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'L3M_order_frequency', 'type': 'bigint', 'nullable': True}, {'name': 'L3M_total_items', 'type': 'bigint', 'nullable': True}, {'name': 'L3M_average_order_value', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'L3M_average_item_price', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'L3M_average_num_items', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'L6M_purchase_brands', 'type': 'bigint', 'nullable': True}, {'name': 'L6M_preferred_purchase_brand', 'type': 'string', 'nullable': True}, {'name': 'L6M_purchase_channels', 'type': 'bigint', 'nullable': True}, {'name': 'L6M_preferred_purchase_channel', 'type': 'string', 'nullable': True}, {'name': 'L6M_stores', 'type': 'bigint', 'nullable': True}, {'name': 'L6M_preferred_store_id', 'type': 'string', 'nullable': True}, {'name': 'L6M_order_revenue', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'L6M_order_frequency', 'type': 'bigint', 'nullable': True}, {'name': 'L6M_total_items', 'type': 'bigint', 'nullable': True}, {'name': 'L6M_average_order_value', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'L6M_average_item_price', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'L6M_average_num_items', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'L12M_rfm_score', 'type': 'int', 'nullable': True}, {'name': 'L12M_recency', 'type': 'int', 'nullable': True}, {'name': 'L12M_frequency', 'type': 'int', 'nullable': True}, {'name': 'L12M_monetary', 'type': 'int', 'nullable': True}]}, {'name': 'unified_transactions_reporting', 'full_name': 'amperity_marketplace.default.unified_transactions_reporting', 'table_type': 'MANAGED', 'data_source_format': 'DELTA', 'comment': '', 'created_at': 1705530032515, 'created_by': 'caleb@amperity.com', 'owner': 'caleb@amperity.com', 'row_count': 'Unknown', 'size_bytes': 'Unknown', 'column_count': 23, 'columns': [{'name': 'amperity_id', 'type': 'string', 'nullable': True}, {'name': 'order_id', 'type': 'string', 'nullable': True}, {'name': 'order_datetime', 'type': 'timestamp', 'nullable': True}, {'name': 'order_date', 'type': 'date', 'nullable': True}, {'name': 'fiscal_year', 'type': 'bigint', 'nullable': True}, {'name': 'fiscal_quarter', 'type': 'string', 'nullable': True}, {'name': 'fiscal_month', 'type': 'string', 'nullable': True}, {'name': 'fiscal_week_number', 'type': 'bigint', 'nullable': True}, {'name': 'purchase_channel', 'type': 'string', 'nullable': True}, {'name': 'purchase_brand', 'type': 'string', 'nullable': True}, {'name': 'order_quantity', 'type': 'bigint', 'nullable': True}, {'name': 'store_id', 'type': 'string', 'nullable': True}, {'name': 'order_revenue', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'order_discount_amount', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'order_returned_quantity', 'type': 'bigint', 'nullable': True}, {'name': 'order_returned_revenue', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'order_cancelled_quantity', 'type': 'bigint', 'nullable': True}, {'name': 'order_cancelled_revenue', 'type': 'decimal(38,2)', 'nullable': True}, {'name': 'first_overall_order_date', 'type': 'timestamp', 'nullable': True}, {'name': 'Customer_Type_at_Order_Date', 'type': 'string', 'nullable': True}, {'name': 'prev_order_date', 'type': 'timestamp', 'nullable': True}, {'name': 'days_to_next_order', 'type': 'int', 'nullable': True}, {'name': 'order_number_count', 'type': 'int', 'nullable': True}]}], 'total_count': 10, 'catalog_name': 'amperity_marketplace', 'schema_name': 'default'}
2025-06-04 12:43:19,820 - DEBUG - close.started
2025-06-04 12:43:19,821 - DEBUG - close.complete
2025-06-04 12:43:19,835 - DEBUG - close.started
2025-06-04 12:43:19,836 - DEBUG - close.complete
2025-06-04 12:43:19,836 - DEBUG - close.started
2025-06-04 12:43:19,836 - DEBUG - close.complete
2025-06-04 12:43:19,898 - DEBUG - connect_tcp.started host='dbc-df998298-4c7e.cloud.databricks.com' port=443 local_address=None timeout=5.0 socket_options=None
2025-06-04 12:43:19,922 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x104d8bf00>
2025-06-04 12:43:19,922 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x1059e3b60> server_hostname='dbc-df998298-4c7e.cloud.databricks.com' timeout=5.0
2025-06-04 12:43:19,968 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x104d8bdf0>
2025-06-04 12:43:19,968 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2025-06-04 12:43:19,968 - DEBUG - send_request_headers.complete
2025-06-04 12:43:19,968 - DEBUG - send_request_body.started request=<Request [b'POST']>
2025-06-04 12:43:19,968 - DEBUG - send_request_body.complete
2025-06-04 12:43:19,968 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
