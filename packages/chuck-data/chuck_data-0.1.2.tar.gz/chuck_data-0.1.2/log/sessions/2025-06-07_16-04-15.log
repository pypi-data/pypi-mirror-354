2025-06-07 16:04:15,477 - DEBUG - Logging initialized. Writing to /Users/johnrush/repos/chuck-data/log/sessions/2025-06-07_16-04-15.log
2025-06-07 16:04:15,483 - DEBUG - GET request to: https://test-workspace.cloud.databricks.com/test-endpoint
2025-06-07 16:04:15,484 - DEBUG - GET request to: https://test-workspace.cloud.databricks.com/test-endpoint
2025-06-07 16:04:15,484 - DEBUG - HTTP error: HTTP 404, Response: Not Found
2025-06-07 16:04:15,485 - DEBUG - GET request to: https://test-workspace.cloud.databricks.com/test-endpoint
2025-06-07 16:04:15,485 - DEBUG - Connection error: Connection failed
2025-06-07 16:04:15,485 - DEBUG - POST request to: https://test-workspace.cloud.databricks.com/test-endpoint
2025-06-07 16:04:15,487 - DEBUG - POST request to: https://test-workspace.cloud.databricks.com/test-endpoint
2025-06-07 16:04:15,487 - DEBUG - HTTP error: HTTP 400, Response: Bad Request
2025-06-07 16:04:15,487 - DEBUG - POST request to: https://test-workspace.cloud.databricks.com/test-endpoint
2025-06-07 16:04:15,487 - DEBUG - Connection error: Connection failed
2025-06-07 16:04:15,488 - DEBUG - HTTP error: HTTP 401, Response: {"status":401,"message":"Unauthorized"}
2025-06-07 16:04:15,490 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpcbdbtw03/test_config.json
2025-06-07 16:04:15,490 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpcbdbtw03/test_config.json
2025-06-07 16:04:15,491 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpye3_2yf7/test_config.json
2025-06-07 16:04:15,492 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpye3_2yf7/test_config.json
2025-06-07 16:04:15,493 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpce4dv9xd/test_config.json
2025-06-07 16:04:15,493 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpce4dv9xd/test_config.json
2025-06-07 16:04:15,493 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpce4dv9xd/test_config.json
2025-06-07 16:04:15,494 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpce4dv9xd/test_config.json
2025-06-07 16:04:15,494 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpce4dv9xd/test_config.json
2025-06-07 16:04:15,494 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpce4dv9xd/test_config.json
2025-06-07 16:04:15,494 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpce4dv9xd/test_config.json
2025-06-07 16:04:15,494 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpce4dv9xd/test_config.json
2025-06-07 16:04:15,495 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpce4dv9xd/test_config.json
2025-06-07 16:04:15,495 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpce4dv9xd/test_config.json
2025-06-07 16:04:15,495 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpce4dv9xd/test_config.json
2025-06-07 16:04:15,495 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpce4dv9xd/test_config.json
2025-06-07 16:04:15,495 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpce4dv9xd/test_config.json
2025-06-07 16:04:15,495 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpce4dv9xd/test_config.json
2025-06-07 16:04:15,495 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpce4dv9xd/test_config.json
2025-06-07 16:04:15,497 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpysws0e_c/test_config.json
2025-06-07 16:04:15,497 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpysws0e_c/test_config.json
2025-06-07 16:04:15,497 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpysws0e_c/test_config.json
2025-06-07 16:04:15,497 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpysws0e_c/test_config.json
2025-06-07 16:04:15,497 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpysws0e_c/test_config.json
2025-06-07 16:04:15,498 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpysws0e_c/test_config.json
2025-06-07 16:04:15,498 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpysws0e_c/test_config.json
2025-06-07 16:04:15,498 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpysws0e_c/test_config.json
2025-06-07 16:04:15,498 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpysws0e_c/test_config.json
2025-06-07 16:04:15,498 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpysws0e_c/test_config.json
2025-06-07 16:04:15,498 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpysws0e_c/test_config.json
2025-06-07 16:04:15,498 - DEBUG - Using workspace_url from environment variable CHUCK_WORKSPACE_URL
2025-06-07 16:04:15,498 - DEBUG - Using active_model from environment variable CHUCK_ACTIVE_MODEL
2025-06-07 16:04:15,498 - DEBUG - Using warehouse_id from environment variable CHUCK_WAREHOUSE_ID
2025-06-07 16:04:15,498 - DEBUG - Using active_catalog from environment variable CHUCK_ACTIVE_CATALOG
2025-06-07 16:04:15,498 - DEBUG - Using active_schema from environment variable CHUCK_ACTIVE_SCHEMA
2025-06-07 16:04:15,499 - ERROR - Config file is corrupted. Using default config.
2025-06-07 16:04:15,500 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpjo28e7v4/test_config.json
2025-06-07 16:04:15,502 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpdmnnovcl/test_config.json
2025-06-07 16:04:15,502 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpdmnnovcl/test_config.json
2025-06-07 16:04:15,502 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpdmnnovcl/test_config.json
2025-06-07 16:04:15,502 - DEBUG - Using databricks_token from environment variable CHUCK_DATABRICKS_TOKEN
2025-06-07 16:04:15,504 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpf0hxut2x/test_config.json
2025-06-07 16:04:15,504 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpf0hxut2x/test_config.json
2025-06-07 16:04:15,504 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpf0hxut2x/test_config.json
2025-06-07 16:04:15,504 - DEBUG - Using workspace_url from environment variable CHUCK_WORKSPACE_URL
2025-06-07 16:04:15,506 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp733n4y_l/test_config.json
2025-06-07 16:04:15,507 - ERROR - Config file is corrupted. Using default config.
2025-06-07 16:04:15,507 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpi24x1j13
2025-06-07 16:04:15,507 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpi24x1j13
2025-06-07 16:04:15,509 - ERROR - Config file is corrupted. Using default config.
2025-06-07 16:04:15,509 - DEBUG - Using workspace_url from environment variable CHUCK_WORKSPACE_URL
2025-06-07 16:04:15,509 - DEBUG - Using active_model from environment variable CHUCK_ACTIVE_MODEL
2025-06-07 16:04:15,509 - DEBUG - Using warehouse_id from environment variable CHUCK_WAREHOUSE_ID
2025-06-07 16:04:15,509 - DEBUG - Using active_catalog from environment variable CHUCK_ACTIVE_CATALOG
2025-06-07 16:04:15,509 - DEBUG - Using active_schema from environment variable CHUCK_ACTIVE_SCHEMA
2025-06-07 16:04:15,509 - DEBUG - Using amperity_token from environment variable CHUCK_AMPERITY_TOKEN
2025-06-07 16:04:15,509 - DEBUG - Using databricks_token from environment variable CHUCK_DATABRICKS_TOKEN
2025-06-07 16:04:15,509 - DEBUG - Using usage_tracking_consent from environment variable CHUCK_USAGE_TRACKING_CONSENT
2025-06-07 16:04:15,510 - ERROR - Config file is corrupted. Using default config.
2025-06-07 16:04:15,511 - ERROR - Config file is corrupted. Using default config.
2025-06-07 16:04:15,511 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp6ds_sri9
2025-06-07 16:04:15,512 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp6ds_sri9
2025-06-07 16:04:15,513 - ERROR - Config file is corrupted. Using default config.
2025-06-07 16:04:15,513 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp4zpfi263
2025-06-07 16:04:15,513 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp4zpfi263
2025-06-07 16:04:15,514 - ERROR - Config file is corrupted. Using default config.
2025-06-07 16:04:15,515 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmphfjc0o3j
2025-06-07 16:04:15,515 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmphfjc0o3j
2025-06-07 16:04:15,515 - ERROR - Connection error during token validation: Network error
2025-06-07 16:04:15,516 - ERROR - Config file is corrupted. Using default config.
2025-06-07 16:04:15,516 - INFO - Using Databricks token from environment variable. Consider using /set-token to save it to config.
2025-06-07 16:04:15,517 - ERROR - Config file is corrupted. Using default config.
2025-06-07 16:04:15,518 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp9n8isy92
2025-06-07 16:04:15,518 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp9n8isy92
2025-06-07 16:04:15,519 - ERROR - Config file is corrupted. Using default config.
2025-06-07 16:04:15,519 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp9_b9nefx
2025-06-07 16:04:15,519 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp9_b9nefx
2025-06-07 16:04:15,522 - DEBUG - GET request to: https://adb-3856707039489412.12.azuredatabricks.net/test-endpoint
2025-06-07 16:04:15,524 - DEBUG - GET request to: https://test-workspace.cloud.databricks.com/test-endpoint
2025-06-07 16:04:15,525 - DEBUG - GET request to: https://test-workspace.cloud.databricks.com/test-endpoint
2025-06-07 16:04:15,525 - DEBUG - HTTP error: HTTP 404, Response: Not Found
2025-06-07 16:04:15,526 - DEBUG - GET request to: https://test-workspace.cloud.databricks.com/test-endpoint
2025-06-07 16:04:15,526 - DEBUG - Connection error: Connection failed
2025-06-07 16:04:15,526 - DEBUG - POST request to: https://test-workspace.cloud.databricks.com/test-endpoint
2025-06-07 16:04:15,527 - DEBUG - POST request to: https://test-workspace.cloud.databricks.com/test-endpoint
2025-06-07 16:04:15,527 - DEBUG - HTTP error: HTTP 400, Response: Bad Request
2025-06-07 16:04:15,528 - DEBUG - POST request to: https://test-workspace.cloud.databricks.com/test-endpoint
2025-06-07 16:04:15,528 - DEBUG - Connection error: Connection failed
2025-06-07 16:04:15,529 - DEBUG - Token validation failed: Token validation failed
2025-06-07 16:04:15,531 - DEBUG - File upload request to: https://test-workspace.cloud.databricks.com/api/2.0/fs/files/test/path.txt
2025-06-07 16:04:15,532 - DEBUG - File upload request to: https://test-workspace.cloud.databricks.com/api/2.0/fs/files/test/path.txt
2025-06-07 16:04:15,535 - WARNING - Model 'nonexistent-model' not found
2025-06-07 16:04:15,540 - DEBUG - Metrics tracking skipped - user has not provided consent
2025-06-07 16:04:15,541 - DEBUG - Sending metric: {"event": "USAGE", "prompt": "test prompt"}...
2025-06-07 16:04:15,542 - DEBUG - Sending metric: {"event": "USAGE", "prompt": "test prompt"}...
2025-06-07 16:04:15,543 - DEBUG - Sending metric: {"event": "USAGE", "prompt": "test prompt"}...
2025-06-07 16:04:15,543 - DEBUG - Error sending metrics: Test exception
Traceback (most recent call last):
  File "/Users/johnrush/repos/chuck-data/chuck_data/metrics_collector.py", line 123, in send_metric
    return self._client.submit_metrics(payload, token)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "/Users/johnrush/repos/chuck-data/tests/fixtures/amperity.py", line 60, in submit_metrics
    raise Exception("Test exception")
Exception: Test exception
2025-06-07 16:04:15,544 - DEBUG - Cannot send metrics - no authentication token available
2025-06-07 16:04:15,546 - ERROR - Failed to list models: HTTP error occurred: 404 Not Found
2025-06-07 16:04:15,547 - ERROR - Connection error when listing models: Connection failed
2025-06-07 16:04:15,548 - ERROR - Failed to get model: HTTP error occurred: 500 Internal Server Error
2025-06-07 16:04:15,548 - ERROR - Connection error when getting model: Connection failed
2025-06-07 16:04:15,597 - DEBUG - Basic connectivity check failed: 'DatabricksClientStub' object has no attribute 'get'
2025-06-07 16:04:15,597 - DEBUG - Unity Catalog check failed: 'DatabricksClientStub' object has no attribute 'get'
2025-06-07 16:04:15,597 - DEBUG - SQL Warehouse check failed: 'DatabricksClientStub' object has no attribute 'get'
2025-06-07 16:04:15,597 - DEBUG - Jobs check failed: 'DatabricksClientStub' object has no attribute 'get'
2025-06-07 16:04:15,597 - DEBUG - Models check failed: 'DatabricksClientStub' object has no attribute 'get'
2025-06-07 16:04:15,597 - DEBUG - Volumes check failed: 'DatabricksClientStub' object has no attribute 'get'
2025-06-07 16:04:15,606 - DEBUG - Basic connectivity check failed: 'DatabricksClientStub' object has no attribute 'get'
2025-06-07 16:04:15,607 - DEBUG - Unity Catalog check failed: 'DatabricksClientStub' object has no attribute 'get'
2025-06-07 16:04:15,607 - DEBUG - SQL Warehouse check failed: 'DatabricksClientStub' object has no attribute 'get'
2025-06-07 16:04:15,607 - DEBUG - Jobs check failed: 'DatabricksClientStub' object has no attribute 'get'
2025-06-07 16:04:15,607 - DEBUG - Models check failed: 'DatabricksClientStub' object has no attribute 'get'
2025-06-07 16:04:15,607 - DEBUG - Volumes check failed: 'DatabricksClientStub' object has no attribute 'get'
2025-06-07 16:04:15,613 - DEBUG - Executing SQL: SELECT * FROM table
2025-06-07 16:04:15,613 - DEBUG - Executing SQL: SELECT * FROM table
2025-06-07 16:04:15,614 - DEBUG - Executing SQL: SELECT * FROM table
2025-06-07 16:04:15,615 - DEBUG - Executing SQL: SELECT * FROM table
2025-06-07 16:04:15,616 - DEBUG - Executing SQL: SELECT * INVALID SQL
2025-06-07 16:04:15,617 - DEBUG - Executing SQL: SELECT * INVALID SQL
