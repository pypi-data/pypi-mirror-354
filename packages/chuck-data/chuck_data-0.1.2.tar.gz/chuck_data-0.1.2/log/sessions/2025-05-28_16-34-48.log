2025-05-28 16:35:47,401 - ERROR - Connection error: HTTPSConnectionPool(host='adb-3856707039489412.12.azuredatabricks.net.cloud.databricks.com', port=443): Max retries exceeded with url: /api/2.0/preview/scim/v2/Me (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x1040cb770>: Failed to resolve 'adb-3856707039489412.12.azuredatabricks.net.cloud.databricks.com' ([Errno 8] nodename nor servname provided, or not known)"))
2025-05-28 16:35:47,402 - ERROR - Token validation failed: Connection error occurred: HTTPSConnectionPool(host='adb-3856707039489412.12.azuredatabricks.net.cloud.databricks.com', port=443): Max retries exceeded with url: /api/2.0/preview/scim/v2/Me (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x1040cb770>: Failed to resolve 'adb-3856707039489412.12.azuredatabricks.net.cloud.databricks.com' ([Errno 8] nodename nor servname provided, or not known)"))
2025-05-28 16:35:54,515 - ERROR - Connection error: HTTPSConnectionPool(host='adb-3856707039489412.12.azuredatabricks.net.cloud.databricks.com', port=443): Max retries exceeded with url: /api/2.0/preview/scim/v2/Me (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x1040d7b10>: Failed to resolve 'adb-3856707039489412.12.azuredatabricks.net.cloud.databricks.com' ([Errno 8] nodename nor servname provided, or not known)"))
2025-05-28 16:35:54,515 - ERROR - Token validation failed: Connection error occurred: HTTPSConnectionPool(host='adb-3856707039489412.12.azuredatabricks.net.cloud.databricks.com', port=443): Max retries exceeded with url: /api/2.0/preview/scim/v2/Me (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x1040d7b10>: Failed to resolve 'adb-3856707039489412.12.azuredatabricks.net.cloud.databricks.com' ([Errno 8] nodename nor servname provided, or not known)"))
2025-05-28 16:35:55,751 - ERROR - Connection error: HTTPSConnectionPool(host='adb-3856707039489412.12.azuredatabricks.net.cloud.databricks.com', port=443): Max retries exceeded with url: /api/2.0/preview/scim/v2/Me (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x104268910>: Failed to resolve 'adb-3856707039489412.12.azuredatabricks.net.cloud.databricks.com' ([Errno 8] nodename nor servname provided, or not known)"))
2025-05-28 16:35:55,752 - ERROR - Token validation failed: Connection error occurred: HTTPSConnectionPool(host='adb-3856707039489412.12.azuredatabricks.net.cloud.databricks.com', port=443): Max retries exceeded with url: /api/2.0/preview/scim/v2/Me (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x104268910>: Failed to resolve 'adb-3856707039489412.12.azuredatabricks.net.cloud.databricks.com' ([Errno 8] nodename nor servname provided, or not known)"))
2025-05-28 16:36:04,475 - ERROR - Connection error: HTTPSConnectionPool(host='adb-3856707039489412.12.azuredatabricks.net.cloud.databricks.com', port=443): Max retries exceeded with url: /api/2.0/preview/scim/v2/Me (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x104268190>: Failed to resolve 'adb-3856707039489412.12.azuredatabricks.net.cloud.databricks.com' ([Errno 8] nodename nor servname provided, or not known)"))
2025-05-28 16:36:04,475 - ERROR - Token validation failed: Connection error occurred: HTTPSConnectionPool(host='adb-3856707039489412.12.azuredatabricks.net.cloud.databricks.com', port=443): Max retries exceeded with url: /api/2.0/preview/scim/v2/Me (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x104268190>: Failed to resolve 'adb-3856707039489412.12.azuredatabricks.net.cloud.databricks.com' ([Errno 8] nodename nor servname provided, or not known)"))
2025-05-28 16:36:18,184 - ERROR - Connection error: HTTPSConnectionPool(host='adb-3856707039489412.12.azuredatabricks.net.cloud.databricks.com', port=443): Max retries exceeded with url: /api/2.0/preview/scim/v2/Me (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x1040d79d0>: Failed to resolve 'adb-3856707039489412.12.azuredatabricks.net.cloud.databricks.com' ([Errno 8] nodename nor servname provided, or not known)"))
2025-05-28 16:36:18,184 - ERROR - Token validation failed: Connection error occurred: HTTPSConnectionPool(host='adb-3856707039489412.12.azuredatabricks.net.cloud.databricks.com', port=443): Max retries exceeded with url: /api/2.0/preview/scim/v2/Me (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x1040d79d0>: Failed to resolve 'adb-3856707039489412.12.azuredatabricks.net.cloud.databricks.com' ([Errno 8] nodename nor servname provided, or not known)"))
2025-05-28 16:36:28,985 - ERROR - Agent error: Error code: 403 - {'error_code': 403, 'message': 'Invalid access token. [ReqId: dc4d7923-f530-4eb1-a5d5-56e5dd53f08f]'}
Traceback (most recent call last):
  File "/Users/johnrush/repos/clamp-internal/src/commands/agent.py", line 101, in handle_command
    response = agent.process_query(query)
  File "/Users/johnrush/repos/clamp-internal/src/agent/manager.py", line 276, in process_query
    return self.process_with_tools(tools)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "/Users/johnrush/repos/clamp-internal/src/agent/manager.py", line 191, in process_with_tools
    response = self.llm_client.chat(
        messages=current_history,  # Use the modified temporary history for the call
    ...<2 lines>...
        stream=False,  # Important: No streaming within the loop
    )
  File "/Users/johnrush/repos/clamp-internal/src/llm/client.py", line 56, in chat
    response = client.chat.completions.create(
        model=model,
    ...<3 lines>...
        tool_choice=tool_choice,
    )
  File "/Users/johnrush/repos/clamp-internal/.venv/lib/python3.13/site-packages/openai/_utils/_utils.py", line 287, in wrapper
    return func(*args, **kwargs)
  File "/Users/johnrush/repos/clamp-internal/.venv/lib/python3.13/site-packages/openai/resources/chat/completions/completions.py", line 925, in create
    return self._post(
           ~~~~~~~~~~^
        "/chat/completions",
        ^^^^^^^^^^^^^^^^^^^^
    ...<43 lines>...
        stream_cls=Stream[ChatCompletionChunk],
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/johnrush/repos/clamp-internal/.venv/lib/python3.13/site-packages/openai/_base_client.py", line 1239, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
                           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnrush/repos/clamp-internal/.venv/lib/python3.13/site-packages/openai/_base_client.py", line 1034, in request
    raise self._make_status_error_from_response(err.response) from None
openai.PermissionDeniedError: Error code: 403 - {'error_code': 403, 'message': 'Invalid access token. [ReqId: dc4d7923-f530-4eb1-a5d5-56e5dd53f08f]'}
2025-05-28 16:37:17,522 - ERROR - HTTP error: 403 Client Error: Forbidden for url: https://dbc-df998298-4c7e.cloud.databricks.com/api/2.0/preview/scim/v2/Me, Response: {"error_code":403,"message":"Invalid access token. [ReqId: 058bdc60-1c04-426a-8317-f375f1091a59]"}
2025-05-28 16:37:17,523 - ERROR - Token validation failed: HTTP error occurred: 403 Client Error: Forbidden for url: https://dbc-df998298-4c7e.cloud.databricks.com/api/2.0/preview/scim/v2/Me, Response: {"error_code":403,"message":"Invalid access token. [ReqId: 058bdc60-1c04-426a-8317-f375f1091a59]"}
