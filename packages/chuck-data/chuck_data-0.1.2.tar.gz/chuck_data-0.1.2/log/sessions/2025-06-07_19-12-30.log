2025-06-07 19:12:30,567 - DEBUG - Logging initialized. Writing to /Users/johnrush/repos/chuck-data/log/sessions/2025-06-07_19-12-30.log
2025-06-07 19:12:30,568 - DEBUG - Loaded configuration from /Users/johnrush/.chuck_config.json
2025-06-07 19:12:30,585 - DEBUG - Using selector: KqueueSelector
2025-06-07 19:12:36,039 - DEBUG - GET request with params to: https://dbc-df998298-4c7e.cloud.databricks.com/api/2.1/unity-catalog/tables
2025-06-07 19:12:36,050 - DEBUG - Starting new HTTPS connection (1): dbc-df998298-4c7e.cloud.databricks.com:443
2025-06-07 19:12:36,573 - DEBUG - https://dbc-df998298-4c7e.cloud.databricks.com:443 "GET /api/2.1/unity-catalog/tables?catalog_name=john_test&schema_name=bronze&omit_columns=true HTTP/1.1" 200 None
2025-06-07 19:12:36,576 - INFO - Starting PII Scan for 3 tables in john_test.bronze.
2025-06-07 19:12:36,577 - DEBUG - GET request to: https://dbc-df998298-4c7e.cloud.databricks.com/api/2.1/unity-catalog/tables/john_test.bronze.ecommerce_profiles
2025-06-07 19:12:36,578 - DEBUG - GET request to: https://dbc-df998298-4c7e.cloud.databricks.com/api/2.1/unity-catalog/tables/john_test.bronze.loyalty_member
2025-06-07 19:12:36,580 - DEBUG - GET request to: https://dbc-df998298-4c7e.cloud.databricks.com/api/2.1/unity-catalog/tables/john_test.bronze.pos_customer
2025-06-07 19:12:36,580 - DEBUG - Starting new HTTPS connection (1): dbc-df998298-4c7e.cloud.databricks.com:443
2025-06-07 19:12:36,582 - DEBUG - Starting new HTTPS connection (1): dbc-df998298-4c7e.cloud.databricks.com:443
2025-06-07 19:12:36,582 - DEBUG - Starting new HTTPS connection (1): dbc-df998298-4c7e.cloud.databricks.com:443
2025-06-07 19:12:36,793 - DEBUG - https://dbc-df998298-4c7e.cloud.databricks.com:443 "GET /api/2.1/unity-catalog/tables/john_test.bronze.pos_customer HTTP/1.1" 200 None
2025-06-07 19:12:36,794 - DEBUG - https://dbc-df998298-4c7e.cloud.databricks.com:443 "GET /api/2.1/unity-catalog/tables/john_test.bronze.loyalty_member HTTP/1.1" 200 None
2025-06-07 19:12:36,798 - DEBUG - https://dbc-df998298-4c7e.cloud.databricks.com:443 "GET /api/2.1/unity-catalog/tables/john_test.bronze.ecommerce_profiles HTTP/1.1" 200 None
2025-06-07 19:12:36,858 - DEBUG - connect_tcp.started host='dbc-df998298-4c7e.cloud.databricks.com' port=443 local_address=None timeout=5.0 socket_options=None
2025-06-07 19:12:36,858 - DEBUG - connect_tcp.started host='dbc-df998298-4c7e.cloud.databricks.com' port=443 local_address=None timeout=5.0 socket_options=None
2025-06-07 19:12:36,859 - DEBUG - connect_tcp.started host='dbc-df998298-4c7e.cloud.databricks.com' port=443 local_address=None timeout=5.0 socket_options=None
2025-06-07 19:12:36,882 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x1119d38c0>
2025-06-07 19:12:36,882 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x1119b52e0> server_hostname='dbc-df998298-4c7e.cloud.databricks.com' timeout=5.0
2025-06-07 19:12:36,887 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x1119fa850>
2025-06-07 19:12:36,887 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x1119b5520> server_hostname='dbc-df998298-4c7e.cloud.databricks.com' timeout=5.0
2025-06-07 19:12:36,888 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x1119fb610>
2025-06-07 19:12:36,888 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x1119b4ef0> server_hostname='dbc-df998298-4c7e.cloud.databricks.com' timeout=5.0
2025-06-07 19:12:36,931 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x1119b09d0>
2025-06-07 19:12:36,932 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2025-06-07 19:12:36,932 - DEBUG - send_request_headers.complete
2025-06-07 19:12:36,932 - DEBUG - send_request_body.started request=<Request [b'POST']>
2025-06-07 19:12:36,932 - DEBUG - send_request_body.complete
2025-06-07 19:12:36,932 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2025-06-07 19:12:36,936 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x1119b0c30>
2025-06-07 19:12:36,937 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2025-06-07 19:12:36,937 - DEBUG - send_request_headers.complete
2025-06-07 19:12:36,937 - DEBUG - send_request_body.started request=<Request [b'POST']>
2025-06-07 19:12:36,937 - DEBUG - send_request_body.complete
2025-06-07 19:12:36,937 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2025-06-07 19:12:36,937 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x1119c95b0>
2025-06-07 19:12:36,937 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2025-06-07 19:12:36,937 - DEBUG - send_request_headers.complete
2025-06-07 19:12:36,937 - DEBUG - send_request_body.started request=<Request [b'POST']>
2025-06-07 19:12:36,937 - DEBUG - send_request_body.complete
2025-06-07 19:12:36,937 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2025-06-07 19:12:40,862 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'x-amzn-requestid', b'08dbc9ce-8d92-4b68-9adb-b28f7746120a'), (b'x-amzn-bedrock-invocation-latency', b'3666'), (b'x-amzn-bedrock-output-token-count', b'205'), (b'x-amzn-bedrock-input-token-count', b'508'), (b'content-type', b'application/json'), (b'date', b'Sun, 8 Jun 2025 02:12:40 GMT'), (b'x-databricks-org-id', b'3416276235813320'), (b'x-request-id', b'131cb61c-62d6-4e49-be2b-a83caba2c869'), (b'content-encoding', b'gzip'), (b'vary', b'Accept-Encoding'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'x-content-type-options', b'nosniff'), (b'server', b'databricks'), (b'transfer-encoding', b'chunked')])
2025-06-07 19:12:40,865 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2025-06-07 19:12:40,865 - DEBUG - receive_response_body.complete
2025-06-07 19:12:40,865 - DEBUG - response_closed.started
2025-06-07 19:12:40,865 - DEBUG - response_closed.complete
2025-06-07 19:12:41,360 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'x-amzn-requestid', b'02b7fce9-b1e6-49e5-b74f-3f7b60c57499'), (b'x-amzn-bedrock-invocation-latency', b'4250'), (b'x-amzn-bedrock-output-token-count', b'197'), (b'x-amzn-bedrock-input-token-count', b'493'), (b'content-type', b'application/json'), (b'date', b'Sun, 8 Jun 2025 02:12:41 GMT'), (b'x-databricks-org-id', b'3416276235813320'), (b'x-request-id', b'a98d0ba7-2aea-4e60-82b1-b19e12545290'), (b'content-encoding', b'gzip'), (b'vary', b'Accept-Encoding'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'x-content-type-options', b'nosniff'), (b'server', b'databricks'), (b'transfer-encoding', b'chunked')])
2025-06-07 19:12:41,361 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2025-06-07 19:12:41,362 - DEBUG - receive_response_body.complete
2025-06-07 19:12:41,362 - DEBUG - response_closed.started
2025-06-07 19:12:41,362 - DEBUG - response_closed.complete
2025-06-07 19:12:42,719 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'x-amzn-requestid', b'e16e0440-96ba-470c-af66-72fcb82c8788'), (b'x-amzn-bedrock-invocation-latency', b'5541'), (b'x-amzn-bedrock-output-token-count', b'267'), (b'x-amzn-bedrock-input-token-count', b'588'), (b'content-type', b'application/json'), (b'date', b'Sun, 8 Jun 2025 02:12:42 GMT'), (b'x-databricks-org-id', b'3416276235813320'), (b'x-request-id', b'037c7d30-e691-47ac-aed5-69189ecfc278'), (b'content-encoding', b'gzip'), (b'vary', b'Accept-Encoding'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'x-content-type-options', b'nosniff'), (b'server', b'databricks'), (b'transfer-encoding', b'chunked')])
2025-06-07 19:12:42,721 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2025-06-07 19:12:42,721 - DEBUG - receive_response_body.complete
2025-06-07 19:12:42,721 - DEBUG - response_closed.started
2025-06-07 19:12:42,721 - DEBUG - response_closed.complete
2025-06-07 19:12:42,724 - DEBUG - GET request with params to: https://dbc-df998298-4c7e.cloud.databricks.com/api/2.1/unity-catalog/volumes
2025-06-07 19:12:42,727 - DEBUG - Starting new HTTPS connection (1): dbc-df998298-4c7e.cloud.databricks.com:443
2025-06-07 19:12:42,879 - DEBUG - https://dbc-df998298-4c7e.cloud.databricks.com:443 "GET /api/2.1/unity-catalog/volumes?catalog_name=john_test&schema_name=bronze HTTP/1.1" 200 None
2025-06-07 19:12:42,883 - DEBUG - Starting new HTTPS connection (1): chuck.amperity.com:443
2025-06-07 19:12:43,016 - DEBUG - https://chuck.amperity.com:443 "POST /api/job/launch HTTP/1.1" 200 720
2025-06-07 19:12:43,017 - DEBUG - GET request with params to: https://dbc-df998298-4c7e.cloud.databricks.com/api/2.1/unity-catalog/volumes
2025-06-07 19:12:43,019 - DEBUG - Starting new HTTPS connection (1): dbc-df998298-4c7e.cloud.databricks.com:443
2025-06-07 19:12:43,212 - DEBUG - https://dbc-df998298-4c7e.cloud.databricks.com:443 "GET /api/2.1/unity-catalog/volumes?catalog_name=john_test&schema_name=bronze HTTP/1.1" 200 None
2025-06-07 19:12:43,214 - DEBUG - File upload request to: https://dbc-df998298-4c7e.cloud.databricks.com/api/2.0/fs/files/Volumes/john_test/bronze/chuck/cluster_init-2025-06-07_19-12.sh?overwrite=true
2025-06-07 19:12:43,216 - DEBUG - Starting new HTTPS connection (1): dbc-df998298-4c7e.cloud.databricks.com:443
2025-06-07 19:12:43,831 - DEBUG - https://dbc-df998298-4c7e.cloud.databricks.com:443 "PUT /api/2.0/fs/files/Volumes/john_test/bronze/chuck/cluster_init-2025-06-07_19-12.sh?overwrite=true HTTP/1.1" 204 0
2025-06-07 19:12:43,833 - INFO - Cluster init script uploaded successfully to /Volumes/john_test/bronze/chuck/cluster_init-2025-06-07_19-12.sh
2025-06-07 19:12:43,833 - DEBUG - Versioned cluster init script uploaded to /Volumes/john_test/bronze/chuck/cluster_init-2025-06-07_19-12.sh
2025-06-07 19:12:43,850 - DEBUG - Using selector: KqueueSelector
2025-06-07 19:13:01,816 - DEBUG - Using selector: KqueueSelector
2025-06-07 19:13:08,177 - DEBUG - File upload request to: https://dbc-df998298-4c7e.cloud.databricks.com/api/2.0/fs/files/Volumes/john_test/bronze/chuck/stitch-2025-06-07_19-12.json?overwrite=true
2025-06-07 19:13:08,180 - DEBUG - Starting new HTTPS connection (1): dbc-df998298-4c7e.cloud.databricks.com:443
2025-06-07 19:13:08,731 - DEBUG - https://dbc-df998298-4c7e.cloud.databricks.com:443 "PUT /api/2.0/fs/files/Volumes/john_test/bronze/chuck/stitch-2025-06-07_19-12.json?overwrite=true HTTP/1.1" 204 0
2025-06-07 19:13:08,733 - DEBUG - Stitch config written to /Volumes/john_test/bronze/chuck/stitch-2025-06-07_19-12.json
2025-06-07 19:13:08,733 - DEBUG - File upload request to: https://dbc-df998298-4c7e.cloud.databricks.com/api/2.0/fs/files/Volumes/john_test/bronze/chuck/cluster_init-2025-06-07_19-12.sh?overwrite=true
2025-06-07 19:13:08,735 - DEBUG - Starting new HTTPS connection (1): dbc-df998298-4c7e.cloud.databricks.com:443
2025-06-07 19:13:09,136 - DEBUG - https://dbc-df998298-4c7e.cloud.databricks.com:443 "PUT /api/2.0/fs/files/Volumes/john_test/bronze/chuck/cluster_init-2025-06-07_19-12.sh?overwrite=true HTTP/1.1" 204 0
2025-06-07 19:13:09,137 - DEBUG - Cluster init script written to /Volumes/john_test/bronze/chuck/cluster_init-2025-06-07_19-12.sh
2025-06-07 19:13:09,138 - DEBUG - POST request to: https://dbc-df998298-4c7e.cloud.databricks.com/api/2.2/jobs/runs/submit
2025-06-07 19:13:09,140 - DEBUG - Starting new HTTPS connection (1): dbc-df998298-4c7e.cloud.databricks.com:443
2025-06-07 19:13:09,745 - DEBUG - https://dbc-df998298-4c7e.cloud.databricks.com:443 "POST /api/2.2/jobs/runs/submit HTTP/1.1" 200 26
2025-06-07 19:13:09,751 - DEBUG - GET request to: https://dbc-df998298-4c7e.cloud.databricks.com/api/2.0/preview/scim/v2/Me
2025-06-07 19:13:09,754 - DEBUG - Starting new HTTPS connection (1): dbc-df998298-4c7e.cloud.databricks.com:443
2025-06-07 19:13:10,023 - DEBUG - https://dbc-df998298-4c7e.cloud.databricks.com:443 "GET /api/2.0/preview/scim/v2/Me HTTP/1.1" 200 None
2025-06-07 19:13:10,027 - DEBUG - POST request to: https://dbc-df998298-4c7e.cloud.databricks.com/api/2.0/workspace/import
2025-06-07 19:13:10,030 - DEBUG - Starting new HTTPS connection (1): dbc-df998298-4c7e.cloud.databricks.com:443
2025-06-07 19:13:12,723 - DEBUG - https://dbc-df998298-4c7e.cloud.databricks.com:443 "POST /api/2.0/workspace/import HTTP/1.1" 200 None
2025-06-07 19:13:12,725 - DEBUG - Sending metric: {"event": "USAGE", "configuration": {"workspace_url": "https://dbc-df998298-4c7e.cloud.databricks.co...
2025-06-07 19:13:12,727 - DEBUG - Starting new HTTPS connection (1): chuck.amperity.com:443
2025-06-07 19:13:12,863 - DEBUG - https://chuck.amperity.com:443 "POST /api/usage HTTP/1.1" 204 0
2025-06-07 19:13:12,864 - DEBUG - Failed to send metrics: 204 - 
2025-06-07 19:13:12,869 - DEBUG - Using selector: KqueueSelector
2025-06-07 19:13:20,745 - DEBUG - connect_tcp.started host='dbc-df998298-4c7e.cloud.databricks.com' port=443 local_address=None timeout=5.0 socket_options=None
2025-06-07 19:13:20,767 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x111a08380>
2025-06-07 19:13:20,767 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x1119b5910> server_hostname='dbc-df998298-4c7e.cloud.databricks.com' timeout=5.0
2025-06-07 19:13:20,819 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x111a08160>
2025-06-07 19:13:20,819 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2025-06-07 19:13:20,819 - DEBUG - send_request_headers.complete
2025-06-07 19:13:20,819 - DEBUG - send_request_body.started request=<Request [b'POST']>
2025-06-07 19:13:20,819 - DEBUG - send_request_body.complete
2025-06-07 19:13:20,819 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2025-06-07 19:13:25,833 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'x-amzn-requestid', b'c05c9d9b-5fba-462d-b886-32498ffecea2'), (b'x-amzn-bedrock-invocation-latency', b'4815'), (b'x-amzn-bedrock-output-token-count', b'163'), (b'x-amzn-bedrock-input-token-count', b'5088'), (b'content-type', b'application/json'), (b'date', b'Sun, 8 Jun 2025 02:13:25 GMT'), (b'x-databricks-org-id', b'3416276235813320'), (b'x-request-id', b'36032e1a-67b8-4c87-8ef6-5636d3db24ae'), (b'content-encoding', b'gzip'), (b'vary', b'Accept-Encoding'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'x-content-type-options', b'nosniff'), (b'server', b'databricks'), (b'transfer-encoding', b'chunked')])
2025-06-07 19:13:25,834 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2025-06-07 19:13:25,834 - DEBUG - receive_response_body.complete
2025-06-07 19:13:25,834 - DEBUG - response_closed.started
2025-06-07 19:13:25,834 - DEBUG - response_closed.complete
2025-06-07 19:13:25,837 - DEBUG - Agent attempting to execute tool: setup-stitch with args: {'catalog_name': 'john_test', 'schema_name': 'bronze'}
2025-06-07 19:13:25,839 - DEBUG - Tool arguments for 'setup-stitch' validated successfully.
2025-06-07 19:13:25,839 - DEBUG - Executing agent tool 'setup-stitch' with handler: handle_command
2025-06-07 19:13:25,840 - DEBUG - GET request with params to: https://dbc-df998298-4c7e.cloud.databricks.com/api/2.1/unity-catalog/tables
2025-06-07 19:13:25,842 - DEBUG - Starting new HTTPS connection (1): dbc-df998298-4c7e.cloud.databricks.com:443
2025-06-07 19:13:26,018 - DEBUG - https://dbc-df998298-4c7e.cloud.databricks.com:443 "GET /api/2.1/unity-catalog/tables?catalog_name=john_test&schema_name=bronze&omit_columns=true HTTP/1.1" 200 None
2025-06-07 19:13:26,020 - INFO - Starting PII Scan for 3 tables in john_test.bronze.
2025-06-07 19:13:26,021 - DEBUG - GET request to: https://dbc-df998298-4c7e.cloud.databricks.com/api/2.1/unity-catalog/tables/john_test.bronze.ecommerce_profiles
2025-06-07 19:13:26,022 - DEBUG - GET request to: https://dbc-df998298-4c7e.cloud.databricks.com/api/2.1/unity-catalog/tables/john_test.bronze.loyalty_member
2025-06-07 19:13:26,023 - DEBUG - close.started
2025-06-07 19:13:26,023 - DEBUG - GET request to: https://dbc-df998298-4c7e.cloud.databricks.com/api/2.1/unity-catalog/tables/john_test.bronze.pos_customer
2025-06-07 19:13:26,024 - DEBUG - close.complete
2025-06-07 19:13:26,027 - DEBUG - Starting new HTTPS connection (1): dbc-df998298-4c7e.cloud.databricks.com:443
2025-06-07 19:13:26,027 - DEBUG - Starting new HTTPS connection (1): dbc-df998298-4c7e.cloud.databricks.com:443
2025-06-07 19:13:26,028 - DEBUG - Starting new HTTPS connection (1): dbc-df998298-4c7e.cloud.databricks.com:443
2025-06-07 19:13:26,162 - DEBUG - https://dbc-df998298-4c7e.cloud.databricks.com:443 "GET /api/2.1/unity-catalog/tables/john_test.bronze.pos_customer HTTP/1.1" 200 None
2025-06-07 19:13:26,163 - DEBUG - https://dbc-df998298-4c7e.cloud.databricks.com:443 "GET /api/2.1/unity-catalog/tables/john_test.bronze.loyalty_member HTTP/1.1" 200 None
2025-06-07 19:13:26,166 - DEBUG - https://dbc-df998298-4c7e.cloud.databricks.com:443 "GET /api/2.1/unity-catalog/tables/john_test.bronze.ecommerce_profiles HTTP/1.1" 200 None
2025-06-07 19:13:26,178 - DEBUG - connect_tcp.started host='dbc-df998298-4c7e.cloud.databricks.com' port=443 local_address=None timeout=5.0 socket_options=None
2025-06-07 19:13:26,179 - DEBUG - connect_tcp.started host='dbc-df998298-4c7e.cloud.databricks.com' port=443 local_address=None timeout=5.0 socket_options=None
2025-06-07 19:13:26,180 - DEBUG - connect_tcp.started host='dbc-df998298-4c7e.cloud.databricks.com' port=443 local_address=None timeout=5.0 socket_options=None
2025-06-07 19:13:26,212 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x1119a7950>
2025-06-07 19:13:26,212 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x1119b5910> server_hostname='dbc-df998298-4c7e.cloud.databricks.com' timeout=5.0
2025-06-07 19:13:26,213 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x1119a7a50>
2025-06-07 19:13:26,213 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x1119b6ba0> server_hostname='dbc-df998298-4c7e.cloud.databricks.com' timeout=5.0
2025-06-07 19:13:26,214 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x111a10230>
2025-06-07 19:13:26,214 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x1119b62a0> server_hostname='dbc-df998298-4c7e.cloud.databricks.com' timeout=5.0
2025-06-07 19:13:26,264 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x111a109b0>
2025-06-07 19:13:26,264 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2025-06-07 19:13:26,264 - DEBUG - send_request_headers.complete
2025-06-07 19:13:26,265 - DEBUG - send_request_body.started request=<Request [b'POST']>
2025-06-07 19:13:26,265 - DEBUG - send_request_body.complete
2025-06-07 19:13:26,265 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2025-06-07 19:13:26,268 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x111a44d70>
2025-06-07 19:13:26,268 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2025-06-07 19:13:26,269 - DEBUG - send_request_headers.complete
2025-06-07 19:13:26,269 - DEBUG - send_request_body.started request=<Request [b'POST']>
2025-06-07 19:13:26,269 - DEBUG - send_request_body.complete
2025-06-07 19:13:26,269 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2025-06-07 19:13:26,269 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x111a45470>
2025-06-07 19:13:26,270 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2025-06-07 19:13:26,270 - DEBUG - send_request_headers.complete
2025-06-07 19:13:26,270 - DEBUG - send_request_body.started request=<Request [b'POST']>
2025-06-07 19:13:26,270 - DEBUG - send_request_body.complete
2025-06-07 19:13:26,270 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2025-06-07 19:13:30,168 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'x-amzn-requestid', b'856a97c8-9a41-4665-a93c-0cf9d01b7c84'), (b'x-amzn-bedrock-invocation-latency', b'3742'), (b'x-amzn-bedrock-output-token-count', b'205'), (b'x-amzn-bedrock-input-token-count', b'508'), (b'content-type', b'application/json'), (b'date', b'Sun, 8 Jun 2025 02:13:30 GMT'), (b'x-databricks-org-id', b'3416276235813320'), (b'x-request-id', b'7a1e4b71-7c11-46e9-bf05-8dd39a5d8a9c'), (b'content-encoding', b'gzip'), (b'vary', b'Accept-Encoding'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'x-content-type-options', b'nosniff'), (b'server', b'databricks'), (b'transfer-encoding', b'chunked')])
2025-06-07 19:13:30,168 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2025-06-07 19:13:30,168 - DEBUG - receive_response_body.complete
2025-06-07 19:13:30,168 - DEBUG - response_closed.started
2025-06-07 19:13:30,168 - DEBUG - response_closed.complete
2025-06-07 19:13:30,344 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'x-amzn-requestid', b'9d79cd98-ed6b-4670-81b2-2a7cb21075b3'), (b'x-amzn-bedrock-invocation-latency', b'3975'), (b'x-amzn-bedrock-output-token-count', b'197'), (b'x-amzn-bedrock-input-token-count', b'493'), (b'content-type', b'application/json'), (b'date', b'Sun, 8 Jun 2025 02:13:30 GMT'), (b'x-databricks-org-id', b'3416276235813320'), (b'x-request-id', b'f23c2c7b-2133-4bc3-b029-9d6bbe5364b6'), (b'content-encoding', b'gzip'), (b'vary', b'Accept-Encoding'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'x-content-type-options', b'nosniff'), (b'server', b'databricks'), (b'transfer-encoding', b'chunked')])
2025-06-07 19:13:30,345 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2025-06-07 19:13:30,345 - DEBUG - receive_response_body.complete
2025-06-07 19:13:30,345 - DEBUG - response_closed.started
2025-06-07 19:13:30,345 - DEBUG - response_closed.complete
2025-06-07 19:13:32,499 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'x-amzn-requestid', b'65ff49d2-ebf3-421c-b758-e5587398c81d'), (b'x-amzn-bedrock-invocation-latency', b'6038'), (b'x-amzn-bedrock-output-token-count', b'267'), (b'x-amzn-bedrock-input-token-count', b'588'), (b'content-type', b'application/json'), (b'date', b'Sun, 8 Jun 2025 02:13:32 GMT'), (b'x-databricks-org-id', b'3416276235813320'), (b'x-request-id', b'2daf926a-51f9-444a-b165-359a60fa6087'), (b'content-encoding', b'gzip'), (b'vary', b'Accept-Encoding'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'x-content-type-options', b'nosniff'), (b'server', b'databricks'), (b'transfer-encoding', b'chunked')])
2025-06-07 19:13:32,500 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2025-06-07 19:13:32,500 - DEBUG - receive_response_body.complete
2025-06-07 19:13:32,500 - DEBUG - response_closed.started
2025-06-07 19:13:32,500 - DEBUG - response_closed.complete
2025-06-07 19:13:32,502 - DEBUG - GET request with params to: https://dbc-df998298-4c7e.cloud.databricks.com/api/2.1/unity-catalog/volumes
2025-06-07 19:13:32,503 - DEBUG - Starting new HTTPS connection (1): dbc-df998298-4c7e.cloud.databricks.com:443
2025-06-07 19:13:32,645 - DEBUG - https://dbc-df998298-4c7e.cloud.databricks.com:443 "GET /api/2.1/unity-catalog/volumes?catalog_name=john_test&schema_name=bronze HTTP/1.1" 200 None
2025-06-07 19:13:32,647 - DEBUG - Starting new HTTPS connection (1): chuck.amperity.com:443
2025-06-07 19:13:32,803 - DEBUG - https://chuck.amperity.com:443 "POST /api/job/launch HTTP/1.1" 200 720
2025-06-07 19:13:32,804 - DEBUG - GET request with params to: https://dbc-df998298-4c7e.cloud.databricks.com/api/2.1/unity-catalog/volumes
2025-06-07 19:13:32,806 - DEBUG - Starting new HTTPS connection (1): dbc-df998298-4c7e.cloud.databricks.com:443
2025-06-07 19:13:32,947 - DEBUG - https://dbc-df998298-4c7e.cloud.databricks.com:443 "GET /api/2.1/unity-catalog/volumes?catalog_name=john_test&schema_name=bronze HTTP/1.1" 200 None
2025-06-07 19:13:32,948 - DEBUG - File upload request to: https://dbc-df998298-4c7e.cloud.databricks.com/api/2.0/fs/files/Volumes/john_test/bronze/chuck/cluster_init-2025-06-07_19-13.sh?overwrite=true
2025-06-07 19:13:32,950 - DEBUG - Starting new HTTPS connection (1): dbc-df998298-4c7e.cloud.databricks.com:443
2025-06-07 19:13:33,350 - DEBUG - https://dbc-df998298-4c7e.cloud.databricks.com:443 "PUT /api/2.0/fs/files/Volumes/john_test/bronze/chuck/cluster_init-2025-06-07_19-13.sh?overwrite=true HTTP/1.1" 204 0
2025-06-07 19:13:33,351 - INFO - Cluster init script uploaded successfully to /Volumes/john_test/bronze/chuck/cluster_init-2025-06-07_19-13.sh
2025-06-07 19:13:33,351 - DEBUG - Versioned cluster init script uploaded to /Volumes/john_test/bronze/chuck/cluster_init-2025-06-07_19-13.sh
2025-06-07 19:13:33,363 - DEBUG - Tool 'setup-stitch' executed successfully. Data: None
2025-06-07 19:13:33,364 - DEBUG - Tool initiated interactive mode, stopping agent processing
2025-06-07 19:13:33,364 - DEBUG - Error sending metrics: Object of type ChatCompletionMessage is not JSON serializable
Traceback (most recent call last):
  File "/Users/johnrush/repos/chuck-data/chuck_data/metrics_collector.py", line 120, in send_metric
    payload_str = json.dumps(payload)
  File "/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type ChatCompletionMessage is not JSON serializable
2025-06-07 19:13:33,367 - DEBUG - Using selector: KqueueSelector
2025-06-07 19:13:36,914 - DEBUG - close.started
2025-06-07 19:13:36,915 - DEBUG - close.complete
2025-06-07 19:13:36,915 - DEBUG - close.started
2025-06-07 19:13:36,915 - DEBUG - close.complete
2025-06-07 19:13:36,915 - DEBUG - close.started
2025-06-07 19:13:36,915 - DEBUG - close.complete
2025-06-07 19:13:37,114 - DEBUG - Using selector: KqueueSelector
2025-06-07 19:13:41,393 - DEBUG - File upload request to: https://dbc-df998298-4c7e.cloud.databricks.com/api/2.0/fs/files/Volumes/john_test/bronze/chuck/stitch-2025-06-07_19-13.json?overwrite=true
2025-06-07 19:13:41,393 - DEBUG - Starting new HTTPS connection (1): dbc-df998298-4c7e.cloud.databricks.com:443
2025-06-07 19:13:42,010 - DEBUG - https://dbc-df998298-4c7e.cloud.databricks.com:443 "PUT /api/2.0/fs/files/Volumes/john_test/bronze/chuck/stitch-2025-06-07_19-13.json?overwrite=true HTTP/1.1" 204 0
2025-06-07 19:13:42,012 - DEBUG - Stitch config written to /Volumes/john_test/bronze/chuck/stitch-2025-06-07_19-13.json
2025-06-07 19:13:42,012 - DEBUG - File upload request to: https://dbc-df998298-4c7e.cloud.databricks.com/api/2.0/fs/files/Volumes/john_test/bronze/chuck/cluster_init-2025-06-07_19-13.sh?overwrite=true
2025-06-07 19:13:42,014 - DEBUG - Starting new HTTPS connection (1): dbc-df998298-4c7e.cloud.databricks.com:443
2025-06-07 19:13:42,442 - DEBUG - https://dbc-df998298-4c7e.cloud.databricks.com:443 "PUT /api/2.0/fs/files/Volumes/john_test/bronze/chuck/cluster_init-2025-06-07_19-13.sh?overwrite=true HTTP/1.1" 204 0
2025-06-07 19:13:42,444 - DEBUG - Cluster init script written to /Volumes/john_test/bronze/chuck/cluster_init-2025-06-07_19-13.sh
2025-06-07 19:13:42,445 - DEBUG - POST request to: https://dbc-df998298-4c7e.cloud.databricks.com/api/2.2/jobs/runs/submit
2025-06-07 19:13:42,447 - DEBUG - Starting new HTTPS connection (1): dbc-df998298-4c7e.cloud.databricks.com:443
2025-06-07 19:13:43,030 - DEBUG - https://dbc-df998298-4c7e.cloud.databricks.com:443 "POST /api/2.2/jobs/runs/submit HTTP/1.1" 200 26
2025-06-07 19:13:43,037 - DEBUG - GET request to: https://dbc-df998298-4c7e.cloud.databricks.com/api/2.0/preview/scim/v2/Me
2025-06-07 19:13:43,039 - DEBUG - Starting new HTTPS connection (1): dbc-df998298-4c7e.cloud.databricks.com:443
2025-06-07 19:13:43,317 - DEBUG - https://dbc-df998298-4c7e.cloud.databricks.com:443 "GET /api/2.0/preview/scim/v2/Me HTTP/1.1" 200 None
2025-06-07 19:13:43,322 - DEBUG - POST request to: https://dbc-df998298-4c7e.cloud.databricks.com/api/2.0/workspace/import
2025-06-07 19:13:43,325 - DEBUG - Starting new HTTPS connection (1): dbc-df998298-4c7e.cloud.databricks.com:443
2025-06-07 19:13:43,957 - DEBUG - https://dbc-df998298-4c7e.cloud.databricks.com:443 "POST /api/2.0/workspace/import HTTP/1.1" 200 None
2025-06-07 19:13:43,959 - DEBUG - Sending metric: {"event": "USAGE", "configuration": {"workspace_url": "https://dbc-df998298-4c7e.cloud.databricks.co...
2025-06-07 19:13:43,961 - DEBUG - Starting new HTTPS connection (1): chuck.amperity.com:443
2025-06-07 19:13:44,109 - DEBUG - https://chuck.amperity.com:443 "POST /api/usage HTTP/1.1" 204 0
2025-06-07 19:13:44,109 - DEBUG - Failed to send metrics: 204 - 
2025-06-07 19:13:44,113 - DEBUG - Using selector: KqueueSelector
