2025-06-08 13:34:23,032 - DEBUG - Logging initialized. Writing to /Users/johnrush/repos/chuck-data/log/sessions/2025-06-08_13-34-23.log
2025-06-08 13:34:23,036 - DEBUG - GET request to: https://test-workspace.cloud.databricks.com/test-endpoint
2025-06-08 13:34:23,037 - DEBUG - GET request to: https://test-workspace.cloud.databricks.com/test-endpoint
2025-06-08 13:34:23,037 - DEBUG - HTTP error: HTTP 404, Response: Not Found
2025-06-08 13:34:23,038 - DEBUG - GET request to: https://test-workspace.cloud.databricks.com/test-endpoint
2025-06-08 13:34:23,038 - DEBUG - Connection error: Connection failed
2025-06-08 13:34:23,039 - DEBUG - POST request to: https://test-workspace.cloud.databricks.com/test-endpoint
2025-06-08 13:34:23,041 - DEBUG - POST request to: https://test-workspace.cloud.databricks.com/test-endpoint
2025-06-08 13:34:23,041 - DEBUG - HTTP error: HTTP 400, Response: Bad Request
2025-06-08 13:34:23,042 - DEBUG - POST request to: https://test-workspace.cloud.databricks.com/test-endpoint
2025-06-08 13:34:23,042 - DEBUG - Connection error: Connection failed
2025-06-08 13:34:23,043 - DEBUG - HTTP error: HTTP 401, Response: {"status":401,"message":"Unauthorized"}
2025-06-08 13:34:23,046 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp0rvo1e4l/test_config.json
2025-06-08 13:34:23,046 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp0rvo1e4l/test_config.json
2025-06-08 13:34:23,048 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpxf9nyqab/test_config.json
2025-06-08 13:34:23,048 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpxf9nyqab/test_config.json
2025-06-08 13:34:23,050 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpbc0wdqu7/test_config.json
2025-06-08 13:34:23,050 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpbc0wdqu7/test_config.json
2025-06-08 13:34:23,050 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpbc0wdqu7/test_config.json
2025-06-08 13:34:23,050 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpbc0wdqu7/test_config.json
2025-06-08 13:34:23,050 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpbc0wdqu7/test_config.json
2025-06-08 13:34:23,051 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpbc0wdqu7/test_config.json
2025-06-08 13:34:23,051 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpbc0wdqu7/test_config.json
2025-06-08 13:34:23,051 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpbc0wdqu7/test_config.json
2025-06-08 13:34:23,051 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpbc0wdqu7/test_config.json
2025-06-08 13:34:23,052 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpbc0wdqu7/test_config.json
2025-06-08 13:34:23,052 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpbc0wdqu7/test_config.json
2025-06-08 13:34:23,052 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpbc0wdqu7/test_config.json
2025-06-08 13:34:23,052 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpbc0wdqu7/test_config.json
2025-06-08 13:34:23,052 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpbc0wdqu7/test_config.json
2025-06-08 13:34:23,052 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpbc0wdqu7/test_config.json
2025-06-08 13:34:23,054 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpu0et2d79/test_config.json
2025-06-08 13:34:23,054 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpu0et2d79/test_config.json
2025-06-08 13:34:23,054 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpu0et2d79/test_config.json
2025-06-08 13:34:23,055 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpu0et2d79/test_config.json
2025-06-08 13:34:23,055 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpu0et2d79/test_config.json
2025-06-08 13:34:23,055 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpu0et2d79/test_config.json
2025-06-08 13:34:23,055 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpu0et2d79/test_config.json
2025-06-08 13:34:23,056 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpu0et2d79/test_config.json
2025-06-08 13:34:23,056 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpu0et2d79/test_config.json
2025-06-08 13:34:23,056 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpu0et2d79/test_config.json
2025-06-08 13:34:23,057 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpu0et2d79/test_config.json
2025-06-08 13:34:23,057 - DEBUG - Using workspace_url from environment variable CHUCK_WORKSPACE_URL
2025-06-08 13:34:23,057 - DEBUG - Using active_model from environment variable CHUCK_ACTIVE_MODEL
2025-06-08 13:34:23,057 - DEBUG - Using warehouse_id from environment variable CHUCK_WAREHOUSE_ID
2025-06-08 13:34:23,057 - DEBUG - Using active_catalog from environment variable CHUCK_ACTIVE_CATALOG
2025-06-08 13:34:23,057 - DEBUG - Using active_schema from environment variable CHUCK_ACTIVE_SCHEMA
2025-06-08 13:34:23,058 - ERROR - Config file is corrupted. Using default config.
2025-06-08 13:34:23,060 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpvayiapmf/test_config.json
2025-06-08 13:34:23,061 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpk39sqq4c/test_config.json
2025-06-08 13:34:23,061 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpk39sqq4c/test_config.json
2025-06-08 13:34:23,061 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpk39sqq4c/test_config.json
2025-06-08 13:34:23,061 - DEBUG - Using databricks_token from environment variable CHUCK_DATABRICKS_TOKEN
2025-06-08 13:34:23,063 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmplh2lum0b/test_config.json
2025-06-08 13:34:23,063 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmplh2lum0b/test_config.json
2025-06-08 13:34:23,063 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmplh2lum0b/test_config.json
2025-06-08 13:34:23,063 - DEBUG - Using workspace_url from environment variable CHUCK_WORKSPACE_URL
2025-06-08 13:34:23,065 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp9voxpf4_/test_config.json
2025-06-08 13:34:23,066 - ERROR - Config file is corrupted. Using default config.
2025-06-08 13:34:23,067 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpqqzoqyhn
2025-06-08 13:34:23,067 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpqqzoqyhn
2025-06-08 13:34:23,068 - ERROR - Config file is corrupted. Using default config.
2025-06-08 13:34:23,068 - DEBUG - Using workspace_url from environment variable CHUCK_WORKSPACE_URL
2025-06-08 13:34:23,068 - DEBUG - Using active_model from environment variable CHUCK_ACTIVE_MODEL
2025-06-08 13:34:23,068 - DEBUG - Using warehouse_id from environment variable CHUCK_WAREHOUSE_ID
2025-06-08 13:34:23,068 - DEBUG - Using active_catalog from environment variable CHUCK_ACTIVE_CATALOG
2025-06-08 13:34:23,068 - DEBUG - Using active_schema from environment variable CHUCK_ACTIVE_SCHEMA
2025-06-08 13:34:23,068 - DEBUG - Using amperity_token from environment variable CHUCK_AMPERITY_TOKEN
2025-06-08 13:34:23,068 - DEBUG - Using databricks_token from environment variable CHUCK_DATABRICKS_TOKEN
2025-06-08 13:34:23,068 - DEBUG - Using usage_tracking_consent from environment variable CHUCK_USAGE_TRACKING_CONSENT
2025-06-08 13:34:23,070 - ERROR - Config file is corrupted. Using default config.
2025-06-08 13:34:23,071 - ERROR - Config file is corrupted. Using default config.
2025-06-08 13:34:23,071 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp8sagcqhn
2025-06-08 13:34:23,072 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp8sagcqhn
2025-06-08 13:34:23,073 - ERROR - Config file is corrupted. Using default config.
2025-06-08 13:34:23,073 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpzx5438x4
2025-06-08 13:34:23,074 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpzx5438x4
2025-06-08 13:34:23,075 - ERROR - Config file is corrupted. Using default config.
2025-06-08 13:34:23,075 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmptvd4s4ij
2025-06-08 13:34:23,075 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmptvd4s4ij
2025-06-08 13:34:23,075 - ERROR - Connection error during token validation: Network error
2025-06-08 13:34:23,077 - ERROR - Config file is corrupted. Using default config.
2025-06-08 13:34:23,077 - INFO - Using Databricks token from environment variable. Consider using /set-token to save it to config.
2025-06-08 13:34:23,078 - ERROR - Config file is corrupted. Using default config.
2025-06-08 13:34:23,078 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpbwy3gzpn
2025-06-08 13:34:23,078 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpbwy3gzpn
2025-06-08 13:34:23,079 - ERROR - Config file is corrupted. Using default config.
2025-06-08 13:34:23,080 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpztkp3bl9
2025-06-08 13:34:23,080 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpztkp3bl9
2025-06-08 13:34:23,083 - DEBUG - GET request to: https://adb-3856707039489412.12.azuredatabricks.net/test-endpoint
2025-06-08 13:34:23,087 - DEBUG - GET request to: https://test-workspace.cloud.databricks.com/test-endpoint
2025-06-08 13:34:23,088 - DEBUG - GET request to: https://test-workspace.cloud.databricks.com/test-endpoint
2025-06-08 13:34:23,088 - DEBUG - HTTP error: HTTP 404, Response: Not Found
2025-06-08 13:34:23,089 - DEBUG - GET request to: https://test-workspace.cloud.databricks.com/test-endpoint
2025-06-08 13:34:23,089 - DEBUG - Connection error: Connection failed
2025-06-08 13:34:23,090 - DEBUG - POST request to: https://test-workspace.cloud.databricks.com/test-endpoint
2025-06-08 13:34:23,091 - DEBUG - POST request to: https://test-workspace.cloud.databricks.com/test-endpoint
2025-06-08 13:34:23,091 - DEBUG - HTTP error: HTTP 400, Response: Bad Request
2025-06-08 13:34:23,092 - DEBUG - POST request to: https://test-workspace.cloud.databricks.com/test-endpoint
2025-06-08 13:34:23,092 - DEBUG - Connection error: Connection failed
2025-06-08 13:34:23,094 - DEBUG - Token validation failed: Token validation failed
2025-06-08 13:34:23,096 - DEBUG - File upload request to: https://test-workspace.cloud.databricks.com/api/2.0/fs/files/test/path.txt
2025-06-08 13:34:23,099 - DEBUG - File upload request to: https://test-workspace.cloud.databricks.com/api/2.0/fs/files/test/path.txt
2025-06-08 13:34:23,102 - WARNING - Model 'nonexistent-model' not found
2025-06-08 13:34:23,110 - ERROR - Config file is corrupted. Using default config.
2025-06-08 13:34:23,110 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmprrbaz8xu
2025-06-08 13:34:23,110 - DEBUG - Metrics tracking skipped - user has not provided consent
2025-06-08 13:34:23,112 - ERROR - Config file is corrupted. Using default config.
2025-06-08 13:34:23,112 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp_ownha4f
2025-06-08 13:34:23,113 - ERROR - Config file is corrupted. Using default config.
2025-06-08 13:34:23,114 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpnk9viutu
2025-06-08 13:34:23,114 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpnk9viutu
2025-06-08 13:34:23,114 - DEBUG - Sending metric: {"event": "USAGE", "prompt": "test prompt"}...
2025-06-08 13:34:23,115 - ERROR - Config file is corrupted. Using default config.
2025-06-08 13:34:23,116 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpa15o04dw
2025-06-08 13:34:23,116 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpa15o04dw
2025-06-08 13:34:23,116 - DEBUG - Sending metric: {"event": "USAGE", "prompt": "test prompt"}...
2025-06-08 13:34:23,117 - ERROR - Config file is corrupted. Using default config.
2025-06-08 13:34:23,117 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpq6b_3raq
2025-06-08 13:34:23,118 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpq6b_3raq
2025-06-08 13:34:23,118 - DEBUG - Sending metric: {"event": "USAGE", "prompt": "test prompt"}...
2025-06-08 13:34:23,118 - DEBUG - Error sending metrics: Test exception
Traceback (most recent call last):
  File "/Users/johnrush/repos/chuck-data/chuck_data/metrics_collector.py", line 123, in send_metric
    return self._client.submit_metrics(payload, token)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnrush/repos/chuck-data/tests/fixtures/amperity.py", line 60, in submit_metrics
    raise Exception("Test exception")
Exception: Test exception
2025-06-08 13:34:23,120 - ERROR - Config file is corrupted. Using default config.
2025-06-08 13:34:23,120 - DEBUG - Cannot send metrics - no authentication token available
2025-06-08 13:34:23,123 - ERROR - Failed to list models: HTTP error occurred: 404 Not Found
2025-06-08 13:34:23,124 - ERROR - Connection error when listing models: Connection failed
2025-06-08 13:34:23,127 - ERROR - Failed to get model: HTTP error occurred: 500 Internal Server Error
2025-06-08 13:34:23,128 - ERROR - Connection error when getting model: Connection failed
2025-06-08 13:34:23,137 - DEBUG - Unity Catalog check failed: Access denied
2025-06-08 13:34:23,137 - DEBUG - Jobs check failed: Forbidden
2025-06-08 13:34:23,137 - DEBUG - Volumes check failed: Access denied
2025-06-08 13:34:23,185 - DEBUG - Executing SQL: SELECT * FROM table
2025-06-08 13:34:23,186 - DEBUG - Executing SQL: SELECT * FROM table
2025-06-08 13:34:23,188 - DEBUG - Executing SQL: SELECT * FROM table
2025-06-08 13:34:23,189 - DEBUG - Executing SQL: SELECT * FROM table
2025-06-08 13:34:23,190 - DEBUG - Executing SQL: SELECT * INVALID SQL
2025-06-08 13:34:23,191 - DEBUG - Executing SQL: SELECT * INVALID SQL
