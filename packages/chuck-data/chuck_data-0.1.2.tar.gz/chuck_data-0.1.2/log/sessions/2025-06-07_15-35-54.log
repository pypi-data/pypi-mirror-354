2025-06-07 15:35:54,860 - DEBUG - Logging initialized. Writing to /Users/johnrush/repos/chuck-data/log/sessions/2025-06-07_15-35-54.log
2025-06-07 15:35:54,862 - DEBUG - GET request to: https://test-workspace.cloud.databricks.com/test-endpoint
2025-06-07 15:35:54,863 - DEBUG - GET request to: https://test-workspace.cloud.databricks.com/test-endpoint
2025-06-07 15:35:54,863 - DEBUG - HTTP error: HTTP 404, Response: Not Found
2025-06-07 15:35:54,864 - DEBUG - GET request to: https://test-workspace.cloud.databricks.com/test-endpoint
2025-06-07 15:35:54,864 - DEBUG - Connection error: Connection failed
2025-06-07 15:35:54,864 - DEBUG - POST request to: https://test-workspace.cloud.databricks.com/test-endpoint
2025-06-07 15:35:54,865 - DEBUG - POST request to: https://test-workspace.cloud.databricks.com/test-endpoint
2025-06-07 15:35:54,865 - DEBUG - HTTP error: HTTP 400, Response: Bad Request
2025-06-07 15:35:54,866 - DEBUG - POST request to: https://test-workspace.cloud.databricks.com/test-endpoint
2025-06-07 15:35:54,866 - DEBUG - Connection error: Connection failed
2025-06-07 15:35:54,867 - DEBUG - HTTP error: HTTP 401, Response: {"status":401,"message":"Unauthorized"}
2025-06-07 15:35:54,869 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpm31_c57q/test_config.json
2025-06-07 15:35:54,869 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpm31_c57q/test_config.json
2025-06-07 15:35:54,870 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpu_lbewzn/test_config.json
2025-06-07 15:35:54,871 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpu_lbewzn/test_config.json
2025-06-07 15:35:54,872 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmprpbbqz9d/test_config.json
2025-06-07 15:35:54,872 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmprpbbqz9d/test_config.json
2025-06-07 15:35:54,872 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmprpbbqz9d/test_config.json
2025-06-07 15:35:54,872 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmprpbbqz9d/test_config.json
2025-06-07 15:35:54,872 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmprpbbqz9d/test_config.json
2025-06-07 15:35:54,873 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmprpbbqz9d/test_config.json
2025-06-07 15:35:54,873 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmprpbbqz9d/test_config.json
2025-06-07 15:35:54,873 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmprpbbqz9d/test_config.json
2025-06-07 15:35:54,873 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmprpbbqz9d/test_config.json
2025-06-07 15:35:54,873 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmprpbbqz9d/test_config.json
2025-06-07 15:35:54,873 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmprpbbqz9d/test_config.json
2025-06-07 15:35:54,873 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmprpbbqz9d/test_config.json
2025-06-07 15:35:54,873 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmprpbbqz9d/test_config.json
2025-06-07 15:35:54,874 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmprpbbqz9d/test_config.json
2025-06-07 15:35:54,874 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmprpbbqz9d/test_config.json
2025-06-07 15:35:54,875 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpc236y2zm/test_config.json
2025-06-07 15:35:54,875 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpc236y2zm/test_config.json
2025-06-07 15:35:54,875 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpc236y2zm/test_config.json
2025-06-07 15:35:54,876 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpc236y2zm/test_config.json
2025-06-07 15:35:54,876 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpc236y2zm/test_config.json
2025-06-07 15:35:54,876 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpc236y2zm/test_config.json
2025-06-07 15:35:54,876 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpc236y2zm/test_config.json
2025-06-07 15:35:54,876 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpc236y2zm/test_config.json
2025-06-07 15:35:54,876 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpc236y2zm/test_config.json
2025-06-07 15:35:54,876 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpc236y2zm/test_config.json
2025-06-07 15:35:54,877 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpc236y2zm/test_config.json
2025-06-07 15:35:54,877 - DEBUG - Using workspace_url from environment variable CHUCK_WORKSPACE_URL
2025-06-07 15:35:54,877 - DEBUG - Using active_model from environment variable CHUCK_ACTIVE_MODEL
2025-06-07 15:35:54,877 - DEBUG - Using warehouse_id from environment variable CHUCK_WAREHOUSE_ID
2025-06-07 15:35:54,877 - DEBUG - Using active_catalog from environment variable CHUCK_ACTIVE_CATALOG
2025-06-07 15:35:54,877 - DEBUG - Using active_schema from environment variable CHUCK_ACTIVE_SCHEMA
2025-06-07 15:35:54,878 - ERROR - Config file is corrupted. Using default config.
2025-06-07 15:35:54,879 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpaxaf482d/test_config.json
2025-06-07 15:35:54,880 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpc4kyt1nu/test_config.json
2025-06-07 15:35:54,880 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpc4kyt1nu/test_config.json
2025-06-07 15:35:54,880 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpc4kyt1nu/test_config.json
2025-06-07 15:35:54,880 - DEBUG - Using databricks_token from environment variable CHUCK_DATABRICKS_TOKEN
2025-06-07 15:35:54,881 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp29n80xpz/test_config.json
2025-06-07 15:35:54,882 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp29n80xpz/test_config.json
2025-06-07 15:35:54,882 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp29n80xpz/test_config.json
2025-06-07 15:35:54,882 - DEBUG - Using workspace_url from environment variable CHUCK_WORKSPACE_URL
2025-06-07 15:35:54,883 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp4sepe2b3/test_config.json
2025-06-07 15:35:54,885 - ERROR - Config file is corrupted. Using default config.
2025-06-07 15:35:54,885 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpd8lmuwte
2025-06-07 15:35:54,885 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpd8lmuwte
2025-06-07 15:35:54,886 - ERROR - Config file is corrupted. Using default config.
2025-06-07 15:35:54,886 - DEBUG - Using workspace_url from environment variable CHUCK_WORKSPACE_URL
2025-06-07 15:35:54,886 - DEBUG - Using active_model from environment variable CHUCK_ACTIVE_MODEL
2025-06-07 15:35:54,886 - DEBUG - Using warehouse_id from environment variable CHUCK_WAREHOUSE_ID
2025-06-07 15:35:54,886 - DEBUG - Using active_catalog from environment variable CHUCK_ACTIVE_CATALOG
2025-06-07 15:35:54,886 - DEBUG - Using active_schema from environment variable CHUCK_ACTIVE_SCHEMA
2025-06-07 15:35:54,886 - DEBUG - Using amperity_token from environment variable CHUCK_AMPERITY_TOKEN
2025-06-07 15:35:54,886 - DEBUG - Using databricks_token from environment variable CHUCK_DATABRICKS_TOKEN
2025-06-07 15:35:54,886 - DEBUG - Using usage_tracking_consent from environment variable CHUCK_USAGE_TRACKING_CONSENT
2025-06-07 15:35:54,887 - ERROR - Config file is corrupted. Using default config.
2025-06-07 15:35:54,888 - ERROR - Config file is corrupted. Using default config.
2025-06-07 15:35:54,888 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpdqbzc9h7
2025-06-07 15:35:54,888 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpdqbzc9h7
2025-06-07 15:35:54,889 - ERROR - Config file is corrupted. Using default config.
2025-06-07 15:35:54,889 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpsyj2z0mi
2025-06-07 15:35:54,890 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpsyj2z0mi
2025-06-07 15:35:54,890 - ERROR - Config file is corrupted. Using default config.
2025-06-07 15:35:54,890 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpg1x9cy_0
2025-06-07 15:35:54,891 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpg1x9cy_0
2025-06-07 15:35:54,891 - ERROR - Connection error during token validation: Network error
2025-06-07 15:35:54,892 - ERROR - Config file is corrupted. Using default config.
2025-06-07 15:35:54,892 - INFO - Using Databricks token from environment variable. Consider using /set-token to save it to config.
2025-06-07 15:35:54,892 - ERROR - Config file is corrupted. Using default config.
2025-06-07 15:35:54,892 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpbk_squar
2025-06-07 15:35:54,893 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmpbk_squar
2025-06-07 15:35:54,893 - ERROR - Config file is corrupted. Using default config.
2025-06-07 15:35:54,893 - DEBUG - Saved configuration to /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp_o2wc5s_
2025-06-07 15:35:54,894 - DEBUG - Loaded configuration from /var/folders/3f/2n5sjdw50vj9gfnrxjbptj4c0000gn/T/tmp_o2wc5s_
2025-06-07 15:35:54,896 - DEBUG - GET request to: https://adb-3856707039489412.12.azuredatabricks.net/test-endpoint
2025-06-07 15:35:54,898 - DEBUG - GET request to: https://test-workspace.cloud.databricks.com/test-endpoint
2025-06-07 15:35:54,899 - DEBUG - GET request to: https://test-workspace.cloud.databricks.com/test-endpoint
2025-06-07 15:35:54,899 - DEBUG - HTTP error: HTTP 404, Response: Not Found
2025-06-07 15:35:54,899 - DEBUG - GET request to: https://test-workspace.cloud.databricks.com/test-endpoint
2025-06-07 15:35:54,899 - DEBUG - Connection error: Connection failed
2025-06-07 15:35:54,900 - DEBUG - POST request to: https://test-workspace.cloud.databricks.com/test-endpoint
2025-06-07 15:35:54,900 - DEBUG - POST request to: https://test-workspace.cloud.databricks.com/test-endpoint
2025-06-07 15:35:54,901 - DEBUG - HTTP error: HTTP 400, Response: Bad Request
2025-06-07 15:35:54,901 - DEBUG - POST request to: https://test-workspace.cloud.databricks.com/test-endpoint
2025-06-07 15:35:54,901 - DEBUG - Connection error: Connection failed
2025-06-07 15:35:54,902 - DEBUG - Token validation failed: Token validation failed
2025-06-07 15:35:54,904 - DEBUG - File upload request to: https://test-workspace.cloud.databricks.com/api/2.0/fs/files/test/path.txt
2025-06-07 15:35:54,905 - DEBUG - File upload request to: https://test-workspace.cloud.databricks.com/api/2.0/fs/files/test/path.txt
2025-06-07 15:35:54,907 - WARNING - Model 'nonexistent-model' not found
2025-06-07 15:35:54,911 - DEBUG - Metrics tracking skipped - user has not provided consent
2025-06-07 15:35:54,912 - DEBUG - Sending metric: {"event": "USAGE", "prompt": "test prompt"}...
2025-06-07 15:35:54,913 - DEBUG - Sending metric: {"event": "USAGE", "prompt": "test prompt"}...
2025-06-07 15:35:54,914 - DEBUG - Sending metric: {"event": "USAGE", "prompt": "test prompt"}...
2025-06-07 15:35:54,914 - DEBUG - Error sending metrics: Test exception
Traceback (most recent call last):
  File "/Users/johnrush/repos/chuck-data/chuck_data/metrics_collector.py", line 123, in send_metric
    return self._client.submit_metrics(payload, token)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "/Users/johnrush/repos/chuck-data/tests/fixtures/amperity.py", line 60, in submit_metrics
    raise Exception("Test exception")
Exception: Test exception
2025-06-07 15:35:54,915 - DEBUG - Cannot send metrics - no authentication token available
2025-06-07 15:35:54,917 - ERROR - Failed to list models: HTTP error occurred: 404 Not Found
2025-06-07 15:35:54,918 - ERROR - Connection error when listing models: Connection failed
2025-06-07 15:35:54,919 - ERROR - Failed to get model: HTTP error occurred: 500 Internal Server Error
2025-06-07 15:35:54,919 - ERROR - Connection error when getting model: Connection failed
2025-06-07 15:35:54,940 - DEBUG - Basic connectivity check failed: 'DatabricksClientStub' object has no attribute 'get'
2025-06-07 15:35:54,940 - DEBUG - Unity Catalog check failed: 'DatabricksClientStub' object has no attribute 'get'
2025-06-07 15:35:54,940 - DEBUG - SQL Warehouse check failed: 'DatabricksClientStub' object has no attribute 'get'
2025-06-07 15:35:54,940 - DEBUG - Jobs check failed: 'DatabricksClientStub' object has no attribute 'get'
2025-06-07 15:35:54,940 - DEBUG - Models check failed: 'DatabricksClientStub' object has no attribute 'get'
2025-06-07 15:35:54,940 - DEBUG - Volumes check failed: 'DatabricksClientStub' object has no attribute 'get'
2025-06-07 15:35:54,948 - DEBUG - Basic connectivity check failed: 'DatabricksClientStub' object has no attribute 'get'
2025-06-07 15:35:54,948 - DEBUG - Unity Catalog check failed: 'DatabricksClientStub' object has no attribute 'get'
2025-06-07 15:35:54,948 - DEBUG - SQL Warehouse check failed: 'DatabricksClientStub' object has no attribute 'get'
2025-06-07 15:35:54,948 - DEBUG - Jobs check failed: 'DatabricksClientStub' object has no attribute 'get'
2025-06-07 15:35:54,948 - DEBUG - Models check failed: 'DatabricksClientStub' object has no attribute 'get'
2025-06-07 15:35:54,948 - DEBUG - Volumes check failed: 'DatabricksClientStub' object has no attribute 'get'
2025-06-07 15:35:54,954 - DEBUG - Executing SQL: SELECT * FROM table
2025-06-07 15:35:54,954 - DEBUG - Executing SQL: SELECT * FROM table
2025-06-07 15:35:54,955 - DEBUG - Executing SQL: SELECT * FROM table
2025-06-07 15:35:54,956 - DEBUG - Executing SQL: SELECT * FROM table
2025-06-07 15:35:54,956 - DEBUG - Executing SQL: SELECT * INVALID SQL
2025-06-07 15:35:54,957 - DEBUG - Executing SQL: SELECT * INVALID SQL
