import numpy as np
from semivalues.shapley import exact


def utility_function(coalition: set) -> float:
    """
    Calculates the value of a given coalition for a 5-player game.

    Players = {0, 1, 2, 3, 4}

    Rules:
    - Base value: Each player contributes 10 points.
    - Initiator bonus: If player 0 is in the coalition, add 40 points.
    - Partner synergy: If players 1 and 2 are both in the coalition, add 20 points.

    Args:
        coalition: A set containing the player IDs (e.g., {0, 3, 4}).

    Returns:
        The total value generated by the coalition.
    """
    if not isinstance(coalition, set):
        raise TypeError("Input coalition must be a set.")

    # Rule 1: Base value from each member
    value = float(10 * len(coalition))

    # Rule 2: Add initiator bonus
    if 0 in coalition:
        value += 40.0

    # Rule 3: Add partner synergy bonus
    if {1, 2}.issubset(coalition):
        value += 20.0

    return value


assert np.allclose(exact(utility_function, 5), np.array([50, 20, 20, 10, 10]))
