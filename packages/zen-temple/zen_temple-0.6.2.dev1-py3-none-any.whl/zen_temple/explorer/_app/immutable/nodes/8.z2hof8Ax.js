import"../chunks/CWj6FrbW.js";import{o as Ee}from"../chunks/CTIMrZMQ.js";import{p as Ve,s as i,a as X,u as te,b as N,f as M,c as Ye,g as e,d as l,e as Le,h as r,t as Me,n as O,j as Oe,r as qe}from"../chunks/BUw4_zXp.js";import{f as y,a as f}from"../chunks/CSp5jfsq.js";import{i as h}from"../chunks/DZ2ir7Ph.js";import{F as Ge,a as ce,S as He,b as q,r as Je,t as re,c as Ke,f as Qe}from"../chunks/DAT8a9Ut.js";import{A as ue,T as We}from"../chunks/BwpfFw4c.js";import{R as xe}from"../chunks/DFTcpuzr.js";import{B as Xe}from"../chunks/D-uQzuoh.js";import{D as de}from"../chunks/7t7HpQMM.js";import{g as ae,u as Ze}from"../chunks/CGkOqb8s.js";var $e=y("<!> <!>",1),et=y("<!> <!> <!>",1),tt=y("<!> <!> <!> <!>",1),rt=y("<!> <!>",1),at=y("<!> <!>",1),nt=y('<div class="text-center"><div class="spinner-border center" role="status"><span class="visually-hidden">Loading...</span></div></div>'),ot=y('<div class="text-center">No technologies with this selection.</div>'),lt=y('<div class="text-center">No carriers with this selection.</div>'),st=y('<div class="text-center">No solution selected.</div>'),it=y('<div class="text-center">No locations with this selection.</div>'),ct=y('<div class="text-center">No data with this selection.</div>'),ut=y('<h1 class="mt-2 mb-4">The Transition Pathway &ndash; Capacity</h1> <!> <div class="mt-4"><!></div>',1);function wt(we,Ne){Ve(Ne,!0);let w=i(null);const Se=["capacity","capacity_addition"],Te=["conversion","storage","transport"],_e=["energy","power"],ke=[{label:"Node",value:"node"},{label:"Technology",value:"technology"}];let G=i(X([])),o=i(null),_=i("capacity"),s=i("conversion"),P=i("energy"),g=i(null),H=i("technology"),Z=i(!1),A=i(X([])),B=i(X([])),L=i(X([])),S=i(!1),F=i(!1),ge=i(X({})),Ie=l(()=>{const t=e(s)=="storage"?e(P):"power";return e(ge)[e(D)[0]+"_"+t]||""}),Pe=l(()=>e(L).map(t=>t.toString())),Fe=l(()=>({responsive:!0,scales:{x:{stacked:!0,title:{display:!0,text:"Year"}},y:{stacked:!0,title:{display:!0,text:`${e(_)} [${e(Ie)}]`}}},interaction:{intersect:!1,mode:"nearest",axis:"x"}})),Ue=l(()=>e(o)==null?"":[e(o).solution_name.split(".").pop(),e(o).scenario_name,e(_),e(s),e(g)].join("_")),C=l(()=>{if(e(w)===null||e(o)===null)return[];let t=[];return e(w).data.forEach(a=>{let u=a.technology,T=e(o).detail.reference_carrier[u];!t.includes(T)&&e(ve).includes(a.technology)&&t.push(T)}),t}),ve=l(()=>{if(!e(o)||!e(s))return[];const t={conversion:"set_conversion_technologies",storage:"set_storage_technologies",transport:"set_transport_technologies"}[e(s)];return e(o).detail.system[t]||[]}),D=l(()=>e(o)===null||e(s)===null?[]:e(ve).filter(t=>{var a;return((a=e(o))==null?void 0:a.detail.reference_carrier[t])==e(g)})),J=l(()=>e(w)===null?[]:Je(e(w).data.filter(t=>e(D).includes(t.technology)).map(t=>t.location)));te(()=>{e(C),Le(()=>{(e(g)==null||!e(C).includes(e(g)))&&r(g,e(C).length>0?e(C)[0]:null,!0)})}),te(()=>{r(B,e(D),!0)}),te(()=>{r(A,e(J),!0)}),Ee(()=>{r(_,ae("variable")||e(_),!0),r(s,ae("technology_type")||e(s),!0),r(P,ae("storage_type")||e(P),!0),r(g,ae("carrier")||e(g),!0)}),te(()=>{e(_),e(s),e(P),e(g),Me().then(()=>{Ze({variable:e(_),technology_type:e(s),storage_type:e(P),carrier:e(g)})})});function $(){r(H,"node"),r(Z,!1),r(A,e(J),!0),r(B,e(D),!0),r(L,e(G),!0)}async function je(){$(),await fe()}async function Ae(){$(),await fe()}function pe(){$()}function Be(){$()}async function fe(){var a;if(e(_)===null||e(o)===null){r(w,null);return}r(F,!0),r(w,null);const t=await Ke(e(o).solution_name,e(_),e(o).scenario_name,e(o).detail.system.reference_year,e(o).detail.system.interval_between_years);r(w,t.data,!0),(a=t.unit)!=null&&a.data&&r(ge,Object.fromEntries(t.unit.data.map(u=>[u.technology+"_"+u.capacity_type,u[0]||u.units])),!0),r(F,!1)}let he=l(()=>{if(e(_)==null||e(A).length==0||e(L).length==0||e(B).length==0||e(w)===null)return[];let t={},a={};e(H)=="technology"?(t.location=e(A),a.technology=e(B)):(t.technology=e(B),a.location=e(A)),e(s)=="storage"?a.capacity_type=[e(P)]:a.capacity_type=_e;let u=e(G).filter(T=>!e(L).includes(T));return Qe(e(w).data,t,a,u,e(Z))});var ye=ut(),me=N(M(ye),2);Ge(me,{children:(t,a)=>{var u=at(),T=M(u);ce(T,{title:"Solution Selection",children:(R,Q)=>{const m=l(()=>e(F)||e(S));He(R,{solution_selected:je,get disabled(){return e(m)},get selected_solution(){return e(o)},set selected_solution(b){r(o,b,!0)},get loading(){return e(S)},set loading(b){r(S,b,!0)},get years(){return e(G)},set years(b){r(G,b,!0)}})}});var U=N(T,2);{var K=R=>{var Q=rt(),m=M(Q);ce(m,{title:"Variable Selection",children:(z,k)=>{var E=et(),V=M(E);q(V,{label:"Variable",content:(c,n=O)=>{const d=l(()=>re(Se)),I=l(()=>e(F)||e(S));de(c,{get formId(){return n()},get options(){return e(d)},get disabled(){return e(I)},onUpdate:Ae,get value(){return e(_)},set value(p){r(_,p,!0)}})}});var Y=N(V,2);{var x=v=>{var c=$e(),n=M(c);q(n,{label:"Technology Type",content:(ee,oe=O)=>{const le=l(()=>re(Te)),se=l(()=>e(F)||e(S));de(ee,{get formId(){return oe()},get options(){return e(le)},get disabled(){return e(se)},onUpdate:pe,get value(){return e(s)},set value(ie){r(s,ie,!0)}})}});var d=N(n,2);{var I=p=>{q(p,{label:"",content:(oe,le=O)=>{const se=l(()=>re(_e)),ie=l(()=>e(F)||e(S));xe(oe,{get formId(){return le()},get options(){return e(se)},onUpdate:pe,get disabled(){return e(ie)},get value(){return e(P)},set value(ze){r(P,ze,!0)}})}})};h(d,p=>{e(s)=="storage"&&p(I)})}f(v,c)};h(Y,v=>{e(_)!=null&&v(x)})}var j=N(Y,2);{var W=v=>{q(v,{label:"Carrier",content:(n,d=O)=>{const I=l(()=>re(e(C))),p=l(()=>e(F)||e(S));de(n,{get formId(){return d()},get options(){return e(I)},get disabled(){return e(p)},onUpdate:Be,get value(){return e(g)},set value(ee){r(g,ee,!0)}})}})};h(j,v=>{e(s)!=null&&e(C).length>0&&v(W)})}f(z,E)}});var b=N(m,2);{var ne=z=>{ce(z,{title:"Data Selection",children:(k,E)=>{var V=tt(),Y=M(V);q(Y,{label:"Aggregation",content:(d,I=O)=>{xe(d,{get formId(){return I()},get options(){return ke},get value(){return e(H)},set value(p){r(H,p,!0)}})}});var x=N(Y,2);q(x,{label:"Normalization",content:(d,I=O)=>{We(d,{get formId(){return I()},get value(){return e(Z)},set value(p){r(Z,p,!0)}})}});var j=N(x,2);{var W=n=>{ue(n,{label:"Technology",get elements(){return e(D)},get value(){return e(B)},set value(d){r(B,d,!0)}})},v=n=>{ue(n,{label:"Node",get elements(){return e(J)},get value(){return e(A)},set value(d){r(A,d,!0)}})};h(j,n=>{e(H)=="technology"?n(W):n(v,!1)})}var c=N(j,2);ue(c,{label:"Year",get elements(){return e(G)},get value(){return e(L)},set value(n){r(L,n,!0)}}),f(k,V)}})};h(b,z=>{e(w)&&e(s)&&e(g)&&e(D).length>0&&e(J).length>0&&z(ne)})}f(R,Q)};h(U,R=>{!e(S)&&e(o)&&R(K)})}f(t,u)}});var be=N(me,2),Ce=Oe(be);{var De=t=>{var a=nt();f(t,a)},Re=(t,a)=>{{var u=U=>{var K=ot();f(U,K)},T=(U,K)=>{{var R=m=>{var b=lt();f(m,b)},Q=(m,b)=>{{var ne=k=>{var E=st();f(k,E)},z=(k,E)=>{{var V=x=>{var j=it();f(x,j)},Y=(x,j)=>{{var W=c=>{var n=ct();f(c,n)},v=c=>{Xe(c,{type:"bar",get datasets(){return e(he)},get labels(){return e(Pe)},get options(){return e(Fe)},get plot_name(){return e(Ue)}})};h(x,c=>{e(he).length==0?c(W):c(v,!1)},j)}};h(k,x=>{e(J).length==0?x(V):x(Y,!1)},E)}};h(m,k=>{e(o)==null?k(ne):k(z,!1)},b)}};h(U,m=>{e(C).length==0?m(R):m(Q,!1)},K)}};h(t,U=>{e(D).length==0?U(u):U(T,!1)},a)}};h(Ce,t=>{e(S)||e(F)?t(De):t(Re,!1)})}qe(be),f(we,ye),Ye()}export{wt as component};
