"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[3285],{92800:function(e,n,t){t.d(n,{Z:function(){return Z}});var r,a=t(90228),c=t.n(a),o=t(87999),u=t.n(o),i=t(48305),l=t.n(i),s=t(53649),d=t.n(s),f=t(32246),v=t(72541),p=t(38551),h=t(40174),g=t(1956),m=t(54235),x=t(85885),k=t(83603),y=t(50959),P=t(97884),w="delete-modal-content___bdNBR",S="content___YptSA",E=t(11527),C=P.ZP.div(r||(r=d()(["\n  margin-top: 20px;\n  margin-left: 30px;\n  display: flex;\n  justify-content: flex-start;\n  align-items: center;\n  .check-text {\n    font-weight: 700;\n    color: var(--ant-color-warning);\n  }\n"]))),T=(0,y.forwardRef)((function(e,n){var t,r=(0,p.useIntl)(),a=(0,f.Z)(),o=a.saveScrollHeight,i=a.restoreScrollHeight,s=(0,y.useState)(!1),d=l()(s,2),P=d[0],T=d[1],Z=(0,y.useState)(!1),L=l()(Z,2),b=L[0],D=L[1],R=(0,y.useState)({}),I=l()(R,2),A=I[0],j=I[1];(0,y.useImperativeHandle)(n,(function(){return{show:function(e){var n;o(),j(e),D((null===(n=e.checkConfig)||void 0===n?void 0:n.defautlChecked)||!1),T(!0)},hide:function(){T(!1),i()},configuration:{checked:b}}}));var M=function(){var e;T(!1),null===(e=A.onCancel)||void 0===e||e.call(A),i()},O=function(){var e=u()(c()().mark((function e(){var n,t;return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,null===(n=A.onOk)||void 0===n?void 0:n.call(A);case 3:t=e.sent,Array.isArray(t)?t.every((function(e){return"fulfilled"===(null==e?void 0:e.status)}))&&h.ZP.success(r.formatMessage({id:"common.message.success"})):h.ZP.success(r.formatMessage({id:"common.message.success"})),e.next=10;break;case 8:e.prev=8,e.t0=e.catch(0);case 10:return e.prev=10,T(!1),i(),e.finish(10);case 14:case"end":return e.stop()}}),e,null,[[0,8,10,14]])})));return function(){return e.apply(this,arguments)}}();return(0,E.jsxs)(g.Z,{style:{top:"20%"},open:P,onOk:O,onCancel:M,destroyOnClose:!0,closeIcon:!1,maskClosable:!1,keyboard:!1,width:460,styles:{},footer:(0,E.jsxs)(m.Z,{size:20,children:[(0,E.jsx)(x.ZP,{onClick:M,size:"middle",children:A.cancelText?r.formatMessage({id:A.cancelText}):r.formatMessage({id:"common.button.cancel"})}),(0,E.jsx)(x.ZP,{type:"primary",onClick:O,size:"middle",children:A.okText?r.formatMessage({id:A.okText}):r.formatMessage({id:"common.button.delete"})})]}),children:[(0,E.jsx)("div",{className:w,children:(0,E.jsxs)("span",{className:"title",children:[(0,E.jsx)(v.Z,{}),(0,E.jsx)("span",{children:A.title?r.formatMessage({id:A.title}):r.formatMessage({id:"common.title.delete.confirm"})})]})}),(0,E.jsx)("div",{className:S,dangerouslySetInnerHTML:{__html:A.content&&r.formatMessage({id:A.operation||""},{type:r.formatMessage({id:A.content}),name:A.name})}}),A.checkConfig&&(0,E.jsx)(C,{children:(0,E.jsx)(k.Z,{checked:b,onChange:function(e){return D(e.target.checked)},children:(0,E.jsx)("span",{className:"check-text",children:r.formatMessage({id:null===(t=A.checkConfig)||void 0===t?void 0:t.checkText})})})})]})})),Z=T},98817:function(e,n,t){var r=t(26068),a=t.n(r),c=t(32246),o=t(1956),u=t(50959),i=t(11527);n.Z=function(e){var n=(0,c.Z)(),t=n.saveScrollHeight,r=n.restoreScrollHeight;return u.useEffect((function(){e.open?t():r()}),[e.open]),(0,i.jsx)(o.Z,a()({},e))}},44336:function(e,n,t){t.d(n,{Z:function(){return w}});var r=t(26068),a=t.n(r),c=t(90228),o=t.n(c),u=t(87999),i=t.n(u),l=t(15558),s=t.n(l),d=t(48305),f=t.n(d),v=t(33330),p=t(66182),h=t(61918),g=t(28967),m=t(58258),x=t(32699),k=t.n(x),y=t(28694),P=t(50959);function w(e){var n=e.fetchAPI,t=e.deleteAPI,r=e.contentForDelete,c=e.API,u=e.watch,l=e.defaultData,d=void 0===l?[]:l,x=(0,P.useRef)(null),w=(0,P.useRef)(null),S=(0,p.Z)(),E=(0,h.Z)({defaultSortOrder:"descend"}),C=E.sortOrder,T=E.setSortOrder,Z=(0,P.useState)({dataList:s()(d),loading:!1,loadend:!1,total:0,totalPage:0}),L=f()(Z,2),b=L[0],D=L[1],R=(0,P.useState)({page:1,perPage:10,search:""}),I=f()(R,2),A=I[0],j=I[1],M=(0,v.ZP)().setChunkRequest,O=(0,g.Z)({events:["UPDATE","DELETE"],dataList:b.dataList,setDataList:function(e,n){D((function(t){return{total:t.total,totalPage:t.totalPage,loading:!1,loadend:!0,dataList:e,deletedIds:(null==n?void 0:n.deletedIds)||[]}}))}}),_=O.updateChunkedList,N=O.cacheDataListRef,H=function(e){k().each(e,(function(e){_(e)}))},F=function(){var e=i()(o()().mark((function e(n){var t,r,a;return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c&&u){e.next=2;break}return e.abrupt("return");case 2:null===(t=x.current)||void 0===t||null===(t=t.current)||void 0===t||null===(r=t.cancel)||void 0===r||r.call(t);try{a=k().omit(n||A,["page","perPage"]),x.current=M({url:"".concat(c,"?").concat(y.Z.stringify(k().pickBy(a,(function(e){return!!e})))),handler:H})}catch(e){}case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),K=function(){var e=i()(o()().mark((function e(t){var r,c,u,i,l;return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=(t||{}).query,D((function(e){return e.loading=!0,a()({},e)})),e.prev=2,c=a()({},k().pickBy(r||A,(function(e){return!!e}))),e.next=6,n(c);case 6:if(!(!(u=e.sent).items.length&&c.page>u.pagination.totalPage&&u.pagination.totalPage>0)){e.next=14;break}return i=a()(a()({},c),{},{page:u.pagination.totalPage}),e.next=11,n(i);case 11:return l=e.sent,D({dataList:l.items||[],loading:!1,loadend:!0,total:l.pagination.total,totalPage:l.pagination.totalPage}),e.abrupt("return");case 14:D({dataList:u.items||[],loading:!1,loadend:!0,total:u.pagination.total,totalPage:u.pagination.totalPage}),e.next=21;break;case 17:e.prev=17,e.t0=e.catch(2),D({dataList:[],loading:!1,loadend:!0,total:b.total,totalPage:b.totalPage});case 21:case"end":return e.stop()}}),e,null,[[2,17]])})));return function(n){return e.apply(this,arguments)}}(),q=function(e){j(a()(a()({},A),e)),K({query:a()(a()({},A),e)})},B=k().debounce((function(e){q({page:1,search:e.target.value}),F(a()(a()({},A),{},{search:e.target.value}))}),350);return(0,P.useEffect)((function(){var e=function(){var e=i()(o()().mark((function e(){return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,K();case 2:setTimeout((function(){F()}),200);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return e(),function(){var e,n;null===(e=x.current)||void 0===e||null===(n=e.cancel)||void 0===n||n.call(e),N.current=[]}}),[]),{dataSource:b,rowSelection:S,sortOrder:C,queryParams:A,modalRef:w,setQueryParams:j,handleDelete:function(e,n){w.current.show(a()(a()({content:r,operation:"common.delete.single.confirm",name:e.name},n),{},{onOk:function(){return i()(o()().mark((function n(){var r;return o()().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=3,null==t?void 0:t(e.id,a()({},null===(r=w.current)||void 0===r?void 0:r.configuration));case 3:K();case 4:case"end":return n.stop()}}),n)})))()}}))},handleDeleteBatch:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};w.current.show(a()(a()({content:r,operation:"common.delete.confirm",selection:!0},e),{},{onOk:function(){return i()(o()().mark((function e(){var n,r;return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return n=[],e.next=5,(0,m.D6)(S.selectedRowKeys,function(){var e=i()(o()().mark((function e(r){var c;return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t(r,a()({},null===(c=w.current)||void 0===c?void 0:c.configuration));case 2:n.push(r);case 3:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}());case 5:return r=e.sent,S.removeSelectedKeys(n),K(),e.abrupt("return",r);case 9:case"end":return e.stop()}}),e)})))()}}))},fetchData:K,handlePageChange:function(e,n){q({page:e,perPage:n||10})},handleTableChange:function(e,n,t){T(t.order)},handleSearch:function(){K()},handleQueryChange:q,handleNameChange:B}}},66182:function(e,n,t){t.d(n,{Z:function(){return o}});var r=t(48305),a=t.n(r),c=t(50959);function o(){var e=(0,c.useState)([]),n=a()(e,2),t=n[0],r=n[1],o=(0,c.useState)([]),u=a()(o,2),i=u[0],l=u[1],s={selectedRowKeys:t,selectedRows:i,enableSelection:!0,clearSelections:function(){r([]),l([])},onChange:function(e,n){r(e),l(n)},removeSelectedKeys:function(e){var n=t.filter((function(n){return!e.includes(n)}));return r(n),l((function(n){return n.filter((function(n){return!e.includes(n.id)}))})),n},removeSelectedKey:function(e){if(Array.isArray(e)){var n=t.filter((function(n){return!e.includes(n)}));return r(n),l((function(n){return n.filter((function(n){return!e.includes(n.id)}))})),n}var a=t.filter((function(n){return n!==e}));return r(a),l((function(n){return n.filter((function(n){return n.id!==e}))})),a}};return s}},61918:function(e,n,t){t.d(n,{Z:function(){return o}});var r=t(48305),a=t.n(r),c=t(50959);function o(e){var n=e.defaultSortOrder,t=void 0===n?"descend":n,r=(0,c.useState)(t),o=a()(r,2),u=o[0],i=o[1];return{sortOrder:u,setSortOrder:function(e){e?i(e):"descend"===t?i("ascend"):"ascend"===t&&i("descend")}}}},28967:function(e,n,t){var r=t(26068),a=t.n(r),c=t(15558),o=t.n(c),u=t(20369),i=t(50959);n.Z=function(e){var n=e.events,t=void 0===n?["CREATE","DELETE","UPDATE","INSERT"]:n,r=(0,i.useRef)(new Set),c=(0,i.useRef)(e.dataList||[]),l=(0,i.useRef)(null),s=e.limit||10;return(0,i.useEffect)((function(){c.current=o()(e.dataList||[])}),[e.dataList]),{updateChunkedList:function(n){var i,d,f,v=(null==n?void 0:n.collection)||[];null!=e&&e.computedID&&(v=null===(i=v)||void 0===i?void 0:i.map((function(n){var t;return n.id=null==e||null===(t=e.computedID)||void 0===t?void 0:t.call(e,n),n})));null!=e&&e.filterFun&&(v=null==n||null===(d=n.collection)||void 0===d?void 0:d.filter(null==e?void 0:e.filterFun));null!=e&&e.mapFun&&(v=null==n||null===(f=n.collection)||void 0===f?void 0:f.map(null==e?void 0:e.mapFun));var p,h,g,m=(null==n?void 0:n.ids)||[];if((null==n?void 0:n.type)===u._W.CREATE&&t.includes("CREATE")){var x=v.reduce((function(e,n){var t,r=null===(t=c.current)||void 0===t?void 0:t.findIndex((function(e){return e.id===n.id})),o=a()({},n);return-1===r?e.push(o):c.current[r]=o,e}),[]);c.current=[].concat(o()(x),o()(c.current)).slice(0,s)}(null==n?void 0:n.type)===u._W.DELETE&&t.includes("DELETE")&&(c.current=null===(p=c.current)||void 0===p?void 0:p.filter((function(e){return!(null!=m&&m.includes(e.id))})),function(e){r.current=new Set([].concat(o()(r.current),o()(e)))}(m),null===(h=e.setDataList)||void 0===h||h.call(e,o()(c.current),{deletedIds:o()(r.current)}));(null==n?void 0:n.type)===u._W.UPDATE&&t.includes("UPDATE")&&(null===(g=v)||void 0===g||g.forEach((function(e){var n,r=null===(n=c.current)||void 0===n?void 0:n.findIndex((function(n){return n.id===e.id})),u=a()({},e);r>-1?c.current[r]=u:-1===r&&t.includes("INSERT")&&(c.current=[u].concat(o()(c.current.slice(0,s-1))))})));clearTimeout(l.current),l.current=setTimeout((function(){var n;null===(n=e.setDataList)||void 0===n||n.call(e,o()(c.current))}),200),null!=e&&e.callback&&(null==e||e.callback(c.current))},cacheDataListRef:c,deletedIdsRef:r}}}}]);