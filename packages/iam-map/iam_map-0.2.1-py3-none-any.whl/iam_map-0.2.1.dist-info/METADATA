Metadata-Version: 2.4
Name: iam-map
Version: 0.2.1
Summary: Offline IAM graph exporter + NLP query shell
Author-email: Hrishi Logani <loganihrishi@gmail.com>
Requires-Python: >=3.8
Description-Content-Type: text/markdown
Requires-Dist: boto3
Requires-Dist: networkx
Requires-Dist: pydot
Requires-Dist: pyparsing>=3.0.9
Requires-Dist: rich
Requires-Dist: typer[all]
Requires-Dist: requests

# ğŸ—ºï¸ IAM Map â€” AWS IAM Graph Analyzer

A powerful CLI to explore IAM users, groups, and policies across AWS accounts â€” with AI-powered natural language support via **Ollama + Mistral**.

---

## ğŸ’Š Choose Your Path

### ğŸ”µ The Blue Pill â€” Just Install and Play

1. **Install the package:**

```bash
pip install iam-map
````

2. **Export a graph:**

```bash
iam-map export-graph --profile my-account
```

3. **Start ollama:**

```bash
ollama run mistral
```

4. **Ask questions with natural language:**

```bash
iam-map shell --profile my-account
```

Example prompts:

```
ğŸ’¬ > Who has EC2 or Lambda access but not S3?
ğŸ’¬ > Which users are in dev or test group with full Admin rights?
```

Thatâ€™s it. Explore your IAM relationships like never before.

---

### ğŸ”´ The Red Pill â€” Customize Everything

If you're a power user or developer, go deeper.

#### ğŸ”§ Install from Source

```bash
git clone https://github.com/yourname/iam-map.git
cd iam-map
pip install --editable .
```

#### ğŸ“¦ Requirements

* Python 3.8+
* `boto3`, `networkx`, `rich`, `typer`
* [Ollama](https://ollama.com) running locally with a model like `mistral`

#### ğŸ§± Project Structure

```
iam_map/
â”œâ”€â”€ cli.py            â† main CLI
â”œâ”€â”€ exporter.py       â† fetch IAM data to .dot
â”œâ”€â”€ graph_query.py    â† query logic
â”œâ”€â”€ ollama_client.py  â† talk to Ollama API
â”œâ”€â”€ paths.py          â† path resolution
```

---

## âš™ï¸ Features

- Export IAM users, groups, and policies  
- Query users using filters: policies, groups, logic  
- List username + ID in rich table
- Support for **multiple AWS accounts**
- Natural language shell via Ollama  


---
## ğŸ§­ Usage

### ğŸ” Configure Your AWS Profiles

```bash
aws configure --profile dev
aws configure --profile prod
```

Each IAM user must have these permissions:

```json
{
  "Action": [
    "iam:ListUsers",
    "iam:ListGroupsForUser",
    "iam:ListAttachedUserPolicies",
    "iam:ListAttachedGroupPolicies"
  ],
  "Effect": "Allow",
  "Resource": "*"
}
```

---

### ğŸ“¤ Export IAM Graphs

```bash
iam-map export-graph --profile dev
# â†’ creates: data/dev.dot
```

---

### ğŸ“Š Query Your IAM Graph

```bash
iam-map query-graph --dot-path data/dev.dot --include-policy AmazonEC2FullAccess
```

Add filters using:

* `--include-policy`, `--exclude-policy`
* `--include-group`, `--exclude-group`
* `--policy-logic any` or `all`
* `--group-logic any` or `all`

---

### ğŸ’¬ AI Shell (Natural Language)

```bash
iam-map shell --profile dev
```

By default, this:

- Talks to http://localhost:11434

- Sends your query to the mistral model via Ollama

To make that work, start the model manually (do this before you use iam-map):

```bash
ollama run mistral
```

ğŸ”§ Customize Ollama Settings
Running on a different model or port? 

No problem:

```bash
iam-map shell --profile dev --port <your-port> --model <your-model>
```


Requires:

* Ollama running locally
* Model like `mistral`, `llama3`, etc.

---

## ğŸŒ Graph Rendering (optional)

Generate diagrams from `.dot` files:

```bash
dot -Tpng data/dev.dot -o output/dev.png
```

Or PDF/SVG:

```bash
dot -Tsvg data/dev.dot -o output/dev.svg
```

### Install Graphviz:

```bash
# macOS
brew install graphviz

# Ubuntu
sudo apt install graphviz

# Windows
choco install graphviz
```

---

## ğŸ“ Output Locations

By default:

* Graphs â†’ `data/`
* Visuals â†’ `output/`

You can override these by setting environment variables:

```bash
export DATA_DIR=/custom/data
export OUTPUT_DIR=/custom/output
```

---

## ğŸ§  Powered By

* AWS IAM + `boto3`
* Graph engine: `networkx`
* CLI: `typer`, `rich`
* Natural Language: Ollama + Mistral

---

## âœ¨ Why Use IAM Map?

âœ… Works offline after export  
âœ… Lets you *see* IAM relationships  
âœ… Filters users like a database  
âœ… Natural language interface â€” no memorizing flags  
âœ… Clean CLI + optional visual outputs


---

Ready to map your IAM?

```
iam-map shell --profile your-account
```

ğŸŒ Know your access. Map your roles. Secure your cloud.

