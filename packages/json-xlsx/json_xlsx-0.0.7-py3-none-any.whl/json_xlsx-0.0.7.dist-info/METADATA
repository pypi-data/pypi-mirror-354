Metadata-Version: 2.4
Name: json_xlsx
Version: 0.0.7
Summary: Convert nested JSON data to formatted Excel files
Project-URL: Homepage, https://github.com/quantatirsk/json_xlsx
Project-URL: Repository, https://github.com/quantatirsk/json_xlsx.git
Project-URL: Documentation, https://github.com/quantatirsk/json_xlsx#readme
Project-URL: Bug Tracker, https://github.com/quantatirsk/json_xlsx/issues
Author-email: Quant <pengzhia@gmail.com>
Maintainer-email: Quant <pengzhia@gmail.com>
License-Expression: MIT
License-File: LICENSE
Keywords: converter,data-processing,excel,json,openpyxl,pandas,xlsx
Classifier: Development Status :: 4 - Beta
Classifier: Intended Audience :: Developers
Classifier: License :: OSI Approved :: MIT License
Classifier: Operating System :: OS Independent
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3.8
Classifier: Programming Language :: Python :: 3.9
Classifier: Programming Language :: Python :: 3.10
Classifier: Programming Language :: Python :: 3.11
Classifier: Programming Language :: Python :: 3.12
Classifier: Topic :: Office/Business :: Office Suites
Classifier: Topic :: Software Development :: Libraries :: Python Modules
Classifier: Topic :: Utilities
Requires-Python: >=3.8
Requires-Dist: openpyxl>=3.0.0
Requires-Dist: pandas>=2.0.0
Provides-Extra: dev
Requires-Dist: black; extra == 'dev'
Requires-Dist: flake8; extra == 'dev'
Requires-Dist: mypy; extra == 'dev'
Requires-Dist: pytest-cov; extra == 'dev'
Requires-Dist: pytest>=6.0; extra == 'dev'
Provides-Extra: test
Requires-Dist: pytest-cov; extra == 'test'
Requires-Dist: pytest>=6.0; extra == 'test'
Description-Content-Type: text/markdown

# json_xlsx

[![PyPI version](https://badge.fury.io/py/json_xlsx.svg)](https://badge.fury.io/py/json_xlsx)
[![Python versions](https://img.shields.io/pypi/pyversions/json_xlsx.svg "3.8")](https://pypi.org/project/json_xlsx/)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)

ä¸€ä¸ªç®€å•æ˜“ç”¨çš„Pythonåº“ï¼Œç”¨äºå°†å¤æ‚çš„åµŒå¥—JSONæ•°æ®è½¬æ¢ä¸ºæ ¼å¼åŒ–çš„Excelæ–‡ä»¶ã€‚

## âœ¨ ç‰¹æ€§

* ğŸš€  **ç®€å•æ˜“ç”¨** : ä¸€è¡Œä»£ç å®ŒæˆJSONåˆ°Excelçš„è½¬æ¢
* ğŸ“Š  **æ™ºèƒ½æ‰å¹³åŒ–** : è‡ªåŠ¨å¤„ç†æ·±å±‚åµŒå¥—çš„JSONç»“æ„
* ğŸ¨  **ç²¾ç¾æ ¼å¼** : è‡ªåŠ¨åº”ç”¨ä¸“ä¸šçš„Excelæ ¼å¼å’Œæ ·å¼
* ğŸ“‹  **å¤šå·¥ä½œè¡¨** : åŒæ—¶ç”ŸæˆåŸå§‹æ•°æ®å’Œæ‰å¹³åŒ–æ•°æ®ä¸¤ä¸ªå·¥ä½œè¡¨
* ğŸ”§  **é«˜åº¦å¯é…ç½®** : æ”¯æŒè‡ªå®šä¹‰åˆ†éš”ç¬¦ã€æ·±åº¦é™åˆ¶ç­‰é…ç½®
* ğŸ“±  **æ•°ç»„å‹å¥½** : æ™ºèƒ½å¤„ç†å„ç§ç±»å‹çš„æ•°ç»„æ•°æ®
* ğŸŒ  **ä¸­æ–‡æ”¯æŒ** : å®Œç¾æ”¯æŒä¸­æ–‡å­—ç¬¦å’Œå†…å®¹

## ğŸ“¦ å®‰è£…

```bash
pip install json-xlsx
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å¿«é€Ÿä½“éªŒ

```python
"""
æµ‹è¯•json_xlsxåº“
"""

import requests
from json_xlsx import convert_json_to_excel

# è·å–å“åº”æ•°æ®
response = requests.get("https://dummyjson.com/recipes", timeout=10)
response_data = response.json()

# è·å–ç¬¬ä¸€ä¸ªkeyçš„å€¼
json_data = response_data.get(list(response_data.keys())[0])

# é…ç½®è¡¨å¤´èƒŒæ™¯è‰²å’Œå­—ä½“é¢œè‰²
CONFIG = {"header_background_color": "123456", "header_font_color": "FFFFFF"}

# è¾“å‡ºè·¯å¾„
OUTPUT_PATH = "sample.xlsx" 

# è½¬æ¢æ•°æ®
result = convert_json_to_excel(json_data, OUTPUT_PATH, CONFIG)

# æ‰“å°è¾“å‡ºè·¯å¾„
print(result["output_path"])

```

### åŸºæœ¬ç”¨æ³•

```python
from json_xlsx import convert_json_to_excel

# å‡†å¤‡JSONæ•°æ®
data = [
    {
        "name": "å¼ ä¸‰",
        "age": 30,
        "address": {
            "city": "åŒ—äº¬",
            "district": "æµ·æ·€åŒº"
        },
        "skills": ["Python", "JavaScript"]
    },
    {
        "name": "æå››",
        "age": 25,
        "address": {
            "city": "ä¸Šæµ·", 
            "district": "æµ¦ä¸œæ–°åŒº"
        },
        "skills": ["Java", "Spring"]
    }
]

# è½¬æ¢ä¸ºExcel
result = convert_json_to_excel(data, "output.xlsx")

if result["success"]:
    print(f"è½¬æ¢æˆåŠŸï¼ç”Ÿæˆäº† {result['records_count']} æ¡è®°å½•")
else:
    print(f"è½¬æ¢å¤±è´¥: {result['error']}")
```

### é«˜çº§ç”¨æ³•

```python
from json_xlsx import JsonToExcelConverter

# è‡ªå®šä¹‰é…ç½®
config = {
    "separator": "_",           # ä½¿ç”¨ä¸‹åˆ’çº¿ä½œä¸ºå­—æ®µåˆ†éš”ç¬¦
    "max_depth": 10,           # æœ€å¤§é€’å½’æ·±åº¦
    "max_column_width": 80,    # æœ€å¤§åˆ—å®½
}

# åˆ›å»ºè½¬æ¢å™¨
converter = JsonToExcelConverter(config)

# æ‰§è¡Œè½¬æ¢
result = converter.convert(data, "advanced_output.xlsx")
```

## ğŸ“Š è¾“å‡ºæ ¼å¼

è½¬æ¢åçš„Excelæ–‡ä»¶åŒ…å«ä¸¤ä¸ªå·¥ä½œè¡¨ï¼š

1. **å¯¹æ¯”æ•°æ®** : æ‰å¹³åŒ–åçš„ç»“æ„åŒ–æ•°æ®ï¼Œä¾¿äºåˆ†æå’Œå¤„ç†
2. **åŸå§‹æ•°æ®** : ä¿ç•™åŸå§‹JSONæ ¼å¼ï¼Œä¾¿äºè¿½æº¯å’ŒæŸ¥çœ‹

### æ‰å¹³åŒ–ç¤ºä¾‹

è¾“å…¥JSON:

```json
{
    "user": {
        "name": "å¼ ä¸‰",
        "contact": {
            "email": "zhangsan@example.com"
        }
    }
}
```

æ‰å¹³åŒ–ç»“æœ:

| user/name | user/contact/email   |
| --------- | -------------------- |
| å¼ ä¸‰      | zhangsan@example.com |

## âš™ï¸ é…ç½®é€‰é¡¹

```python
CONVERTER_CONFIG = {
    'max_depth': 15,              # æœ€å¤§é€’å½’æ·±åº¦
    'separator': '/',             # é”®ååˆ†éš”ç¬¦
    'auto_width': True,           # è‡ªåŠ¨è°ƒæ•´åˆ—å®½
    'wrap_text': True,            # è‡ªåŠ¨æ¢è¡Œ
    'max_column_width': 100,      # æœ€å¤§åˆ—å®½
    'min_column_width': 14,       # æœ€å°åˆ—å®½
    'row_height_factor': 18,      # è¡Œé«˜ç³»æ•°
}
```

## ğŸ”§ API å‚è€ƒ

### convert_json_to_excel(data, output_path, config=None)

ç®€åŒ–çš„è½¬æ¢å‡½æ•°ã€‚

**å‚æ•°:**

* `data`: JSONæ•°æ®ï¼ˆåˆ—è¡¨æˆ–å•ä¸ªå­—å…¸ï¼‰
* `output_path`: è¾“å‡ºExcelæ–‡ä»¶è·¯å¾„
* `config`: å¯é€‰çš„é…ç½®å­—å…¸

**è¿”å›:**
åŒ…å«è½¬æ¢ç»“æœçš„å­—å…¸

### JsonToExcelConverter

ä¸»è¦çš„è½¬æ¢å™¨ç±»ã€‚

**æ–¹æ³•:**

* `__init__(config=None)`: åˆå§‹åŒ–è½¬æ¢å™¨
* `convert(data, output_path, **kwargs)`: ç®€åŒ–çš„è½¬æ¢æ–¹æ³•
* `convert_to_excel(data, output_path, verbose=True)`: å®Œæ•´çš„è½¬æ¢æ–¹æ³•
* `flatten_dict(data, parent_key="", sep=None, depth=0)`: æ‰å¹³åŒ–å­—å…¸

## ğŸ“ ä½¿ç”¨ç¤ºä¾‹

### å¤„ç†å¤æ‚åµŒå¥—æ•°æ®

```python
complex_data = {
    "company": "ç§‘æŠ€å…¬å¸",
    "employees": [
        {
            "name": "å¼ ä¸‰",
            "position": "å·¥ç¨‹å¸ˆ",
            "skills": ["Python", "JavaScript"],
            "address": {
                "city": "åŒ—äº¬",
                "district": "æµ·æ·€åŒº"
            }
        }
    ],
    "financial": {
        "revenue": 1000000,
        "expenses": {
            "salary": 600000,
            "rent": 120000
        }
    }
}

convert_json_to_excel(complex_data, "company_data.xlsx")
```

### æ‰¹é‡å¤„ç†æ•°æ®

```python
# å¤„ç†å¤šæ¡è®°å½•
records = [
    {"id": 1, "name": "äº§å“A", "price": 99.99},
    {"id": 2, "name": "äº§å“B", "price": 149.99},
    {"id": 3, "name": "äº§å“C", "price": 199.99}
]

result = convert_json_to_excel(records, "products.xlsx")
print(f"å¤„ç†äº† {result['records_count']} ä¸ªäº§å“")
```

## ğŸ§ª è¿è¡Œæµ‹è¯•

```bash
# å®‰è£…å¼€å‘ä¾èµ–
pip install -e ".[dev]"

# è¿è¡Œæµ‹è¯•
pytest tests/

# è¿è¡Œç¤ºä¾‹
python examples/basic_usage.py
```

## ğŸ“‹ ç³»ç»Ÿè¦æ±‚

* Python 3.8+
* pandas >= 2.0.0
* openpyxl >= 3.0.0

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ã€‚è¯¦æƒ…è¯·æŸ¥çœ‹ [LICENSE]() æ–‡ä»¶ã€‚

## ğŸ› é—®é¢˜åé¦ˆ

å¦‚æœæ‚¨é‡åˆ°ä»»ä½•é—®é¢˜æˆ–æœ‰åŠŸèƒ½å»ºè®®ï¼Œè¯·åœ¨ [GitHub Issues](https://github.com/quantatirsk/json_xlsx/issues) ä¸­æäº¤ã€‚

## ğŸ“ˆ æ›´æ–°æ—¥å¿—

### v0.0.7

* é¦–æ¬¡å‘å¸ƒ
* æ”¯æŒåµŒå¥—JSONæ‰å¹³åŒ–
* è‡ªåŠ¨Excelæ ¼å¼åŒ–
* å¤šå·¥ä½œè¡¨è¾“å‡º
* å®Œæ•´çš„æµ‹è¯•è¦†ç›–

## ğŸ™ è‡´è°¢

æ„Ÿè°¢æ‰€æœ‰ä¸ºè¿™ä¸ªé¡¹ç›®åšå‡ºè´¡çŒ®çš„å¼€å‘è€…ï¼

---

**json_xlsx** - è®©JSONè½¬Excelå˜å¾—ç®€å•é«˜æ•ˆï¼ ğŸš€
