Metadata-Version: 2.4
Name: json_xlsx
Version: 0.1.0
Summary: Convert nested JSON data to formatted Excel files
Project-URL: Homepage, https://github.com/quantatirsk/json_xlsx
Project-URL: Repository, https://github.com/quantatirsk/json_xlsx.git
Project-URL: Documentation, https://github.com/quantatirsk/json_xlsx#readme
Project-URL: Bug Tracker, https://github.com/quantatirsk/json_xlsx/issues
Author-email: Quant <pengzhia@gmail.com>
Maintainer-email: Quant <pengzhia@gmail.com>
License-Expression: MIT
License-File: LICENSE
Keywords: converter,data-processing,excel,json,openpyxl,pandas,xlsx
Classifier: Development Status :: 4 - Beta
Classifier: Intended Audience :: Developers
Classifier: License :: OSI Approved :: MIT License
Classifier: Operating System :: OS Independent
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3.8
Classifier: Programming Language :: Python :: 3.9
Classifier: Programming Language :: Python :: 3.10
Classifier: Programming Language :: Python :: 3.11
Classifier: Programming Language :: Python :: 3.12
Classifier: Topic :: Office/Business :: Office Suites
Classifier: Topic :: Software Development :: Libraries :: Python Modules
Classifier: Topic :: Utilities
Requires-Python: >=3.8
Requires-Dist: openpyxl>=3.0.0
Requires-Dist: pandas>=2.0.0
Provides-Extra: dev
Requires-Dist: black; extra == 'dev'
Requires-Dist: flake8; extra == 'dev'
Requires-Dist: mypy; extra == 'dev'
Requires-Dist: pytest-cov; extra == 'dev'
Requires-Dist: pytest>=6.0; extra == 'dev'
Provides-Extra: test
Requires-Dist: pytest-cov; extra == 'test'
Requires-Dist: pytest>=6.0; extra == 'test'
Description-Content-Type: text/markdown

# json_xlsx

[![PyPI version](https://badge.fury.io/py/json_xlsx.svg)](https://badge.fury.io/py/json_xlsx)
[![Python versions](https://img.shields.io/pypi/pyversions/json_xlsx.svg "3.8")](https://pypi.org/project/json_xlsx/)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)

ä¸€ä¸ªç®€å•æ˜“ç”¨çš„Pythonåº“ï¼Œç”¨äºå°†å¤æ‚çš„åµŒå¥—JSONæ•°æ®è½¬æ¢ä¸ºæ ¼å¼åŒ–çš„Excelæ–‡ä»¶ã€‚

## âœ¨ ç‰¹æ€§

* ğŸš€  **ç®€å•æ˜“ç”¨** : ä¸€è¡Œä»£ç å®ŒæˆJSONåˆ°Excelçš„è½¬æ¢
* ğŸ“Š  **æ™ºèƒ½æ‰å¹³åŒ–** : è‡ªåŠ¨å¤„ç†æ·±å±‚åµŒå¥—çš„JSONç»“æ„
* ğŸ¨  **ç²¾ç¾æ ¼å¼** : è‡ªåŠ¨åº”ç”¨ä¸“ä¸šçš„Excelæ ¼å¼å’Œæ ·å¼
* ğŸ“‹  **å¤šå·¥ä½œè¡¨** : åŒæ—¶ç”ŸæˆåŸå§‹æ•°æ®å’Œæ‰å¹³åŒ–æ•°æ®ä¸¤ä¸ªå·¥ä½œè¡¨
* ğŸ”§  **é«˜åº¦å¯é…ç½®** : æ”¯æŒè‡ªå®šä¹‰åˆ†éš”ç¬¦ã€æ·±åº¦é™åˆ¶ç­‰é…ç½®
* ğŸ“±  **æ•°ç»„å‹å¥½** : æ™ºèƒ½å¤„ç†å„ç§ç±»å‹çš„æ•°ç»„æ•°æ®
* ğŸŒ  **ä¸­æ–‡æ”¯æŒ** : å®Œç¾æ”¯æŒä¸­æ–‡å­—ç¬¦å’Œå†…å®¹

## ğŸ“¦ å®‰è£…

```bash
pip install json-xlsx
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### åŸºæœ¬ç”¨æ³•

```python
from json_xlsx import convert_json_to_excel

# å‡†å¤‡JSONæ•°æ®
data = [
    {
        "name": "å¼ ä¸‰",
        "age": 30,
        "address": {
            "city": "åŒ—äº¬",
            "district": "æµ·æ·€åŒº"
        },
        "skills": ["Python", "JavaScript"]
    },
    {
        "name": "æå››",
        "age": 25,
        "address": {
            "city": "ä¸Šæµ·", 
            "district": "æµ¦ä¸œæ–°åŒº"
        },
        "skills": ["Java", "Spring"]
    }
]

# è½¬æ¢ä¸ºExcel
result = convert_json_to_excel(data, "output.xlsx")

if result["success"]:
    print(f"è½¬æ¢æˆåŠŸï¼ç”Ÿæˆäº† {result['records_count']} æ¡è®°å½•")
else:
    print(f"è½¬æ¢å¤±è´¥: {result['error']}")
```

### é«˜çº§ç”¨æ³•

```python
from json_xlsx import JsonToExcelConverter

# è‡ªå®šä¹‰é…ç½®
config = {
    "separator": "_",           # ä½¿ç”¨ä¸‹åˆ’çº¿ä½œä¸ºå­—æ®µåˆ†éš”ç¬¦
    "max_depth": 10,           # æœ€å¤§é€’å½’æ·±åº¦
    "max_column_width": 80,    # æœ€å¤§åˆ—å®½
    'wrap_text': True,  # è‡ªåŠ¨æ¢è¡Œ
    'max_column_width': 100,  # æœ€å¤§åˆ—å®½
    'min_column_width': 12,  # æœ€å°åˆ—å®½
    'row_height_factor': 15,  # è¡Œé«˜ç³»æ•°
    'header_background_color': '005BAC',  # è¡¨å¤´èƒŒæ™¯è‰²
    'header_font_color': 'FFFFFF',  # è¡¨å¤´å­—ä½“é¢œè‰²
    'output_original_data': False, # æ˜¯å¦è¾“å‡ºåŸå§‹æ•°æ®
    'processed_sheet_name': 'data', # æ‰å¹³åŒ–æ•°æ®è¡¨å
    'original_sheet_name': 'source', # åŸå§‹æ•°æ®è¡¨å
}

# åˆ›å»ºè½¬æ¢å™¨
converter = JsonToExcelConverter(config)

# æ‰§è¡Œè½¬æ¢
result = converter.convert(data, "advanced_output.xlsx")
```

### å¤šç»„æ•°æ®è½¬æ¢+åˆå¹¶

```python
"""
æµ‹è¯•json_xlsxåº“çš„åŠŸèƒ½ï¼ŒåŒ…æ‹¬æ•°æ®è·å–ã€è½¬æ¢å’Œåˆå¹¶
"""

import requests
from json_xlsx import convert_json_to_excel, merge_sheets
from typing import List, Dict, Any

def fetch_recipe_data() -> Dict[str, Any]:
    """è·å–é£Ÿè°±æ•°æ®"""
    response = requests.get("https://dummyjson.com/recipes", timeout=10)
    return response.json().get(list(response.json().keys())[0])

def get_contract_data() -> List[Dict[str, Any]]:
    """è·å–åˆåŒæ•°æ®"""
    return [
        {
            "åˆåŒç¼–å·": "CONTRACT-2025-IT-001",
            "åˆåŒåç§°": "ä¼ä¸šæ•°å­—åŒ–è½¬å‹ç³»ç»Ÿå¼€å‘é¡¹ç›®",
            "åˆåŒç±»å‹": "æŠ€æœ¯å¼€å‘åˆåŒ",
            "ç­¾ç½²æ—¥æœŸ": "2025-06-01",
            "ç”Ÿæ•ˆæ—¥æœŸ": "2025-06-15",
            "åˆ°æœŸæ—¥æœŸ": "2026-12-31",
            "åˆåŒçŠ¶æ€": "æ‰§è¡Œä¸­",
            "åˆåŒé‡‘é¢": {
                "æ€»é‡‘é¢": 2800000.00,
                "å¸ç§": "äººæ°‘å¸",
                "ç¨ç‡": 0.06,
                "ç¨é¢": 168000.00,
                "å«ç¨æ€»é¢": 2968000.00,
            },
            "ç‰¹æ®Šæ¡æ¬¾": {
                "åˆ›æ–°æ¿€åŠ±": "è¾¾æˆå…³é”®é‡Œç¨‹ç¢‘å¯è·å¾—é¢å¤–å¥–é‡‘",
                "ç»©æ•ˆæŒ‡æ ‡": ["ç³»ç»Ÿå¯ç”¨æ€§>99.9%", "ç”¨æˆ·æ»¡æ„åº¦>95%"],
            },
        },
        {
            "åˆåŒç¼–å·": "CONTRACT-2025-PR-002",
            "åˆåŒåç§°": "åŠå…¬è®¾å¤‡åŠITç¡¬ä»¶é‡‡è´­åˆåŒ",
            "åˆåŒç±»å‹": "é‡‡è´­åˆåŒ",
            "ç­¾ç½²æ—¥æœŸ": "2025-06-05",
            "ç”Ÿæ•ˆæ—¥æœŸ": "2025-06-10",
            "åˆ°æœŸæ—¥æœŸ": "2025-12-31",
            "åˆåŒçŠ¶æ€": "æ‰§è¡Œä¸­",
            "åˆåŒé‡‘é¢": {
                "æ€»é‡‘é¢": 1560000.00,
                "å¸ç§": "äººæ°‘å¸",
                "ç¨ç‡": 0.13,
                "ç¨é¢": 202800.00,
                "å«ç¨æ€»é¢": 1762800.00,
            },
            "ç¯ä¿è¦æ±‚": {
                "èŠ‚èƒ½ç­‰çº§": "èƒ½æºä¹‹æ˜Ÿè®¤è¯",
                "ç¢³æ’æ”¾è¡¥å¿": "æ¯æ‰¹è®¾å¤‡æèµ ç¢³ä¿¡ç”¨",
                "å›æ”¶æ‰¿è¯º": "æä¾›å…è´¹è®¾å¤‡å›æ”¶æœåŠ¡",
            },
        },
        {
            "åˆåŒç¼–å·": "CONTRACT-2025-CO-003",
            "åˆåŒåç§°": "äº‘è®¡ç®—æœåŠ¡æ¡†æ¶åè®®",
            "åˆåŒç±»å‹": "æœåŠ¡åˆåŒ",
            "ç­¾ç½²æ—¥æœŸ": "2025-07-15",
            "ç”Ÿæ•ˆæ—¥æœŸ": "2025-08-01",
            "åˆ°æœŸæ—¥æœŸ": "2026-07-31",
            "åˆåŒçŠ¶æ€": "å¾…æ‰§è¡Œ",
            "åˆåŒé‡‘é¢": {
                "æ€»é‡‘é¢": 3600000.00,
                "å¸ç§": "äººæ°‘å¸",
                "ç¨ç‡": 0.09,
                "ç¨é¢": 324000.00,
                "å«ç¨æ€»é¢": 3924000.00,
            },
            "SLAæ€§èƒ½æŒ‡æ ‡": {
                "å¯ç”¨æ€§ä¿è¯": "99.99%",
                "å“åº”æ—¶é—´è¦æ±‚": "å¹³å‡<50æ¯«ç§’",
                "èµ”å¿æœºåˆ¶": "æœªè¾¾æ ‡æ‰£é™¤å½“æœˆæœåŠ¡è´¹20%",
            },
        },
        {
            "åˆåŒç¼–å·": "CONTRACT-2025-RE-004",
            "åˆåŒåç§°": "ç ”å‘åä½œä¸æŠ€æœ¯è®¸å¯åè®®",
            "åˆåŒç±»å‹": "æŠ€æœ¯è®¸å¯",
            "ç­¾ç½²æ—¥æœŸ": "2025-05-20",
            "ç”Ÿæ•ˆæ—¥æœŸ": "2025-06-01",
            "åˆ°æœŸæ—¥æœŸ": "2027-05-31",
            "åˆåŒçŠ¶æ€": "å®¡æ ¸ä¸­",
            "åˆåŒé‡‘é¢": {
                "æ€»é‡‘é¢": 1200000.00,
                "å¸ç§": "äººæ°‘å¸",
                "ç¨ç‡": 0.06,
                "ç¨é¢": 72000.00,
                "å«ç¨æ€»é¢": 1272000.00,
            },
            "çŸ¥è¯†äº§æƒæ¡æ¬¾": {
                "ä¸“åˆ©å…±äº«": "è”åˆç”³è¯·ä¸“åˆ©",
                "royaltyæ¯”ä¾‹": "é”€å”®é¢çš„5-8%",
                "æŠ€æœ¯ä¿å¯†": "ä¸¥æ ¼ä¿å¯†åè®®",
                "ä½¿ç”¨èŒƒå›´": "å…¨çƒèŒƒå›´å†…éç‹¬å è®¸å¯",
            },
        },
    ]

def get_sheet_configs(sheet_names: List[str]) -> List[Dict[str, str]]:
    """ç”Ÿæˆå·¥ä½œè¡¨é…ç½®"""
    return [{"processed_sheet_name": name} for name in sheet_names]

def main():
    # è·å–æ•°æ®
    recipe_data = fetch_recipe_data()
    contract_data = get_contract_data()
    all_data = [recipe_data, contract_data]

    # è®¾ç½®å·¥ä½œè¡¨åç§°å’Œé…ç½®
    sheet_names = ["RECIPE", "CONTRACT"]
    sheet_configs = get_sheet_configs(sheet_names)
    merged_file = "MERGED.xlsx"

    # è½¬æ¢æ•°æ®åˆ°Excel
    for data, name, config in zip(all_data, sheet_names, sheet_configs):
        result = convert_json_to_excel(data, f"{name}.xlsx", config)
        print(f"å·²ç”Ÿæˆæ–‡ä»¶: {result['output_path']}")

    # åˆå¹¶å·¥ä½œè¡¨
    excel_files = [f"{name}.xlsx" for name in sheet_names]
    merge_sheets(excel_files, merged_file)
    print(f"å·²åˆå¹¶æ–‡ä»¶: {merged_file}")

if __name__ == "__main__":
    main()

```

## ğŸ“Š è¾“å‡ºæ ¼å¼

è½¬æ¢åçš„Excelæ–‡ä»¶åŒ…å«ä¸¤ä¸ªå·¥ä½œè¡¨ï¼š

1. **å¯¹æ¯”æ•°æ®** : æ‰å¹³åŒ–åçš„ç»“æ„åŒ–æ•°æ®ï¼Œä¾¿äºåˆ†æå’Œå¤„ç†
2. **åŸå§‹æ•°æ®** : ä¿ç•™åŸå§‹JSONæ ¼å¼ï¼Œä¾¿äºè¿½æº¯å’ŒæŸ¥çœ‹

### æ‰å¹³åŒ–ç¤ºä¾‹

è¾“å…¥JSON:

```json
{
    "user": {
        "name": "å¼ ä¸‰",
        "contact": {
            "email": "zhangsan@example.com"
        }
    }
}
```

æ‰å¹³åŒ–ç»“æœ:

| user/name | user/contact/email   |
| --------- | -------------------- |
| å¼ ä¸‰      | zhangsan@example.com |

## âš™ï¸ é…ç½®é€‰é¡¹

```python
CONVERTER_CONFIG = {
    'max_depth': 10,  # æœ€å¤§é€’å½’æ·±åº¦
    'separator': '/',  # é”®ååˆ†éš”ç¬¦
    'array_format': 'formatted',  # æ•°ç»„æ ¼å¼åŒ–æ–¹å¼: 'formatted' æˆ– 'json'
    'auto_width': True,  # è‡ªåŠ¨è°ƒæ•´åˆ—å®½
    'wrap_text': True,  # è‡ªåŠ¨æ¢è¡Œ
    'max_column_width': 100,  # æœ€å¤§åˆ—å®½
    'min_column_width': 12,  # æœ€å°åˆ—å®½
    'row_height_factor': 15,  # è¡Œé«˜ç³»æ•°
    'header_background_color': '005BAC',  # è¡¨å¤´èƒŒæ™¯è‰²
    'header_font_color': 'FFFFFF',  # è¡¨å¤´å­—ä½“é¢œè‰²
    'output_original_data': False, # æ˜¯å¦è¾“å‡ºåŸå§‹æ•°æ®
    'processed_sheet_name': 'data', # æ‰å¹³åŒ–æ•°æ®è¡¨å
    'original_sheet_name': 'source', # åŸå§‹æ•°æ®è¡¨å
    'index_column_name': 'index', # ç´¢å¼•åˆ—å
    'json_column_name': 'json', # åŸå§‹æ•°æ®åˆ—å
}
```

## ğŸ”§ API å‚è€ƒ

### convert_json_to_excel(data, output_path, config=None)

ç®€åŒ–çš„è½¬æ¢å‡½æ•°ã€‚

**å‚æ•°:**

* `data`: JSONæ•°æ®ï¼ˆåˆ—è¡¨æˆ–å•ä¸ªå­—å…¸ï¼‰
* `output_path`: è¾“å‡ºExcelæ–‡ä»¶è·¯å¾„
* `config`: å¯é€‰çš„é…ç½®å­—å…¸

**è¿”å›:**
åŒ…å«è½¬æ¢ç»“æœçš„å­—å…¸

### JsonToExcelConverter

ä¸»è¦çš„è½¬æ¢å™¨ç±»ã€‚

**æ–¹æ³•:**

* `__init__(config=None)`: åˆå§‹åŒ–è½¬æ¢å™¨
* `convert(data, output_path, **kwargs)`: ç®€åŒ–çš„è½¬æ¢æ–¹æ³•
* `convert_to_excel(data, output_path, verbose=True)`: å®Œæ•´çš„è½¬æ¢æ–¹æ³•
* `flatten_dict(data, parent_key="", sep=None, depth=0)`: æ‰å¹³åŒ–å­—å…¸

## ğŸ“ ä½¿ç”¨ç¤ºä¾‹

### å¤„ç†å¤æ‚åµŒå¥—æ•°æ®

```python
complex_data = {
    "company": "ç§‘æŠ€å…¬å¸",
    "employees": [
        {
            "name": "å¼ ä¸‰",
            "position": "å·¥ç¨‹å¸ˆ",
            "skills": ["Python", "JavaScript"],
            "address": {
                "city": "åŒ—äº¬",
                "district": "æµ·æ·€åŒº"
            }
        }
    ],
    "financial": {
        "revenue": 1000000,
        "expenses": {
            "salary": 600000,
            "rent": 120000
        }
    }
}

convert_json_to_excel(complex_data, "company_data.xlsx")
```

### æ‰¹é‡å¤„ç†æ•°æ®

```python
# å¤„ç†å¤šæ¡è®°å½•
records = [
    {"id": 1, "name": "äº§å“A", "price": 99.99},
    {"id": 2, "name": "äº§å“B", "price": 149.99},
    {"id": 3, "name": "äº§å“C", "price": 199.99}
]

result = convert_json_to_excel(records, "products.xlsx")
print(f"å¤„ç†äº† {result['records_count']} ä¸ªäº§å“")
```

## ğŸ§ª è¿è¡Œæµ‹è¯•

```bash
# å®‰è£…å¼€å‘ä¾èµ–
pip install -e ".[dev]"

# è¿è¡Œæµ‹è¯•
pytest tests/

# è¿è¡Œç¤ºä¾‹
python examples/basic_usage.py
```

## ğŸ“‹ ç³»ç»Ÿè¦æ±‚

* Python 3.8+
* pandas >= 2.0.0
* openpyxl >= 3.0.0

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ã€‚è¯¦æƒ…è¯·æŸ¥çœ‹ [LICENSE]() æ–‡ä»¶ã€‚

## ğŸ› é—®é¢˜åé¦ˆ

å¦‚æœæ‚¨é‡åˆ°ä»»ä½•é—®é¢˜æˆ–æœ‰åŠŸèƒ½å»ºè®®ï¼Œè¯·åœ¨ [GitHub Issues](https://github.com/quantatirsk/json_xlsx/issues) ä¸­æäº¤ã€‚

## ğŸ“ˆ æ›´æ–°æ—¥å¿—

### v0.1.0

* æ”¯æŒåµŒå¥—JSONæ‰å¹³åŒ–
* è‡ªåŠ¨Excelæ ¼å¼åŒ–
* å®Œæ•´çš„æµ‹è¯•è¦†ç›–
* è‡ªå®šä¹‰æ ‡é¢˜è¡ŒèƒŒæ™¯/å­—ä½“é¢œè‰²
