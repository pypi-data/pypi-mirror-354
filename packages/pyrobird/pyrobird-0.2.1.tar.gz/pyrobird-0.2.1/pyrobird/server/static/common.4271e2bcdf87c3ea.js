"use strict";(self.webpackChunkfirebird=self.webpackChunkfirebird||[]).push([[2076],{230:(C,P,f)=>{f.r(P),f.d(P,{TF1Painter:()=>g,produceTAxisLogScale:()=>y,scanTF1Options:()=>o});var E=f(467),x=f(6998),O=f(9041),T=f(675),M=f(3277),l=f(2953),d=f(3693);function y(s,t,e,n){let a,r;n>0?(r=Math.log(n),a=e>0?Math.log(e):r-5):(r=-10,a=-15),s.fNbins=t,s.fXbins=new Array(t+1);for(let i=0;i<=t;++i)s.fXbins[i]=Math.exp(a+i/t*(r-a));s.fXmin=Math.exp(a),s.fXmax=Math.exp(r)}function o(s){(0,x.isStr)(s)||(s="");let t=s.indexOf(";webcanv_hist"),e=!1,n=0;return t>=0&&(e=!0,s=s.slice(0,t)),t=s.indexOf(";force_saved"),t>=0&&(n=2,s=s.slice(0,t)),t=s.indexOf(";prefer_saved"),t>=0&&(n=1,s=s.slice(0,t)),{opt:s,webcanv_hist:e,use_saved:n}}class g extends l.N{#t;getObjectName(){return this.$func?.fName??"func"}getClassName(){return this.$func?._typename??x.clTF1}isTF1(){return!0}isTF12(){return this.getClassName()===x.clTF12}getPrimaryObject(){return this.$func}updateObject(t){if(!t||this.getClassName()!==t._typename)return!1;delete t.evalPar;const e=this.getHisto();if(this.webcanv_hist){const n=this.getPadPainter()?.findInPrimitives("Func",x.clTH1D);n&&this.updateAxes(e,n,this.getFramePainter())}return this.$func=t,this.createTF1Histogram(t,e),this.scanContent(),!0}redraw(t){return!this.#t&&("logx"===t||"zoom"===t)&&(this.createTF1Histogram(this.$func,this.getHisto()),this.scanContent()),super.redraw(t)}createTF1Histogram(t,e){const n=this.getFramePainter(),a=this.getPadPainter()?.getRootPad(!0),r=a?.fLogx,i=n?.getGrFuncs(this.second_x,this.second_y);let m=t.fXmin,_=t.fXmax,u=Math.max(t.fNpx,100);if(i?.zoom_xmin!==i?.zoom_xmax){const c=(_-m)/u;m<i.zoom_xmin&&i.zoom_xmin<_&&(m=Math.max(m,i.zoom_xmin-c)),m<i.zoom_xmax&&i.zoom_xmax<_&&(_=Math.min(_,i.zoom_xmax+c))}this.#t=t.fSave.length>3&&(x.settings.PreferSavedPoints||this.use_saved>1);const p=c=>{e.fNcells!==c+2&&(e.fNcells=c+2,e.fArray=new Float32Array(e.fNcells)),e.fArray.fill(0),e.fXaxis.fNbins=c,e.fXaxis.fXbins=[]};if(delete this._fail_eval,!this.#t){let c=!1;if(!t.evalPar)try{this.isTF12()?(0,d.Dx)(t.fF2)?t.evalPar=function(h){return this.fCase?this.fF2.evalPar(h,this.fXY):this.fF2.evalPar(this.fXY,h)}:c=!0:(0,d.Dx)(t)||(c=!0)}catch{c=!0}p(u),r?y(e.fXaxis,u,m,_):(e.fXaxis.fXmin=m,e.fXaxis.fXmax=_);for(let h=0;h<u&&!c;h++){const v=e.fXaxis.GetBinCenter(h+1);let D=0;try{D=t.evalPar(v)}catch{c=!0}c||e.setBinContent(h+1,Number.isFinite(D)?D:0)}c&&(this._fail_eval=!0),c&&t.fSave.length>3&&(this.#t=!0)}if(this.#t){u=t.fSave.length-3;let c=null;if(m=t.fSave[u+1],_=t.fSave[u+2],m===_){const h=this.getMainPainter();(0,x.isFunc)(h?.getHisto)&&(c=h?.getHisto()?.fXaxis)}if(c){p(e.fXaxis.fNbins),Object.assign(e.fXaxis,c);for(let h=0;h<u;++h){const v=t.fSave[h];e.setBinContent(h+1,Number.isFinite(v)?v:0)}}else{p(t.fNpx),e.fXaxis.fXmin=t.fXmin,e.fXaxis.fXmax=t.fXmax;for(let h=0;h<t.fNpx;++h){const v=(0,d.YI)(t,e.fXaxis.GetBinCenter(h+1));e.setBinContent(h+1,Number.isFinite(v)?v:0)}}}e.fName="Func",(0,x.setHistogramTitle)(e,t.fTitle),e.fMinimum=t.fMinimum,e.fMaximum=t.fMaximum,e.fLineColor=t.fLineColor,e.fLineStyle=t.fLineStyle,e.fLineWidth=t.fLineWidth,e.fFillColor=t.fFillColor,e.fFillStyle=t.fFillStyle,e.fMarkerColor=t.fMarkerColor,e.fMarkerStyle=t.fMarkerStyle,e.fMarkerSize=t.fMarkerSize,e.fBits|=x.kNoStats}extractAxesProperties(t){super.extractAxesProperties(t);const e=this.$func,n=e?.fSave.length??0;n>3&&this.#t&&(this.xmin=Math.min(this.xmin,e.fSave[n-2]),this.xmax=Math.max(this.xmax,e.fSave[n-1])),e&&(this.xmin=Math.min(this.xmin,e.fXmin),this.xmax=Math.max(this.xmax,e.fXmax))}canZoomInside(t,e,n){const a=this.$func?.fSave.length??0;if(a>3&&this.#t&&"x"===t){const r=a-2;return Math.abs(this.$func.fSave[a-1]-this.$func.fSave[a-2])/r<Math.abs(n-e)}return"x"===t||"y"===t}getTF1Tooltips(t){delete this.$tmp_tooltip;const e=[this.getObjectHint()],n=this.getFramePainter()?.getGrFuncs(this.options.second_x,this.options.second_y);if(!n||!(0,x.isFunc)(this.$func?.evalPar))return e.push("grx = "+t.x,"gry = "+t.y),e;const a=n.revertAxis("x",t.x);let r=0,i=0,m=!1;try{r=this.$func.evalPar(a),i=Math.round(n.gry(r))}catch{m=!0}return e.push("x = "+n.axisAsText("x",a),"value = "+(m?"<fail>":(0,O.lg)(r,x.gStyle.fStatFormat))),m||(this.$tmp_tooltip={y:r,gry:i}),e}processTooltipEvent(t){if(this.#t)return super.processTooltipEvent(t);let e=this.draw_g?.selectChild(".tooltip_bin");if(!this.draw_g||!t)return e?.remove(),null;const n={name:this.$func?.fName,title:this.$func?.fTitle,x:t.x,y:t.y,color1:this.lineatt?.color??"green",color2:this.fillatt?.getFillColorAlt("blue")??"blue",lines:this.getTF1Tooltips(t),exact:!0,menu:!0};return t.disabled?e.remove():(e.empty()&&(e=this.draw_g.append("svg:circle").attr("class","tooltip_bin").style("pointer-events","none").style("fill","none").attr("r",(this.lineatt?.width??1)+4)),e.attr("cx",t.x).attr("cy",this.$tmp_tooltip.gry??t.y),this.lineatt&&e.call(this.lineatt.func)),n}fillWebObjectOptions(t){t.fcust=this._fail_eval&&!this.use_saved?"func_fail":""}static draw(t,e,n){return(0,E.A)(function*(){const a=o(n);let r;n=a.opt,delete a.opt,a.webcanv_hist&&(r=new T.JW(t).getPadPainter()?.findInPrimitives("Func",x.clTH1D)),r||(r=(0,x.createHistogram)(x.clTH1D,100),r.fBits|=x.kNoStats),!n&&(0,T.Nn)(t)&&(n="same");const i=new g(t,r);return i.$func=e,Object.assign(i,a),i.createTF1Histogram(e,r),M.mf._drawHist(i,n)})()}}},2695:(C,P,f)=>{f.r(P),f.d(P,{TLinePainter:()=>o});var E=f(467),x=f(6998),O=f(9041),T=f(675),M=f(9025),l=f(6714),d=f(6370);const y=(0,x.BIT)(14);class o extends T.JW{moveStart(s,t){const e=Math.sqrt((this.x1-this.x2)**2+(this.y1-this.y2)**2),n=Math.sqrt((s-this.x1)**2+(t-this.y1)**2)/e,a=Math.sqrt((s-this.x2)**2+(t-this.y2)**2)/e;this.side=n>.9?1:a>.9?-1:0}moveDrag(s,t){1!==this.side&&(this.x1+=s,this.y1+=t),-1!==this.side&&(this.x2+=s,this.y2+=t),this.draw_g.select("path").attr("d",this.createPath())}moveEnd(s){if(s)return;const t=this.getObject();let e="",n=this.svgToAxis("x",this.x1,this.isndc),a=this.svgToAxis("x",this.x2,this.isndc),r=this.svgToAxis("y",this.y1,this.isndc),i=this.svgToAxis("y",this.y2,this.isndc);this.swap_xy&&([n,r,a,i]=[r,n,i,a]),t.fX1=n,t.fX2=a,t.fY1=r,t.fY2=i,1!==this.side&&(e+=`SetX1(${n});;SetY1(${r});;`),-1!==this.side&&(e+=`SetX2(${a});;SetY2(${i});;`),this.submitCanvExec(e+"Notify();;")}getUserRanges(){const s=this.getObject();if(s.TestBit(y))return null;const e=Math.min(s.fX1,s.fX2),n=Math.max(s.fX1,s.fX2);return{minx:e,miny:Math.min(s.fY1,s.fY2),maxx:n,maxy:Math.max(s.fY1,s.fY2)}}prepareDraw(){const s=this.getObject();this.isndc=s.TestBit(y);const t=!this.isndc&&new O.nC(this.getDrawOpt()).check("FRAME");this.createG(t?"frame2d":void 0),this.swap_xy=t&&this.getFramePainter()?.swap_xy;const e=this.getAxisToSvgFunc(this.isndc,!0);this.x1=e.x(s.fX1),this.y1=e.y(s.fY1),this.x2=e.x(s.fX2),this.y2=e.y(s.fY2),this.swap_xy&&([this.x1,this.y1,this.x2,this.y2]=[this.y1,this.x1,this.y2,this.x2]),this.createAttLine({attr:s})}createPath(){const s=Math.round(this.x1),t=Math.round(this.x2),e=Math.round(this.y1),n=Math.round(this.y2);return`M${s},${e}`+(s===t?`V${n}`:e===n?`H${t}`:`L${t},${n}`)}addExtras(){}redraw(){this.prepareDraw();const s=this.draw_g.append("svg:path").attr("d",this.createPath()).call(this.lineatt.func);return this.getObject()?.$do_not_draw?s.remove():(this.addExtras(s),(0,l.X2)(this),(0,d.wh)(this)),this}static draw(s,t,e){return(0,E.A)(function*(){const n=new o(s,t,e);return(0,M.ensureTCanvas)(n,!1).then(()=>n.redraw())})()}}},9109:(C,P,f)=>{f.d(P,{Y:()=>T});var E=f(467),x=f(6998),O=f(3366);function T(){return M.apply(this,arguments)}function M(){return(M=(0,E.A)(function*(){const l=this.$fp||this.getFramePainter();if(delete this.$fp,!((0,x.isObject)(l)&&l.grx&&l.gry&&l.grz))return this;const d=this.getObject(),o=d.fP;let g=1,s=0;for(let i=0;i<o.length;i+=3)o[i]<l.scale_xmin||o[i]>l.scale_xmax||o[i+1]<l.scale_ymin||o[i+1]>l.scale_ymax||o[i+2]<l.scale_zmin||o[i+2]>l.scale_zmax||++s;x.settings.OptimizeDraw>0&&s>5e4&&(g=Math.floor(s/5e4),g<=2&&(g=2));const t=Math.floor(s/g),e=new O._l(t,l.webgl,l.size_x3d/100),n=new Int32Array(t);let a=0,r=0;for(let i=0;i<o.length;i+=3)o[i]<l.scale_xmin||o[i]>l.scale_xmax||o[i+1]<l.scale_ymin||o[i+1]>l.scale_ymax||o[i+2]<l.scale_zmin||o[i+2]>l.scale_zmax||g>1&&(a=(a+1)%g,0!==a)||(n[r++]=i,e.addPoint(l.grx(o[i]),l.gry(o[i+1]),l.grz(o[i+2])));return e.createPoints({color:this.getColor(d.fMarkerColor),style:d.fMarkerStyle}).then(i=>(i.tip_color=3===d.fMarkerColor?16711680:65280,i.tip_name=d.fName||"Poly3D",i.poly=d,i.fp=l,i.scale0=.7*e.scale,i.index=n,l.add3DMesh(i,this,!0),i.tooltip=function(m){let _=Math.floor(m.index/this.nvertex);if(_<0||_>=this.index.length)return null;_=this.index[_];const u=this.fp,p=u.grx(this.poly.fP[_]),c=u.gry(this.poly.fP[_+1]),h=u.grz(this.poly.fP[_+2]);return{x1:p-this.scale0,x2:p+this.scale0,y1:c-this.scale0,y2:c+this.scale0,z1:h-this.scale0,z2:h+this.scale0,color:this.tip_color,lines:[this.tip_name,"pnt: "+_/3,"x: "+u.axisAsText("x",this.poly.fP[_]),"y: "+u.axisAsText("y",this.poly.fP[_+1]),"z: "+u.axisAsText("z",this.poly.fP[_+2])]}},l.render3D(100),this))})).apply(this,arguments)}}}]);