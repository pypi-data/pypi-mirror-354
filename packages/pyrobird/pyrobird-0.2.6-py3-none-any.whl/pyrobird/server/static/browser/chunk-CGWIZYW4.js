import{b as c}from"./chunk-3GIRV5GZ.js";import"./chunk-O2YOIZWS.js";import"./chunk-C4APR3G7.js";import{d as S}from"./chunk-LWQ6XHU3.js";import{f as x}from"./chunk-YC5SGHGH.js";import"./chunk-D3GAWKNQ.js";import"./chunk-K2P6CES6.js";import"./chunk-Z4ZYSIRC.js";import"./chunk-3L3RRFVB.js";import{B as _,ea as d}from"./chunk-FVXVO67X.js";import{db as g,f as C,ib as M,qa as m}from"./chunk-KYOHYQWH.js";import{k as h}from"./chunk-KYPE3LET.js";var N=class P extends c{constructor(e,i){super(e,i),this._is_scatter=!0,this._not_adjust_hrange=!0}getGraph(){return this.getObject()?.fGraph}getHistRangeMargin(){return this.getObject()?.fMargin??.1}drawAxisHisto(){return h(this,null,function*(){let e=!this.getHistogram(),i=this.createHistogram(e,e);return S.draw(this.getDrawDom(),i,this.options.Axis+";IGNORE_PALETTE")})}getPalette(){let e=this.getGraph(),i=e?.fFunctions?.arr?.find(t=>t._typename===m);if(!i&&e){i=M(m);let t=this.get_main();Object.assign(i,{fX1NDC:t.fX2NDC+.005,fX2NDC:t.fX2NDC+.05,fY1NDC:t.fY1NDC,fY2NDC:t.fY2NDC,fInit:1,$can_move:!0}),Object.assign(i.fAxis,{fChopt:"+",fLineColor:1,fLineSyle:1,fLineWidth:1,fTextAngle:0,fTextAlign:11,fNdiv:510}),e.fFunctions.AddFirst(i,"")}return i}_updateMembers(e,i){return e.fBits=i.fBits,e.fTitle=i.fTitle,e.fNpoints=i.fNpoints,e.fColor=i.fColor,e.fSize=i.fSize,e.fMargin=i.fMargin,e.fMinMarkerSize=i.fMinMarkerSize,e.fMaxMarkerSize=i.fMaxMarkerSize,super._updateMembers(e.fGraph,i.fGraph)}getZaxis(){return this.getHistogram()?.fZaxis}canZoomInside(e,i,t){if(e!=="z")return super.canZoomInside(e,i,t);let f=this.fContour?.getLevels();if(!f)return!1;for(let s=0;s<f.length-1;++s)if(i<=f[s]&&t>=f[s+1])return!0;return!1}drawGraph(){return h(this,null,function*(){let e=this.get_main(),i=this.getMainPainter(),t=this.getObject(),f=this.getHistogram(),s=1,p=0;if(!e||!i||!t)return;if(t.fColor){let r=this.getPalette();r&&(r.$main_painter=this);let n=this.getPadPainter();!this._color_palette&&C(n?.getCustomPalette)&&(this._color_palette=n.getCustomPalette()),this._color_palette||(this._color_palette=_(this.options.Palette,n?.isGrayscale()));let o=t.fColor[0],a=t.fColor[0];for(let l=1;l<t.fColor.length;++l)o=Math.min(o,t.fColor[l]),a=Math.max(a,t.fColor[l]);a<=o?a=o<0?.9*o:o>0?1.1*o:1:o>0&&o<.3*a&&(o=0),this.fContour=new x(o,a),this.fContour.createNormal(30),this.fContour.configIndicies(0,0),e.zmin=o,e.zmax=a,!e.zoomChangedInteractive("z")&&f&&f.fMinimum!==g&&f.fMaximum!==g&&(e.zoom_zmin=f.fMinimum,e.zoom_zmax=f.fMaximum)}if(t.fSize){let r=t.fSize[0],n=t.fSize[0];for(let o=1;o<t.fSize.length;++o)r=Math.min(r,t.fSize[o]),n=Math.max(n,t.fSize[o]);n<=r&&(n=r<0?.9*r:r>0?1.1*r:1),s=(t.fMaxMarkerSize-t.fMinMarkerSize)/(n-r),p=r}this.createG(!e.pad_layer);let u=e.getGrFuncs(),k=e.zoom_zmin!==e.zoom_zmax&&t.fColor;for(let r=0;r<this.bins.length;++r){if(k&&(t.fColor[r]<e.zoom_zmin||t.fColor[r]>e.zoom_zmax))continue;let n=this.bins[r],o=u.grx(n.x),a=u.gry(n.y),l=t.fSize?t.fMinMarkerSize+s*(t.fSize[r]-p):t.fMarkerSize,y=t.fColor?this.fContour.getPaletteColor(this._color_palette,t.fColor[r]):this.getColor(t.fMarkerColor),z=new d({color:y,size:l,style:t.fMarkerStyle});this.draw_g.append("svg:path").attr("d",z.create(o,a)).call(z.func)}return this})}static draw(e,i,t){return h(this,null,function*(){return c._drawGraph(new P(e,i),t)})}};export{N as TScatterPainter};
