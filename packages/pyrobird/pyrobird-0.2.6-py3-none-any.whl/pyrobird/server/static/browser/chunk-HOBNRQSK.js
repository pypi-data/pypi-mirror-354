import{e as o}from"./chunk-K5ZYKRKV.js";import"./chunk-RUOSGH3Z.js";import{b as u}from"./chunk-O2YOIZWS.js";import"./chunk-C4APR3G7.js";import"./chunk-YC5SGHGH.js";import"./chunk-D3GAWKNQ.js";import"./chunk-K2P6CES6.js";import"./chunk-Z4ZYSIRC.js";import"./chunk-3L3RRFVB.js";import{I as f,ha as m}from"./chunk-FVXVO67X.js";import{d as h}from"./chunk-KYOHYQWH.js";import{k as n}from"./chunk-KYPE3LET.js";var c=class a extends m{redraw(){this.step===void 0&&this.startDrawing()}decodeOptions(i){let t=new f(i||"REPEAT");this.options||(this.options={}),Object.assign(this.options,{once:t.check("ONCE"),repeat:t.check("REPEAT"),first:t.check("FIRST")}),this.storeDrawOpt(i)}drawPrimitives(i){return n(this,null,function*(){i||(i=0,this._doing_primitives=!0);let t=this.getObject()?.fSteps.arr[this.step];if(!t||i>=t.arr.length){delete this._doing_primitives;return}return o(this.getPadPainter(),t.arr[i],t.opt[i]).then(e=>(e&&(e.$grtimeid=this.selfid,e.$grstep=this.step),this.drawPrimitives(i+1)))})}continueDrawing(){if(!this.options)return;let i=this.getObject();if(this.options.first){delete this.step;return}if(this.wait_animation_frame){delete this.wait_animation_frame;let t=this.getPadPainter();if(!t){delete this.step;return}this.drawPrimitives().then(()=>{t.cleanPrimitives(e=>e.$grtimeid===this.selfid&&e.$grstep!==this.step),this.continueDrawing()})}else if(this.running_timeout)clearTimeout(this.running_timeout),delete this.running_timeout,this.wait_animation_frame=!0,requestAnimationFrame(()=>this.continueDrawing());else{let t=Math.max(i.fSleepTime,10);if(++this.step>i.fSteps.arr.length)if(this.options.repeat)this.step=0,t=Math.max(5e3,5*t);else{delete this.step;return}this.running_timeout=setTimeout(()=>this.continueDrawing(),t)}}startDrawing(){return this.step=0,this.drawPrimitives().then(()=>(this.continueDrawing(),this))}static draw(i,t,e){return n(this,null,function*(){if(!t.fFrame)return console.error("Frame histogram not exists"),null;let r=new a(i,t);if(r.getMainPainter())return console.error("Cannot draw graph time on top of other histograms"),null;if(r.decodeOptions(e),!t.fFrame.fTitle&&t.fTitle){let s=t.fTitle.split(";");t.fFrame.fTitle=s[0],s[1]&&(t.fFrame.fXaxis.fTitle=s[1]),s[2]&&(t.fFrame.fYaxis.fTitle=s[2])}return r.selfid="grtime_"+h.id_counter++,u.draw(i,t.fFrame,"").then(()=>(r.addToPadPrimitives(),r.startDrawing()))})}};function _(a,i){return n(this,null,function*(){return o(a,i._hist,"hist").then(t=>n(null,null,function*(){let e=[];for(let r=0;r<i._items.arr.length;++r)e.push(o(a,i._items.arr[r],i._items.opt[r]));return Promise.all(e).then(()=>t)}))})}export{c as TGraphTimePainter,_ as drawRooPlot};
