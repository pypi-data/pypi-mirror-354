import{a as Y,b as H}from"./chunk-BMJ6ZVV2.js";import{a as z}from"./chunk-H6ALVAPY.js";import{a as U}from"./chunk-QVRPMYCM.js";import{f as G}from"./chunk-KYPE3LET.js";var se=G((de,o)=>{var i=U(),D=Y(),s=z(),R=H(),d={fs:i.constants,os:D.constants},k="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",w=/XXXXXX/,P=3,A=(d.O_CREAT||d.fs.O_CREAT)|(d.O_EXCL||d.fs.O_EXCL)|(d.O_RDWR||d.fs.O_RDWR),J=D.platform()==="win32",K=d.EBADF||d.os.errno.EBADF,Q=d.ENOENT||d.os.errno.ENOENT,T=448,F=384,V="exit",p=[],I=i.rmdirSync.bind(i),$=!1;function Z(e,r){return i.rm(e,{recursive:!0},r)}function j(e){return i.rmSync(e,{recursive:!0})}function S(e,r){let t=_(e,r),n=t[0],c=t[1];try{q(n)}catch(f){return c(f)}let a=n.tries;(function f(){try{let u=B(n);i.stat(u,function(m){if(!m)return a-- >0?f():c(new Error("Could not get a unique tmp filename, max tries reached "+u));c(null,u)})}catch(u){c(u)}})()}function x(e){let r=_(e),t=r[0];q(t);let n=t.tries;do{let c=B(t);try{i.statSync(c)}catch{return c}}while(n-- >0);throw new Error("Could not get a unique tmp filename, max tries reached")}function ee(e,r){let t=_(e,r),n=t[0],c=t[1];S(n,function(f,u){if(f)return c(f);i.open(u,A,n.mode||F,function(E,C){if(E)return c(E);if(n.discardDescriptor)return i.close(C,function(M){return c(M,u,void 0,y(u,-1,n,!1))});{let O=n.discardDescriptor||n.detachDescriptor;c(null,u,C,y(u,O?-1:C,n,!1))}})})}function re(e){let r=_(e),t=r[0],n=t.discardDescriptor||t.detachDescriptor,c=x(t);var a=i.openSync(c,A,t.mode||F);return t.discardDescriptor&&(i.closeSync(a),a=void 0),{name:c,fd:a,removeCallback:y(c,n?-1:a,t,!0)}}function te(e,r){let t=_(e,r),n=t[0],c=t[1];S(n,function(f,u){if(f)return c(f);i.mkdir(u,n.mode||T,function(E){if(E)return c(E);c(null,u,X(u,n,!1))})})}function ne(e){let r=_(e),t=r[0],n=x(t);return i.mkdirSync(n,t.mode||T),{name:n,removeCallback:X(n,t,!0)}}function ce(e,r){let t=function(n){if(n&&!N(n))return r(n);r()};0<=e[0]?i.close(e[0],function(){i.unlink(e[1],t)}):i.unlink(e[1],t)}function ie(e){let r=null;try{0<=e[0]&&i.closeSync(e[0])}catch(t){if(!le(t)&&!N(t))throw t}finally{try{i.unlinkSync(e[1])}catch(t){N(t)||(r=t)}}if(r!==null)throw r}function y(e,r,t,n){let c=h(ie,[r,e],n),a=h(ce,[r,e],n,c);return t.keep||p.unshift(c),n?c:a}function X(e,r,t){let n=r.unsafeCleanup?Z:i.rmdir.bind(i),c=r.unsafeCleanup?j:I,a=h(c,e,t),f=h(n,e,t,a);return r.keep||p.unshift(a),t?a:f}function h(e,r,t,n){let c=!1;return function a(f){if(!c){let u=n||a,m=p.indexOf(u);return m>=0&&p.splice(m,1),c=!0,t||e===I||e===j?e(r):e(r,f||function(){})}}}function ae(){if($)for(;p.length;)try{p[0]()}catch{}}function g(e){let r=[],t=null;try{t=R.randomBytes(e)}catch{t=R.pseudoRandomBytes(e)}for(var n=0;n<e;n++)r.push(k[t[n]%k.length]);return r.join("")}function ue(e){return e===null||l(e)||!e.trim()}function l(e){return typeof e>"u"}function _(e,r){if(typeof e=="function")return[{},e];if(l(e))return[{},r];let t={};for(let n of Object.getOwnPropertyNames(e))t[n]=e[n];return[t,r]}function B(e){let r=e.tmpdir;if(!l(e.name))return s.join(r,e.dir,e.name);if(!l(e.template))return s.join(r,e.dir,e.template).replace(w,g(6));let t=[e.prefix?e.prefix:"tmp","-",process.pid,"-",g(12),e.postfix?"-"+e.postfix:""].join("");return s.join(r,e.dir,t)}function q(e){e.tmpdir=W(e);let r=e.tmpdir;if(l(e.name)||v(e.name,"name",r),l(e.dir)||v(e.dir,"dir",r),!l(e.template)&&(v(e.template,"template",r),!e.template.match(w)))throw new Error(`Invalid template, found "${e.template}".`);if(!l(e.tries)&&isNaN(e.tries)||e.tries<0)throw new Error(`Invalid tries, found "${e.tries}".`);e.tries=l(e.name)?e.tries||P:1,e.keep=!!e.keep,e.detachDescriptor=!!e.detachDescriptor,e.discardDescriptor=!!e.discardDescriptor,e.unsafeCleanup=!!e.unsafeCleanup,e.dir=l(e.dir)?"":s.relative(r,b(e.dir,r)),e.template=l(e.template)?void 0:s.relative(r,b(e.template,r)),e.template=ue(e.template)?void 0:s.relative(e.dir,e.template),e.name=l(e.name)?void 0:e.name,e.prefix=l(e.prefix)?"":e.prefix,e.postfix=l(e.postfix)?"":e.postfix}function b(e,r){return e.startsWith(r)?s.resolve(e):s.resolve(s.join(r,e))}function v(e,r,t){if(r==="name"){if(s.isAbsolute(e))throw new Error(`${r} option must not contain an absolute path, found "${e}".`);let n=s.basename(e);if(n===".."||n==="."||n!==e)throw new Error(`${r} option must not contain a path, found "${e}".`)}else{if(s.isAbsolute(e)&&!e.startsWith(t))throw new Error(`${r} option must be relative to "${t}", found "${e}".`);let n=b(e,t);if(!n.startsWith(t))throw new Error(`${r} option must be relative to "${t}", found "${n}".`)}}function le(e){return L(e,-K,"EBADF")}function N(e){return L(e,-Q,"ENOENT")}function L(e,r,t){return J?e.code===t:e.code===t&&e.errno===r}function fe(){$=!0}function W(e){return s.resolve(e&&e.tmpdir||D.tmpdir())}process.addListener(V,ae);Object.defineProperty(o.exports,"tmpdir",{enumerable:!0,configurable:!1,get:function(){return W()}});o.exports.dir=te;o.exports.dirSync=ne;o.exports.file=ee;o.exports.fileSync=re;o.exports.tmpName=S;o.exports.tmpNameSync=x;o.exports.setGracefulCleanup=fe});export default se();
