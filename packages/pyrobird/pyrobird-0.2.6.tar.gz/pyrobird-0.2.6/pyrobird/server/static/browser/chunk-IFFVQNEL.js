import{b as d}from"./chunk-Z4ZYSIRC.js";import"./chunk-3L3RRFVB.js";import{Aa as l,I as n,Ja as y,T as f,b as r,e as c,ha as x}from"./chunk-FVXVO67X.js";import"./chunk-KYOHYQWH.js";import{k as o}from"./chunk-KYPE3LET.js";var _=class g extends x{moveStart(t,s){let i=Math.abs(this.x2-this.x1),h=Math.abs(this.y1-this.y2);this.c_x1=Math.abs(t-this.x2)>i*.1,this.c_x2=Math.abs(t-this.x1)>i*.1,this.c_y1=Math.abs(s-this.y2)>h*.1,this.c_y2=Math.abs(s-this.y1)>h*.1,this.c_x1!==this.c_x2&&this.c_y1&&this.c_y2&&(this.c_y1=this.c_y2=!1),this.c_y1!==this.c_y2&&this.c_x1&&this.c_x2&&(this.c_x1=this.c_x2=!1)}moveDrag(t,s){this.c_x1&&(this.x1+=t),this.c_x2&&(this.x2+=t),this.c_y1&&(this.y1+=s),this.c_y2&&(this.y2+=s);let i=this.draw_g.selectAll("path").nodes();this.getPathes().forEach((a,e)=>c(i[e]).attr("d",a))}moveEnd(t){if(t)return;let s=this.getObject(),i=this.swap_xy?"Y":"X",h=this.swap_xy?"X":"Y",a="";if(this.c_x1){let e=this.svgToAxis("x",this.x1);s[`f${i}1`]=e,a+=`Set${i}1(${e});;`}if(this.c_x2){let e=this.svgToAxis("x",this.x2);s[`f${i}2`]=e,a+=`Set${i}2(${e});;`}if(this.c_y1){let e=this.svgToAxis("y",this.y1);s[`f${h}1`]=e,a+=`Set${h}1(${e});;`}if(this.c_y2){let e=this.svgToAxis("y",this.y2);s[`f${h}2`]=e,a+=`Set${h}2(${e});;`}this.submitCanvExec(a+"Notify();;")}getUserRanges(){let t=this.getObject(),s=Math.min(t.fX1,t.fX2),i=Math.max(t.fX1,t.fX2),h=Math.min(t.fY1,t.fY2),a=Math.max(t.fY1,t.fY2);return{minx:s,miny:h,maxx:i,maxy:a}}getPathes(){let t=Math.round(Math.min(this.x1,this.x2)),s=Math.round(Math.min(this.y1,this.y2)),i=Math.round(Math.abs(this.x2-this.x1)),h=Math.round(Math.abs(this.y1-this.y2)),a=`M${t},${s}h${i}v${h}h${-i}z`;return this.borderMode?[a].concat(f(t,s,i,h,this.borderMode,this.borderSize,this.borderSize)):[a]}redraw(){let t=this.getObject(),s=new n(this.getDrawOpt()),i=s.check("FRAME")?this.getFramePainter():null,h=s.check("L");this.createAttLine({attr:t}),this.createAttFill({attr:t}),this.swap_xy=i?.swap_xy,!this.fillatt.empty()&&!h&&(this.lineatt.color="none"),this.createG(i),this.x1=this.axisToSvg("x",t.fX1),this.x2=this.axisToSvg("x",t.fX2),this.y1=this.axisToSvg("y",t.fY1),this.y2=this.axisToSvg("y",t.fY2),this.swap_xy&&([this.x1,this.x2,this.y1,this.y2]=[this.y1,this.y2,this.x1,this.x2]),this.borderMode=t.fBorderMode&&this.fillatt.hasColor()?t.fBorderMode:0,this.borderSize=t.fBorderSize||2;let a=this.getPathes();return this.draw_g.append("svg:path").attr("d",a[0]).call(this.lineatt.func).call(this.fillatt.func),this.borderMode&&(this.draw_g.append("svg:path").attr("d",a[1]).call(this.fillatt.func).style("fill",r(this.fillatt.color).brighter(.5).formatRgb()),this.draw_g.append("svg:path").attr("d",a[2]).call(this.fillatt.func).style("fill",r(this.fillatt.color).darker(.5).formatRgb())),y(this),l(this),this}static draw(t,s,i){return o(this,null,function*(){let h=new g(t,s,i);return d(h,!1).then(()=>h.redraw())})}};export{_ as TBoxPainter};
