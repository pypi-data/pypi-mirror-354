import{bg as de,r as w,I as X,j as r,T as he,S as fe,B as F,u as ee,h as te,k as z,_ as ae}from"./index-8XHELRgY.js";import{a as me,M as ye,b as pe,R as xe,A as $e,c as ve,d as ge,P as je,S as we}from"./keychain.query-BhrEpdJ9.js";import{I as W,F as R}from"./index-BcGlvgPm.js";import{C as Me,R as ke,E as Se,a as be}from"./CloseOutlined-DoeT0fGR.js";var Z={exports:{}},_e=Z.exports,ie;function De(){return ie||(ie=1,function(o,u){(function(h,d){o.exports=d()})(_e,function(){var h=1e3,d=6e4,g=36e5,x="millisecond",S="second",l="minute",b="hour",M="day",_="week",y="month",E="quarter",O="year",K="date",ne="Invalid Date",ce=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,oe=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,ue={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(a){var n=["th","st","nd","rd"],e=a%100;return"["+a+(n[(e-20)%10]||n[e]||n[0])+"]"}},B=function(a,n,e){var s=String(a);return!s||s.length>=n?a:""+Array(n+1-s.length).join(e)+a},le={s:B,z:function(a){var n=-a.utcOffset(),e=Math.abs(n),s=Math.floor(e/60),t=e%60;return(n<=0?"+":"-")+B(s,2,"0")+":"+B(t,2,"0")},m:function a(n,e){if(n.date()<e.date())return-a(e,n);var s=12*(e.year()-n.year())+(e.month()-n.month()),t=n.clone().add(s,y),i=e-t<0,c=n.clone().add(s+(i?-1:1),y);return+(-(s+(e-t)/(i?t-c:c-t))||0)},a:function(a){return a<0?Math.ceil(a)||0:Math.floor(a)},p:function(a){return{M:y,y:O,w:_,d:M,D:K,h:b,m:l,s:S,ms:x,Q:E}[a]||String(a||"").toLowerCase().replace(/s$/,"")},u:function(a){return a===void 0}},V="en",H={};H[V]=ue;var se="$isDayjsObject",Q=function(a){return a instanceof L||!(!a||!a[se])},q=function a(n,e,s){var t;if(!n)return V;if(typeof n=="string"){var i=n.toLowerCase();H[i]&&(t=i),e&&(H[i]=e,t=i);var c=n.split("-");if(!t&&c.length>1)return a(c[0])}else{var m=n.name;H[m]=n,t=m}return!s&&t&&(V=t),t||!s&&V},$=function(a,n){if(Q(a))return a.clone();var e=typeof n=="object"?n:{};return e.date=a,e.args=arguments,new L(e)},f=le;f.l=q,f.i=Q,f.w=function(a,n){return $(a,{locale:n.$L,utc:n.$u,x:n.$x,$offset:n.$offset})};var L=function(){function a(e){this.$L=q(e.locale,null,!0),this.parse(e),this.$x=this.$x||e.x||{},this[se]=!0}var n=a.prototype;return n.parse=function(e){this.$d=function(s){var t=s.date,i=s.utc;if(t===null)return new Date(NaN);if(f.u(t))return new Date;if(t instanceof Date)return new Date(t);if(typeof t=="string"&&!/Z$/i.test(t)){var c=t.match(ce);if(c){var m=c[2]-1||0,p=(c[7]||"0").substring(0,3);return i?new Date(Date.UTC(c[1],m,c[3]||1,c[4]||0,c[5]||0,c[6]||0,p)):new Date(c[1],m,c[3]||1,c[4]||0,c[5]||0,c[6]||0,p)}}return new Date(t)}(e),this.init()},n.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},n.$utils=function(){return f},n.isValid=function(){return this.$d.toString()!==ne},n.isSame=function(e,s){var t=$(e);return this.startOf(s)<=t&&t<=this.endOf(s)},n.isAfter=function(e,s){return $(e)<this.startOf(s)},n.isBefore=function(e,s){return this.endOf(s)<$(e)},n.$g=function(e,s,t){return f.u(e)?this[s]:this.set(t,e)},n.unix=function(){return Math.floor(this.valueOf()/1e3)},n.valueOf=function(){return this.$d.getTime()},n.startOf=function(e,s){var t=this,i=!!f.u(s)||s,c=f.p(e),m=function(N,k){var C=f.w(t.$u?Date.UTC(t.$y,k,N):new Date(t.$y,k,N),t);return i?C:C.endOf(M)},p=function(N,k){return f.w(t.toDate()[N].apply(t.toDate("s"),(i?[0,0,0,0]:[23,59,59,999]).slice(k)),t)},v=this.$W,j=this.$M,D=this.$D,T="set"+(this.$u?"UTC":"");switch(c){case O:return i?m(1,0):m(31,11);case y:return i?m(1,j):m(0,j+1);case _:var I=this.$locale().weekStart||0,Y=(v<I?v+7:v)-I;return m(i?D-Y:D+(6-Y),j);case M:case K:return p(T+"Hours",0);case b:return p(T+"Minutes",1);case l:return p(T+"Seconds",2);case S:return p(T+"Milliseconds",3);default:return this.clone()}},n.endOf=function(e){return this.startOf(e,!1)},n.$set=function(e,s){var t,i=f.p(e),c="set"+(this.$u?"UTC":""),m=(t={},t[M]=c+"Date",t[K]=c+"Date",t[y]=c+"Month",t[O]=c+"FullYear",t[b]=c+"Hours",t[l]=c+"Minutes",t[S]=c+"Seconds",t[x]=c+"Milliseconds",t)[i],p=i===M?this.$D+(s-this.$W):s;if(i===y||i===O){var v=this.clone().set(K,1);v.$d[m](p),v.init(),this.$d=v.set(K,Math.min(this.$D,v.daysInMonth())).$d}else m&&this.$d[m](p);return this.init(),this},n.set=function(e,s){return this.clone().$set(e,s)},n.get=function(e){return this[f.p(e)]()},n.add=function(e,s){var t,i=this;e=Number(e);var c=f.p(s),m=function(j){var D=$(i);return f.w(D.date(D.date()+Math.round(j*e)),i)};if(c===y)return this.set(y,this.$M+e);if(c===O)return this.set(O,this.$y+e);if(c===M)return m(1);if(c===_)return m(7);var p=(t={},t[l]=d,t[b]=g,t[S]=h,t)[c]||1,v=this.$d.getTime()+e*p;return f.w(v,this)},n.subtract=function(e,s){return this.add(-1*e,s)},n.format=function(e){var s=this,t=this.$locale();if(!this.isValid())return t.invalidDate||ne;var i=e||"YYYY-MM-DDTHH:mm:ssZ",c=f.z(this),m=this.$H,p=this.$m,v=this.$M,j=t.weekdays,D=t.months,T=t.meridiem,I=function(k,C,A,P){return k&&(k[C]||k(s,i))||A[C].slice(0,P)},Y=function(k){return f.s(m%12||12,k,"0")},N=T||function(k,C,A){var P=k<12?"AM":"PM";return A?P.toLowerCase():P};return i.replace(oe,function(k,C){return C||function(A){switch(A){case"YY":return String(s.$y).slice(-2);case"YYYY":return f.s(s.$y,4,"0");case"M":return v+1;case"MM":return f.s(v+1,2,"0");case"MMM":return I(t.monthsShort,v,D,3);case"MMMM":return I(D,v);case"D":return s.$D;case"DD":return f.s(s.$D,2,"0");case"d":return String(s.$W);case"dd":return I(t.weekdaysMin,s.$W,j,2);case"ddd":return I(t.weekdaysShort,s.$W,j,3);case"dddd":return j[s.$W];case"H":return String(m);case"HH":return f.s(m,2,"0");case"h":return Y(1);case"hh":return Y(2);case"a":return N(m,p,!0);case"A":return N(m,p,!1);case"m":return String(p);case"mm":return f.s(p,2,"0");case"s":return String(s.$s);case"ss":return f.s(s.$s,2,"0");case"SSS":return f.s(s.$ms,3,"0");case"Z":return c}return null}(k)||c.replace(":","")})},n.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},n.diff=function(e,s,t){var i,c=this,m=f.p(s),p=$(e),v=(p.utcOffset()-this.utcOffset())*d,j=this-p,D=function(){return f.m(c,p)};switch(m){case O:i=D()/12;break;case y:i=D();break;case E:i=D()/3;break;case _:i=(j-v)/6048e5;break;case M:i=(j-v)/864e5;break;case b:i=j/g;break;case l:i=j/d;break;case S:i=j/h;break;default:i=j}return t?i:f.a(i)},n.daysInMonth=function(){return this.endOf(y).$D},n.$locale=function(){return H[this.$L]},n.locale=function(e,s){if(!e)return this.$L;var t=this.clone(),i=q(e,s,!0);return i&&(t.$L=i),t},n.clone=function(){return f.w(this.$d,this)},n.toDate=function(){return new Date(this.valueOf())},n.toJSON=function(){return this.isValid()?this.toISOString():null},n.toISOString=function(){return this.$d.toISOString()},n.toString=function(){return this.$d.toUTCString()},a}(),re=L.prototype;return $.prototype=re,[["$ms",x],["$s",S],["$m",l],["$H",b],["$W",M],["$M",y],["$y",O],["$D",K]].forEach(function(a){re[a[1]]=function(n){return this.$g(n,a[0],a[1])}}),$.extend=function(a,n){return a.$i||(a(n,L,$),a.$i=!0),$},$.locale=q,$.isDayjs=Q,$.unix=function(a){return $(1e3*a)},$.en=H[V],$.Ls=H,$.p={},$})}(Z)),Z.exports}var Oe=De();const Ce=de(Oe);var He={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M686.7 638.6L544.1 535.5V288c0-4.4-3.6-8-8-8H488c-4.4 0-8 3.6-8 8v275.4c0 2.6 1.2 5 3.3 6.5l165.4 120.6c3.6 2.6 8.6 1.8 11.2-1.7l28.6-39c2.6-3.7 1.8-8.7-1.8-11.2z"}}]},name:"clock-circle",theme:"outlined"},Ie={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M904 512h-56c-4.4 0-8 3.6-8 8v320H184V184h320c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V520c0-4.4-3.6-8-8-8z"}},{tag:"path",attrs:{d:"M355.9 534.9L354 653.8c-.1 8.9 7.1 16.2 16 16.2h.4l118-2.9c2-.1 4-.9 5.4-2.3l415.9-415c3.1-3.1 3.1-8.2 0-11.3L785.4 114.3c-1.6-1.6-3.6-2.3-5.7-2.3s-4.1.8-5.7 2.3l-415.8 415a8.3 8.3 0 00-2.3 5.6zm63.5 23.6L779.7 199l45.2 45.1-360.5 359.7-45.7 1.1.7-46.4z"}}]},name:"form",theme:"outlined"};function U(){return U=Object.assign?Object.assign.bind():function(o){for(var u=1;u<arguments.length;u++){var h=arguments[u];for(var d in h)Object.prototype.hasOwnProperty.call(h,d)&&(o[d]=h[d])}return o},U.apply(this,arguments)}const Ne=(o,u)=>w.createElement(X,U({},o,{ref:u,icon:Me})),Ke=w.forwardRef(Ne);function J(){return J=Object.assign?Object.assign.bind():function(o){for(var u=1;u<arguments.length;u++){var h=arguments[u];for(var d in h)Object.prototype.hasOwnProperty.call(h,d)&&(o[d]=h[d])}return o},J.apply(this,arguments)}const Te=(o,u)=>w.createElement(X,J({},o,{ref:u,icon:He})),Fe=w.forwardRef(Te);function G(){return G=Object.assign?Object.assign.bind():function(o){for(var u=1;u<arguments.length;u++){var h=arguments[u];for(var d in h)Object.prototype.hasOwnProperty.call(h,d)&&(o[d]=h[d])}return o},G.apply(this,arguments)}const Ve=(o,u)=>w.createElement(X,G({},o,{ref:u,icon:Ie})),Ye=w.forwardRef(Ve),Ae=o=>w.createElement("svg",{width:"1em",height:"1em",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",...o},w.createElement("path",{d:"M5.01415 2.0835C4.55392 2.0835 4.18082 2.45659 4.18082 2.91683V5.62578H2.91414C2.45391 5.62578 2.08081 5.99887 2.08081 6.45911V17.0835C2.08081 17.5438 2.45391 17.9169 2.91414 17.9169H13.5417C14.0019 17.9169 14.375 17.5438 14.375 17.0835V15.7735H17.0856C17.5458 15.7735 17.9189 15.4004 17.9189 14.9401V2.91683C17.9189 2.45659 17.5458 2.0835 17.0856 2.0835H5.01415ZM14.375 14.1068V6.45911C14.375 5.99887 14.0019 5.62578 13.5417 5.62578H5.84748V3.75016H16.2523V14.1068H14.375ZM3.74747 16.2502V7.29244H12.7084V16.2502H3.74747Z",fill:"currentColor"}));function Re({value:o,onChange:u,onEditableChange:h}){const[d,g]=w.useState(!1),[x,S]=w.useState(o),l=w.useCallback(_=>{h==null||h(_),g(_)},[h]),b=w.useMemo(()=>typeof o!="string"?"":d?r.jsxs(fe.Compact,{className:"w-full",children:[r.jsx(W,{value:x,onChange:_=>S(_.target.value),onPressEnter:async()=>{await(u==null?void 0:u(x)),l(!1)}}),r.jsx(F,{className:"!text-[var(--color-success)]",icon:r.jsx(Ke,{}),onClick:async()=>{await(u==null?void 0:u(x)),l(!1)}}),r.jsx(F,{icon:r.jsx(ke,{}),onClick:()=>{l(!1)}})]}):r.jsx(he,{title:o,children:r.jsx("span",{className:"text-ellipsis max-w-[120px] overflow-hidden",children:o})}),[d,l,u,x,o]),M=()=>{l(!d)};return r.jsxs("div",{className:"flex items-center gap-2",children:[b,!d&&r.jsx(F,{type:"text",size:"small",icon:r.jsx(Ye,{}),onClick:M})]})}function Ee({modalFormRef:o,onClose:u}){const[h,d]=w.useState(!1),[g]=R.useForm(),x=ee(),{mutateAsync:S}=me(),{t:l}=te();w.useImperativeHandle(o,()=>({open:()=>{d(!0)},close:()=>{d(!1),g.resetFields()}}));const b=()=>{d(!1),g.resetFields(),u==null||u()},M=y=>{S(y).then(()=>{x.invalidateQueries({queryKey:["my_keychain"]}),b(),z.success(l("keychain.added"))})},_=()=>{g.validateFields().then(y=>{M(y)})};return r.jsx(ye,{open:h,onCancel:b,title:l("keychain.add"),okText:l("bucketForm.save"),onOk:_,children:r.jsxs(R,{form:g,layout:"vertical",name:"keychain",onFinish:M,children:[r.jsx(R.Item,{label:l("keychain.name"),name:"name",rules:[{required:!0,message:l("keychain.namePlaceholder")}],children:r.jsx(W,{placeholder:l("keychain.namePlaceholder")})}),r.jsx(R.Item,{label:l("keychain.accessKeyId"),name:"access_key_id",rules:[{required:!0,message:l("keychain.accessKeyIdPlaceholder")}],children:r.jsx(W,{placeholder:l("keychain.accessKeyIdPlaceholder")})}),r.jsx(R.Item,{label:l("keychain.secretKeyId"),name:"secret_key_id",rules:[{required:!0,message:l("keychain.secretKeyIdPlaceholder")}],children:r.jsx(W,{placeholder:l("keychain.secretKeyIdPlaceholder")})})]})})}function qe({data:o,className:u}){const[h,d]=w.useState(!1),{mutateAsync:g}=ve(),{mutateAsync:x}=ge(),S=ee(),{t:l}=te(),b=y=>{navigator.clipboard.writeText(y),z.success(l("copied"))},M=async y=>{try{await x(y),z.success(l("keychain.deleted")),S.invalidateQueries({queryKey:["my_keychain"]})}catch(E){console.error(E)}},_=async y=>{await g({id:o.id,data:{name:y}}),S.invalidateQueries({queryKey:["my_keychain"]}),z.success(l("keychain.updated"))};return r.jsx(be,{className:u,title:r.jsx(Re,{value:o.name,onChange:_,onEditableChange:y=>d(y)}),extra:!h&&r.jsxs("div",{className:"flex gap-2",children:[r.jsx("span",{className:"text-gray-400",children:r.jsxs("div",{className:"flex gap-2 items-center",children:[r.jsx(Fe,{}),Ce(o.created_at).format("YYYY-MM-DD HH:mm:ss")]})}),r.jsx(je,{title:l("keychain.deleteConfirm"),onConfirm:()=>M(o.id),children:r.jsx(F,{danger:!0,type:"text",size:"small",icon:r.jsx(we,{})})})]}),children:r.jsxs("div",{className:"flex flex-col gap-4",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"text-nowrap",children:"Access Key: "}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"text-ellipsis max-w-[200px] overflow-hidden",title:o.access_key_id,children:o.access_key_id}),r.jsx(F,{type:"text",size:"small",icon:r.jsx(Ae,{}),onClick:()=>b(o.access_key_id)})]})]}),r.jsxs("div",{className:"flex items-start gap-2",children:[r.jsxs("span",{className:"text-nowrap",children:["Secret Key(",l("keychain.encrypted"),"): "]}),r.jsx("div",{className:"flex items-center gap-2",children:r.jsx("span",{className:"text-ellipsis max-w-[200px] overflow-hidden",title:o.secret_key_id,children:o.secret_key_id})})]})]})})}const Ze=function(){const u=w.useRef(null),{data:h}=pe(1,100),d=ee(),{t:g}=te();return r.jsxs("div",{className:"flex flex-col gap-4 p-4",children:[r.jsxs("div",{className:"flex text-2xl font-bold mb-2 items-center justify-between",children:[g("bucketForm.AS&SKManagement"),r.jsx(F,{type:"primary",icon:r.jsx(xe,{}),onClick:()=>{var x;(x=u.current)==null||x.open()},children:g("keychain.add")})]}),r.jsx($e,{type:"info",message:g("keychain.addAS&SKTips"),showIcon:!0}),ae.isEmpty(h==null?void 0:h.data)&&r.jsx(Se,{description:g("keychain.noAK&SK")}),r.jsx("div",{className:"flex flex-wrap gap-4 items-stretch",children:ae.chain(h).get("data",[]).map(x=>r.jsx(qe,{className:"shrink-0 w-full sm:w-full md:w-[calc(50%-0.5rem)] lg:w-[calc(33.33%-0.75rem)] grow-0",data:x},x.id)).value()}),r.jsx(Ee,{modalFormRef:u,onClose:()=>{d.invalidateQueries({queryKey:["my_keychain"]})}})]})};export{Ze as component};
