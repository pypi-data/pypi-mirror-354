

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SpiralMap.models_ &mdash; SpiralMap 1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=92fd9be5" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />

  
    <link rel="canonical" href="https://spiralmap.readthedocs.io/en/latest/_modules/SpiralMap/models_.html" />
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=f2a433a1"></script>
      <script src="../../_static/doctools.js?v=9a2dae69"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            SpiralMap
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../models_available.html">Available Spiral Arm Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../citation.html">How to Cite</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api.html">API</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">SpiralMap</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Module code</a></li>
      <li class="breadcrumb-item active">SpiralMap.models_</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for SpiralMap.models_</h1><div class="highlight"><pre>
<span></span><span class="c1">#######################################################################</span>
<span class="c1"># SpiralMap: a library of the Milky Way&#39;s spiral arms</span>
<span class="c1"># History:  	</span>
<span class="c1"># May 2025: Prusty (IISER Kolkata) &amp; Shourya Khanna (INAF Torino)</span>
<span class="c1">#######################################################################</span>


<span class="c1">#--------------------------------------------</span>
<span class="c1"># import utilities package / set root </span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">os.path</span> <span class="kn">import</span> <span class="n">dirname</span>
<span class="n">root_</span> <span class="o">=</span> <span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span>
<span class="n">dataloc</span> <span class="o">=</span> <span class="n">root_</span><span class="o">+</span><span class="s1">&#39;/datafiles&#39;</span>
<span class="n">exec</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="n">root_</span><span class="o">+</span><span class="s2">&quot;/mytools.py&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>

<span class="c1">#--------------------------------------------       </span>


<span class="c1">### TO do:</span>
<span class="c1">#1 consistent colours for similar arms</span>
<span class="c1">####################################</span>

<span class="k">class</span> <span class="nc">spiral_poggio_maps</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
	<span class="c1"># &quot;&quot;&quot;</span>
	<span class="c1"># Class containing spiral arm models from</span>
		<span class="c1"># Poggio_2021: Poggio al. 2021 (EDR3 UMS stars)</span>
		<span class="c1"># GaiaPVP_2022: Gaia collaboration et al. 2021 (OB stars)</span>
					
	<span class="c1"># HISTORY:</span>
		<span class="c1"># 09 May 2025: Prusty/Khanna					</span>
	<span class="c1"># &quot;&quot;&quot;</span>
	
	<span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">model_</span><span class="o">=</span><span class="s1">&#39;GaiaPVP_cont_2022&#39;</span><span class="p">):</span>		
<span class="w">		</span><span class="sd">&quot;&quot;&quot;Initialize the list of available spiral arms </span>
<span class="sd">		and their corresponding plot colors. &quot;&quot;&quot;</span>		
		<span class="bp">self</span><span class="o">.</span><span class="n">model_</span> <span class="o">=</span> <span class="n">model_</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">loc</span> <span class="o">=</span> <span class="n">dataloc</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span><span class="o">+</span><span class="n">model_</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">getarmlist</span><span class="p">()</span>	
	<span class="k">def</span> <span class="nf">getarmlist</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;Initialize the list of available spiral arms </span>
<span class="sd">		and their corresponding plot colors. &quot;&quot;&quot;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">arms</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;all&#39;</span><span class="p">])</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">armcolour</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;all&#39;</span><span class="p">:</span> <span class="s1">&#39;black&#39;</span><span class="p">}</span>	
		<span class="bp">self</span><span class="o">.</span><span class="n">armcolours</span><span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">armcolour</span><span class="p">[</span><span class="n">ky</span><span class="p">]</span>  <span class="k">for</span> <span class="n">ky</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">arms</span>  <span class="p">]</span>			
	<span class="k">def</span> <span class="nf">info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;Collate arm information &quot;&quot;&quot;</span>
		<span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Arm list&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">arms</span><span class="p">,</span> <span class="s1">&#39;Colour&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">armcolours</span><span class="p">}</span>		
		<span class="n">dfmodlist</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>	
		<span class="nb">print</span><span class="p">(</span><span class="n">tabulate</span><span class="p">(</span><span class="n">dfmodlist</span><span class="p">,</span> <span class="n">headers</span> <span class="o">=</span> <span class="s1">&#39;keys&#39;</span><span class="p">,</span> <span class="n">tablefmt</span> <span class="o">=</span> <span class="s1">&#39;psql&#39;</span><span class="p">))</span>		
	<span class="k">def</span> <span class="nf">output_</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">plotattrs</span><span class="p">):</span>
		
		<span class="n">xsun</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xsun</span>
	
		<span class="n">flist1</span> <span class="o">=</span> <span class="n">fcount</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">loc</span><span class="p">,</span><span class="n">flist</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">prnt</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>		
		<span class="n">func_</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="s1">&#39;grid&#39;</span> <span class="ow">in</span> <span class="n">s</span>
		<span class="n">overdens_file</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="n">func_</span><span class="p">,</span><span class="n">flist1</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
		<span class="n">func_</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="s1">&#39;xval&#39;</span> <span class="ow">in</span> <span class="n">s</span>
		<span class="n">xval_file</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="n">func_</span><span class="p">,</span><span class="n">flist1</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
		<span class="n">func_</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="s1">&#39;yval&#39;</span> <span class="ow">in</span> <span class="n">s</span>
		<span class="n">yval_file</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="n">func_</span><span class="p">,</span><span class="n">flist1</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
		
		<span class="c1"># # read overdensity contours</span>
		<span class="n">xvalues_overdens</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">loc</span><span class="o">+</span><span class="s1">&#39;/&#39;</span><span class="o">+</span><span class="n">xval_file</span><span class="p">)</span>
		<span class="n">yvalues_overdens</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">loc</span><span class="o">+</span><span class="s1">&#39;/&#39;</span><span class="o">+</span><span class="n">yval_file</span><span class="p">)</span>
		<span class="n">over_dens_grid</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">loc</span><span class="o">+</span><span class="s1">&#39;/&#39;</span><span class="o">+</span><span class="n">overdens_file</span><span class="p">)</span>
		<span class="n">phi1_dens</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="n">yvalues_overdens</span><span class="p">,</span> <span class="o">-</span><span class="n">xvalues_overdens</span><span class="p">)</span>
		<span class="n">Rvalues_dens</span><span class="o">=</span><span class="n">sqrtsum</span><span class="p">(</span><span class="n">ds</span><span class="o">=</span><span class="p">[</span><span class="n">xvalues_overdens</span><span class="p">,</span> <span class="n">yvalues_overdens</span><span class="p">])</span>
		<span class="n">Rgcvalues_dens</span><span class="o">=</span><span class="n">sqrtsum</span><span class="p">(</span><span class="n">ds</span><span class="o">=</span><span class="p">[</span><span class="n">xvalues_overdens</span><span class="o">+</span><span class="n">xsun</span><span class="p">,</span> <span class="n">yvalues_overdens</span><span class="p">])</span>
		
		<span class="n">fl</span> <span class="o">=</span> <span class="n">pickleread</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">loc</span><span class="o">+</span><span class="s1">&#39;/&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">model_</span><span class="o">+</span><span class="s1">&#39;_pproj_contours.pkl&#39;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">dout</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;xhc&#39;</span><span class="p">:</span><span class="n">xvalues_overdens</span><span class="p">,</span><span class="s1">&#39;yhc&#39;</span><span class="p">:</span><span class="n">yvalues_overdens</span><span class="p">,</span><span class="s1">&#39;xgc&#39;</span><span class="p">:</span><span class="n">xvalues_overdens</span><span class="o">+</span><span class="n">xsun</span><span class="p">,</span><span class="s1">&#39;ygc&#39;</span><span class="p">:</span><span class="n">yvalues_overdens</span><span class="p">}</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">dout</span><span class="p">[</span><span class="s1">&#39;phi4&#39;</span><span class="p">]</span> <span class="o">=</span><span class="n">fl</span><span class="p">[</span><span class="s1">&#39;phi4&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>	
		<span class="bp">self</span><span class="o">.</span><span class="n">dout</span><span class="p">[</span><span class="s1">&#39;glon4&#39;</span><span class="p">]</span> <span class="o">=</span><span class="n">fl</span><span class="p">[</span><span class="s1">&#39;glon4&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>	
		<span class="bp">self</span><span class="o">.</span><span class="n">dout</span><span class="p">[</span><span class="s1">&#39;rgc&#39;</span><span class="p">]</span> <span class="o">=</span><span class="n">fl</span><span class="p">[</span><span class="s1">&#39;rgc&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>	
		<span class="bp">self</span><span class="o">.</span><span class="n">dout</span><span class="p">[</span><span class="s1">&#39;dhelio&#39;</span><span class="p">]</span> <span class="o">=</span><span class="n">fl</span><span class="p">[</span><span class="s1">&#39;dhelio&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>	
		
		<span class="c1"># # # # getangular(self)</span>

		<span class="c1">#----overplot spiral arms in overdens----#</span>
		<span class="n">iniz_overdens</span><span class="o">=</span> <span class="mi">0</span>  
		<span class="n">fin_overdens</span><span class="o">=</span> <span class="mf">1.5</span> 
		<span class="n">N_levels_overdens</span><span class="o">=</span> <span class="mi">2</span>
		<span class="n">levels_overdens1</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">iniz_overdens</span><span class="p">,</span><span class="n">fin_overdens</span><span class="p">,</span><span class="n">N_levels_overdens</span><span class="p">)</span>		
		
		<span class="k">if</span> <span class="n">plotattrs</span><span class="p">[</span><span class="s1">&#39;polarproj&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>	
			<span class="n">useclr</span> <span class="o">=</span> <span class="n">plotattrs</span><span class="p">[</span><span class="s1">&#39;armcolour&#39;</span><span class="p">]</span>					
			<span class="k">if</span> <span class="n">plotattrs</span><span class="p">[</span><span class="s1">&#39;armcolour&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
				<span class="n">useclr</span> <span class="o">=</span> <span class="s1">&#39;grey&#39;</span>
			<span class="n">cset1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dout</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="o">+</span><span class="n">plotattrs</span><span class="p">[</span><span class="s1">&#39;coordsys&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()],</span><span class="bp">self</span><span class="o">.</span><span class="n">dout</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="o">+</span><span class="n">plotattrs</span><span class="p">[</span><span class="s1">&#39;coordsys&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()],</span><span class="n">over_dens_grid</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> 
								<span class="n">levels</span><span class="o">=</span><span class="n">levels_overdens1</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Greys&#39;</span><span class="p">)</span>	
			<span class="n">iniz_overdens</span><span class="o">=</span> <span class="mf">0.</span> 
			<span class="n">fin_overdens</span><span class="o">=</span> <span class="mf">1.5</span> 
			<span class="n">N_levels_overdens</span><span class="o">=</span> <span class="mi">4</span> 
			<span class="n">levels_overdens2</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">iniz_overdens</span><span class="p">,</span><span class="n">fin_overdens</span><span class="p">,</span><span class="n">N_levels_overdens</span><span class="p">)</span>
			<span class="n">cset2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dout</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="o">+</span><span class="n">plotattrs</span><span class="p">[</span><span class="s1">&#39;coordsys&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()],</span><span class="bp">self</span><span class="o">.</span><span class="n">dout</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="o">+</span><span class="n">plotattrs</span><span class="p">[</span><span class="s1">&#39;coordsys&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()],</span><span class="n">over_dens_grid</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="n">levels</span><span class="o">=</span><span class="n">levels_overdens2</span><span class="p">,</span><span class="n">colors</span><span class="o">=</span><span class="n">useclr</span><span class="p">,</span><span class="n">linewidths</span><span class="o">=</span><span class="n">plotattrs</span><span class="p">[</span><span class="s1">&#39;markersize&#39;</span><span class="p">])</span>
	
			<span class="bp">self</span><span class="o">.</span><span class="n">xmin</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">xmax</span> <span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span><span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>				
			<span class="bp">self</span><span class="o">.</span><span class="n">ymin</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">ymax</span> <span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span><span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>								

			<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;X$_{&#39;</span><span class="o">+</span><span class="n">plotattrs</span><span class="p">[</span><span class="s1">&#39;coordsys&#39;</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;}$ [Kpc]&#39;</span><span class="p">)</span>
			<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Y$_{&#39;</span><span class="o">+</span><span class="n">plotattrs</span><span class="p">[</span><span class="s1">&#39;coordsys&#39;</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;}$ [Kpc]&#39;</span><span class="p">)</span>	 

			<span class="k">return</span> <span class="n">cset1</span><span class="p">,</span> <span class="n">cset2</span>														
		<span class="k">else</span><span class="p">:</span>
			<span class="n">plotattrs</span><span class="p">[</span><span class="s1">&#39;linestyle&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span>
			<span class="n">_polarproj</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">plotattrs</span><span class="p">)</span>	
				
			
<div class="viewcode-block" id="TaylorCordesSpiral">
<a class="viewcode-back" href="../../api.html#SpiralMap.models_.TaylorCordesSpiral">[docs]</a>
<span class="k">class</span> <span class="nc">TaylorCordesSpiral</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>		
<span class="w">	</span><span class="sd">&quot;&quot;&quot;	</span>
<span class="sd">	Taylor &amp; Cordes (1993) Galactic spiral arm model,	  </span>
<span class="sd">	based on radio pulsar observations. The model defines four major spiral arms.		</span>
<span class="sd">	&quot;&quot;&quot;</span>	
	<span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>		
		<span class="bp">self</span><span class="o">.</span><span class="n">getarmlist</span><span class="p">()</span>        
<div class="viewcode-block" id="TaylorCordesSpiral.getarmlist">
<a class="viewcode-back" href="../../api.html#SpiralMap.models_.TaylorCordesSpiral.getarmlist">[docs]</a>
	<span class="k">def</span> <span class="nf">getarmlist</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;Set arm names and colours&quot;&quot;&quot;</span>
		
		<span class="bp">self</span><span class="o">.</span><span class="n">arms</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;Arm1&#39;</span><span class="p">,</span><span class="s1">&#39;Arm2&#39;</span><span class="p">,</span><span class="s1">&#39;Arm3&#39;</span><span class="p">,</span><span class="s1">&#39;Arm4&#39;</span><span class="p">])</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">armcolour</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Arm1&#39;</span><span class="p">:</span><span class="s1">&#39;yellow&#39;</span><span class="p">,</span><span class="s1">&#39;Arm2&#39;</span><span class="p">:</span><span class="s1">&#39;green&#39;</span><span class="p">,</span><span class="s1">&#39;Arm3&#39;</span><span class="p">:</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span><span class="s1">&#39;Arm4&#39;</span><span class="p">:</span><span class="s1">&#39;purple&#39;</span><span class="p">}</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">armcolours</span><span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">armcolour</span><span class="p">[</span><span class="n">ky</span><span class="p">]</span>  <span class="k">for</span> <span class="n">ky</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">arms</span>  <span class="p">]</span>
	
		<span class="bp">self</span><span class="o">.</span><span class="n">getparams</span><span class="p">()</span>        </div>

	<span class="k">def</span> <span class="nf">info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>        

		<span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Arm list&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">arms</span><span class="p">,</span> <span class="s1">&#39;Colour&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">armcolours</span><span class="p">}</span>
		<span class="n">dfmodlist</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>			
		<span class="nb">print</span><span class="p">(</span><span class="n">tabulate</span><span class="p">(</span><span class="n">dfmodlist</span><span class="p">,</span> <span class="n">headers</span> <span class="o">=</span> <span class="s1">&#39;keys&#39;</span><span class="p">,</span> <span class="n">tablefmt</span> <span class="o">=</span> <span class="s1">&#39;psql&#39;</span><span class="p">))</span>									
<div class="viewcode-block" id="TaylorCordesSpiral.getparams">
<a class="viewcode-back" href="../../api.html#SpiralMap.models_.TaylorCordesSpiral.getparams">[docs]</a>
	<span class="k">def</span> <span class="nf">getparams</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>	   
<span class="w">		</span><span class="sd">&quot;&quot;&quot;Load original spiral parameters from Taylor &amp; Cordes (1993) Table 1.</span>
<span class="sd">		</span>
<span class="sd">	   :return: self.params[&#39;Arm1&#39;,&#39;Arm2&#39;,&#39;Arm3&#39;,&#39;Arm4&#39;], </span>
<span class="sd">				nested dictionary such that, </span>
<span class="sd">				self.params[&#39;Arm&#39;][&#39;theta_deg&#39;] -&gt; Anchor points in galactic longitude (degrees). \</span>
<span class="sd">				self.params[&#39;Arm&#39;][&#39;r_kpc&#39;] -&gt;Corresponding galactocentric radii (kiloparsecs). </span>
<span class="sd">	   :rtype: dict</span>
<span class="sd">		&quot;&quot;&quot;</span>		
		<span class="bp">self</span><span class="o">.</span><span class="n">params</span> <span class="o">=</span> <span class="p">{</span>	<span class="s1">&#39;Arm1&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;theta_deg&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">164</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">240</span><span class="p">,</span> <span class="mi">280</span><span class="p">,</span> <span class="mi">290</span><span class="p">,</span> <span class="mi">315</span><span class="p">,</span> <span class="mi">330</span><span class="p">],</span>
					<span class="s1">&#39;r_kpc&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">3.53</span><span class="p">,</span> <span class="mf">3.76</span><span class="p">,</span> <span class="mf">4.44</span><span class="p">,</span> <span class="mf">5.24</span><span class="p">,</span> <span class="mf">5.36</span><span class="p">,</span> <span class="mf">5.81</span><span class="p">,</span> <span class="mf">5.81</span><span class="p">]},</span>
					
					<span class="s1">&#39;Arm2&#39;</span><span class="p">:{</span><span class="s1">&#39;theta_deg&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">63</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">220</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">288</span><span class="p">],</span>
					<span class="s1">&#39;r_kpc&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">3.76</span><span class="p">,</span> <span class="mf">4.56</span><span class="p">,</span> <span class="mf">4.79</span><span class="p">,</span> <span class="mf">5.70</span><span class="p">,</span> <span class="mf">6.49</span><span class="p">,</span> <span class="mf">7.29</span><span class="p">,</span> <span class="mf">8.20</span><span class="p">]},</span>
					
					<span class="s1">&#39;Arm3&#39;</span><span class="p">:{</span><span class="s1">&#39;theta_deg&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">52</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">170</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">220</span><span class="p">,</span> <span class="mi">252</span><span class="p">],</span>
					<span class="s1">&#39;r_kpc&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">4.90</span><span class="p">,</span> <span class="mf">6.27</span><span class="p">,</span> <span class="mf">6.49</span><span class="p">,</span> <span class="mf">6.95</span><span class="p">,</span> <span class="mf">8.20</span><span class="p">,</span> <span class="mf">8.89</span><span class="p">,</span> <span class="mf">9.57</span><span class="p">]},</span>
					
					<span class="s1">&#39;Arm4&#39;</span><span class="p">:{</span><span class="s1">&#39;theta_deg&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">223</span><span class="p">],</span>
					<span class="s1">&#39;r_kpc&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">5.92</span><span class="p">,</span> <span class="mf">7.06</span><span class="p">,</span> <span class="mf">7.86</span><span class="p">,</span> <span class="mf">9.68</span><span class="p">,</span> <span class="mf">10.37</span><span class="p">,</span> <span class="mf">11.39</span><span class="p">,</span> <span class="mf">12.08</span><span class="p">]}</span>					  
								  <span class="p">}</span>    </div>

<div class="viewcode-block" id="TaylorCordesSpiral.model_">
<a class="viewcode-back" href="../../api.html#SpiralMap.models_.TaylorCordesSpiral.model_">[docs]</a>
	<span class="k">def</span> <span class="nf">model_</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arm_name</span><span class="p">):</span>					
<span class="w">		</span><span class="sd">&quot;&quot;&quot;			</span>
<span class="sd">		   Generate arm coordinates using cubic spline interpolation.</span>
<span class="sd">		</span>
<span class="sd">		   :param arm_name: Must be one of: &#39;Arm1&#39;, &#39;Arm2&#39;, &#39;Arm3&#39;, &#39;Arm4&#39;.	</span>
<span class="sd">		   :type arm_name: String </span>
<span class="sd">		   :return: (x_hc, y_hc, x_gc, y_gc)</span>
<span class="sd">		   :rtype: tuple </span>
<span class="sd">		&quot;&quot;&quot;</span>		
		
		<span class="bp">self</span><span class="o">.</span><span class="n">getparams</span><span class="p">()</span>
		<span class="n">arm_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="n">arm_name</span><span class="p">]</span>
		<span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">arm_data</span><span class="p">[</span><span class="s1">&#39;theta_deg&#39;</span><span class="p">])</span>  <span class="c1"># Convert to radians</span>
		<span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">arm_data</span><span class="p">[</span><span class="s1">&#39;r_kpc&#39;</span><span class="p">])</span>
		
		<span class="c1"># Cubic spline interpolation for smooth curve</span>
		<span class="n">cs</span> <span class="o">=</span> <span class="n">CubicSpline</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
		<span class="n">theta_fine</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="mi">300</span><span class="p">)</span>
		<span class="n">r_fine</span> <span class="o">=</span> <span class="n">cs</span><span class="p">(</span><span class="n">theta_fine</span><span class="p">)</span>
		
		<span class="c1"># Convert to Cartesian coordinates (Galacto-Centric)</span>
		
		<span class="n">xgc</span> <span class="o">=</span> <span class="n">r_fine</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta_fine</span><span class="p">)</span>
		<span class="n">ygc</span> <span class="o">=</span> <span class="o">-</span><span class="n">r_fine</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta_fine</span><span class="p">)</span>
		
		<span class="c1"># rotate by 90 anti-clockwise to match with our convention </span>
		<span class="n">rot_ang</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="mi">90</span><span class="p">)</span>
		<span class="n">x_gc</span> <span class="o">=</span> <span class="p">(</span><span class="n">xgc</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">rot_ang</span><span class="p">))</span> <span class="o">-</span> <span class="p">(</span><span class="n">ygc</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">rot_ang</span><span class="p">)</span>  <span class="p">)</span>
		<span class="n">y_gc</span> <span class="o">=</span> <span class="p">(</span><span class="n">xgc</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">rot_ang</span><span class="p">))</span> <span class="o">+</span> <span class="p">(</span><span class="n">ygc</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">rot_ang</span><span class="p">)</span>  <span class="p">)</span>
			
		<span class="c1"># Convert to Heliocentric coordinates</span>
		<span class="n">x_hc</span> <span class="o">=</span> <span class="n">x_gc</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">R0</span>  <span class="c1"># Sun at (-R0, 0) in GC</span>
		
		<span class="k">return</span> <span class="n">x_hc</span><span class="p">,</span> <span class="n">y_gc</span><span class="p">,</span> <span class="n">x_gc</span><span class="p">,</span> <span class="n">y_gc</span>		</div>

<div class="viewcode-block" id="TaylorCordesSpiral.output_">
<a class="viewcode-back" href="../../api.html#SpiralMap.models_.TaylorCordesSpiral.output_">[docs]</a>
	<span class="k">def</span> <span class="nf">output_</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">arm</span><span class="p">):</span>			
<span class="w">		</span><span class="sd">&quot;&quot;&quot;			</span>
<span class="sd">		   Get arm coordinates in structured format.</span>
<span class="sd">		</span>
<span class="sd">		   :param arm: Arm identifier (e.g., &#39;Arm1&#39;)		</span>
<span class="sd">		   :type arm: String </span>
<span class="sd">		   :return: self.dout = {&#39;xhc&#39;:xhc,&#39;yhc&#39;:yhc,&#39;xgc&#39;:xgc,&#39;ygc&#39;:ygc}</span>
<span class="sd">		   :rtype: dict </span>
<span class="sd">		&quot;&quot;&quot;</span>				
		
		<span class="n">xsun</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xsun</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">R0</span> <span class="o">=</span> <span class="o">-</span><span class="n">xsun</span>  <span class="c1"># Solar Galactocentric radius (kpc)					</span>
		<span class="n">xhc</span><span class="p">,</span><span class="n">yhc</span><span class="p">,</span><span class="n">xgc</span><span class="p">,</span><span class="n">ygc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_</span><span class="p">(</span><span class="n">arm</span><span class="p">);</span>					
		<span class="bp">self</span><span class="o">.</span><span class="n">dout</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;xhc&#39;</span><span class="p">:</span><span class="n">xhc</span><span class="p">,</span><span class="s1">&#39;yhc&#39;</span><span class="p">:</span><span class="n">yhc</span><span class="p">,</span><span class="s1">&#39;xgc&#39;</span><span class="p">:</span><span class="n">xgc</span><span class="p">,</span><span class="s1">&#39;ygc&#39;</span><span class="p">:</span><span class="n">ygc</span><span class="p">}</span>							 </div>
</div>



<div class="viewcode-block" id="spiral_houhan">
<a class="viewcode-back" href="../../api.html#SpiralMap.models_.spiral_houhan">[docs]</a>
<span class="k">class</span> <span class="nc">spiral_houhan</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>	
<span class="w">	</span><span class="sd">&quot;&quot;&quot;Hou &amp; Han (2014) polynomial-logarithmic spiral arm model</span>
<span class="sd">	</span>
<span class="sd">	Implements the Milky Way spiral structure model from:</span>
<span class="sd">	&quot;The spiral structure of the Milky Way from classical Cepheids&quot; (Hou &amp; Han 2014)</span>
<span class="sd">	using polynomial-logarithmic spiral functions. Provides 6 major arm segments.	</span>
<span class="sd">	&quot;&quot;&quot;</span>	
	<span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>			
		<span class="bp">self</span><span class="o">.</span><span class="n">getarmlist</span><span class="p">()</span>	
<div class="viewcode-block" id="spiral_houhan.getarmlist">
<a class="viewcode-back" href="../../api.html#SpiralMap.models_.spiral_houhan.getarmlist">[docs]</a>
	<span class="k">def</span> <span class="nf">getarmlist</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;Set arm names and colours&quot;&quot;&quot;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">arms</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;Norma&#39;</span><span class="p">,</span><span class="s1">&#39;Scutum-Centaurus&#39;</span><span class="p">,</span><span class="s1">&#39;Sagittarius-Carina&#39;</span><span class="p">,</span><span class="s1">&#39;Perseus&#39;</span><span class="p">,</span><span class="s1">&#39;Local&#39;</span><span class="p">,</span><span class="s1">&#39;Outer&#39;</span><span class="p">])</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">armcolour</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Norma&#39;</span><span class="p">:</span><span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="s1">&#39;Scutum-Centaurus&#39;</span><span class="p">:</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="s1">&#39;Sagittarius-Carina&#39;</span><span class="p">:</span><span class="s1">&#39;green&#39;</span><span class="p">,</span><span class="s1">&#39;Perseus&#39;</span><span class="p">:</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span><span class="s1">&#39;Local&#39;</span><span class="p">:</span><span class="s1">&#39;purple&#39;</span><span class="p">,</span><span class="s1">&#39;Outer&#39;</span><span class="p">:</span><span class="s1">&#39;gold&#39;</span><span class="p">}</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">armcolours</span><span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">armcolour</span><span class="p">[</span><span class="n">ky</span><span class="p">]</span>  <span class="k">for</span> <span class="n">ky</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">arms</span>  <span class="p">]</span>	</div>

	<span class="k">def</span> <span class="nf">info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>		
		<span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Arm list&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">arms</span><span class="p">,</span> <span class="s1">&#39;Colour&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">armcolours</span><span class="p">}</span>
		<span class="n">dfmodlist</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>		
		<span class="nb">print</span><span class="p">(</span><span class="n">tabulate</span><span class="p">(</span><span class="n">dfmodlist</span><span class="p">,</span> <span class="n">headers</span> <span class="o">=</span> <span class="s1">&#39;keys&#39;</span><span class="p">,</span> <span class="n">tablefmt</span> <span class="o">=</span> <span class="s1">&#39;psql&#39;</span><span class="p">))</span>			
		
<div class="viewcode-block" id="spiral_houhan.getparams">
<a class="viewcode-back" href="../../api.html#SpiralMap.models_.spiral_houhan.getparams">[docs]</a>
	<span class="k">def</span> <span class="nf">getparams</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>						
<span class="w">		</span><span class="sd">&quot;&quot;&quot;			</span>
<span class="sd">		   Load spiral parameters from Hou &amp; Han (2014) Table 4.</span>
<span class="sd">		   </span>
<span class="sd">		   :return: params ( Nested dictionary containing for each arm).</span>
<span class="sd">		   </span>
<span class="sd">	   				a, b, c, d: Polynomial coefficients.</span>
<span class="sd">	   				</span>
<span class="sd">					θ_start: Start angle in degrees (Galactic longitude).</span>
<span class="sd">					</span>
<span class="sd">					θ_end: End angle in degrees.		   		   </span>
<span class="sd">		   :rtype: dict </span>
<span class="sd">		&quot;&quot;&quot;</span>					
		<span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
			<span class="s1">&#39;Norma&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mf">1.1668</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mf">0.1198</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mf">0.002557</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;θ_start&#39;</span><span class="p">:</span> <span class="mi">40</span><span class="p">,</span> <span class="s1">&#39;θ_end&#39;</span><span class="p">:</span> <span class="mi">250</span><span class="p">},</span>
			<span class="s1">&#39;Scutum-Centaurus&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mf">5.8002</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.8188</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mf">0.2352</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.008999</span><span class="p">,</span> <span class="s1">&#39;θ_start&#39;</span><span class="p">:</span> <span class="mi">275</span><span class="p">,</span> <span class="s1">&#39;θ_end&#39;</span><span class="p">:</span> <span class="mi">620</span><span class="p">},</span>
			<span class="s1">&#39;Sagittarius-Carina&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mf">4.2300</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.1505</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mf">0.1561</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.005898</span><span class="p">,</span> <span class="s1">&#39;θ_start&#39;</span><span class="p">:</span> <span class="mi">275</span><span class="p">,</span> <span class="s1">&#39;θ_end&#39;</span><span class="p">:</span> <span class="mi">570</span><span class="p">},</span>
			<span class="s1">&#39;Perseus&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mf">0.9744</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mf">0.1405</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mf">0.003995</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;θ_start&#39;</span><span class="p">:</span> <span class="mi">280</span><span class="p">,</span> <span class="s1">&#39;θ_end&#39;</span><span class="p">:</span> <span class="mi">500</span><span class="p">},</span>
			<span class="s1">&#39;Local&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mf">0.9887</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mf">0.1714</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mf">0.004358</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;θ_start&#39;</span><span class="p">:</span> <span class="mi">280</span><span class="p">,</span> <span class="s1">&#39;θ_end&#39;</span><span class="p">:</span> <span class="mi">475</span><span class="p">},</span>
			<span class="s1">&#39;Outer&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mf">3.3846</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.6554</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mf">0.08170</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;θ_start&#39;</span><span class="p">:</span> <span class="mi">280</span><span class="p">,</span> <span class="s1">&#39;θ_end&#39;</span><span class="p">:</span> <span class="mi">355</span><span class="p">}</span>
		<span class="p">}</span>	
		<span class="k">return</span> <span class="n">params</span>		</div>

<div class="viewcode-block" id="spiral_houhan.polynomial_log_spiral">
<a class="viewcode-back" href="../../api.html#SpiralMap.models_.spiral_houhan.polynomial_log_spiral">[docs]</a>
	<span class="k">def</span> <span class="nf">polynomial_log_spiral</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">θ</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">):</span>		
<span class="w">		</span><span class="sd">&quot;&quot;&quot;Calculate radius using polynomial-logarithmic spiral equation.</span>
<span class="sd">		</span>
<span class="sd">		Parameters</span>
<span class="sd">		----------</span>
<span class="sd">		θ : float or ndarray</span>
<span class="sd">			Galactic longitude angle in degrees</span>
<span class="sd">		a,b,c,d : float</span>
<span class="sd">			Polynomial coefficients from Hou &amp; Han Table 4</span>
<span class="sd">			</span>
<span class="sd">		Returns</span>
<span class="sd">		-------</span>
<span class="sd">		float or ndarray</span>
<span class="sd">			Galactocentric radius in kiloparsecs</span>
<span class="sd">			</span>
<span class="sd">		Notes</span>
<span class="sd">		-----</span>
<span class="sd">		Implements equation:</span>
<span class="sd">		R(θ) = exp(a + bθ_rad + cθ_rad² + dθ_rad³)</span>
<span class="sd">		where θ_rad = np.radians(θ)</span>
<span class="sd">		&quot;&quot;&quot;</span>	
		<span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">θ</span><span class="p">)</span> <span class="o">+</span> <span class="n">c</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">θ</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">d</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">θ</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span></div>

	
	<span class="k">def</span> <span class="nf">model_</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arm_name</span><span class="p">,</span> <span class="n">n_points</span><span class="o">=</span><span class="mi">500</span><span class="p">):</span>
		
		<span class="n">params_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getparams</span><span class="p">()</span>
		<span class="n">params</span> <span class="o">=</span> <span class="n">params_</span><span class="p">[</span><span class="n">arm_name</span><span class="p">]</span>
		
		
		<span class="n">θ</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;θ_start&#39;</span><span class="p">],</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;θ_end&#39;</span><span class="p">],</span> <span class="n">n_points</span><span class="p">)</span>
		<span class="n">R</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">polynomial_log_spiral</span><span class="p">(</span><span class="n">θ</span><span class="p">,</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">],</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">],</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">],</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">])</span>
		
		<span class="c1"># Convert to Cartesian coordinates (Galactocentric)</span>
		<span class="n">x_gc</span> <span class="o">=</span> <span class="n">R</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">θ</span><span class="p">))</span>
		<span class="n">y_gc</span> <span class="o">=</span> <span class="n">R</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">θ</span><span class="p">))</span>
		
		<span class="c1"># Convert to Heliocentric coordinates</span>
		<span class="n">x_hc</span> <span class="o">=</span> <span class="p">(</span><span class="n">x_gc</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">R0</span><span class="p">)</span>
	
		<span class="k">return</span> <span class="n">x_hc</span><span class="p">,</span> <span class="n">y_gc</span><span class="p">,</span> <span class="n">x_gc</span><span class="p">,</span> <span class="n">y_gc</span>
	
<div class="viewcode-block" id="spiral_houhan.output_">
<a class="viewcode-back" href="../../api.html#SpiralMap.models_.spiral_houhan.output_">[docs]</a>
	<span class="k">def</span> <span class="nf">output_</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arm</span><span class="p">):</span>			
<span class="w">		</span><span class="sd">&quot;&quot;&quot;			</span>
<span class="sd">		   Get arm coordinates in structured format.</span>
<span class="sd">		</span>
<span class="sd">		   :param arm: Arm identifier (e.g., &#39;Arm1&#39;)		</span>
<span class="sd">		   :type arm: String </span>
<span class="sd">		   :return: self.dout = {&#39;xhc&#39;:xhc,&#39;yhc&#39;:yhc,&#39;xgc&#39;:xgc,&#39;ygc&#39;:ygc}</span>
<span class="sd">		   :rtype: dict </span>
<span class="sd">		&quot;&quot;&quot;</span>				
		
		<span class="n">xsun</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xsun</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">R0</span> <span class="o">=</span> <span class="o">-</span><span class="n">xsun</span>  <span class="c1"># Solar Galactocentric radius (kpc)	</span>
		<span class="c1"># Generate spiral arm coordinates</span>
		<span class="n">xhc</span><span class="p">,</span> <span class="n">yhc</span><span class="p">,</span> <span class="n">xgc</span><span class="p">,</span> <span class="n">ygc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_</span><span class="p">(</span><span class="n">arm</span><span class="p">)</span>	
		<span class="bp">self</span><span class="o">.</span><span class="n">dout</span> <span class="o">=</span> <span class="p">{</span>
			<span class="s1">&#39;xhc&#39;</span><span class="p">:</span> <span class="n">xhc</span><span class="p">,</span>
			<span class="s1">&#39;yhc&#39;</span><span class="p">:</span> <span class="n">yhc</span><span class="p">,</span>
			<span class="s1">&#39;xgc&#39;</span><span class="p">:</span> <span class="n">xgc</span><span class="p">,</span>
			<span class="s1">&#39;ygc&#39;</span><span class="p">:</span> <span class="n">ygc</span>
		<span class="p">}</span></div>
</div>



<div class="viewcode-block" id="spiral_levine">
<a class="viewcode-back" href="../../api.html#SpiralMap.models_.spiral_levine">[docs]</a>
<span class="k">class</span> <span class="nc">spiral_levine</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>		
<span class="w">	</span><span class="sd">&quot;&quot;&quot;	</span>
<span class="sd">	Levine et al (2006) logarithmic spiral arm model for the Milky Way.  				</span>
<span class="sd">	&quot;&quot;&quot;</span>	

	<span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>   
		<span class="bp">self</span><span class="o">.</span><span class="n">getarmlist</span><span class="p">()</span>
	
<div class="viewcode-block" id="spiral_levine.getarmlist">
<a class="viewcode-back" href="../../api.html#SpiralMap.models_.spiral_levine.getarmlist">[docs]</a>
	<span class="k">def</span> <span class="nf">getarmlist</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>	
<span class="w">		</span><span class="sd">&quot;&quot;&quot;Set arm names and colours&quot;&quot;&quot;</span>					
		<span class="bp">self</span><span class="o">.</span><span class="n">arms</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;Arm1&#39;</span><span class="p">,</span><span class="s1">&#39;Arm2&#39;</span><span class="p">,</span><span class="s1">&#39;Arm3&#39;</span><span class="p">,</span><span class="s1">&#39;Arm4&#39;</span><span class="p">])</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">armcolour</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Arm1&#39;</span><span class="p">:</span><span class="s1">&#39;yellow&#39;</span><span class="p">,</span><span class="s1">&#39;Arm2&#39;</span><span class="p">:</span><span class="s1">&#39;green&#39;</span><span class="p">,</span><span class="s1">&#39;Arm3&#39;</span><span class="p">:</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span><span class="s1">&#39;Arm4&#39;</span><span class="p">:</span><span class="s1">&#39;purple&#39;</span><span class="p">}</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">getparams</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">armcolours</span><span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">armcolour</span><span class="p">[</span><span class="n">ky</span><span class="p">]</span>  <span class="k">for</span> <span class="n">ky</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">arms</span>  <span class="p">]</span></div>

		
	<span class="k">def</span> <span class="nf">info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

		<span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Arm list&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">arms</span><span class="p">,</span> <span class="s1">&#39;Colour&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">armcolours</span><span class="p">}</span>
		<span class="n">dfmodlist</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>			
		<span class="nb">print</span><span class="p">(</span><span class="n">tabulate</span><span class="p">(</span><span class="n">dfmodlist</span><span class="p">,</span> <span class="n">headers</span> <span class="o">=</span> <span class="s1">&#39;keys&#39;</span><span class="p">,</span> <span class="n">tablefmt</span> <span class="o">=</span> <span class="s1">&#39;psql&#39;</span><span class="p">))</span>			
	
<div class="viewcode-block" id="spiral_levine.getparams">
<a class="viewcode-back" href="../../api.html#SpiralMap.models_.spiral_levine.getparams">[docs]</a>
	<span class="k">def</span> <span class="nf">getparams</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;		</span>
<span class="sd">	   :return: self.params[&#39;Arm1&#39;,&#39;Arm2&#39;,&#39;Arm3&#39;,&#39;Arm4&#39;], nested dictionary such that,</span>
<span class="sd">	   				 				</span>
<span class="sd">				self.params[&#39;Arm&#39;][&#39;pitch&#39;] -&gt; pitch angle</span>
<span class="sd">				</span>
<span class="sd">				self.params[&#39;Arm&#39;][&#39;phi0&#39;] -&gt; Solar crossing angle)</span>
<span class="sd">	   :rtype: dict</span>
<span class="sd">		&quot;&quot;&quot;</span>		
		
		<span class="bp">self</span><span class="o">.</span><span class="n">arms_model</span> <span class="o">=</span> <span class="p">{</span>
			<span class="s1">&#39;Arm1&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;pitch&#39;</span><span class="p">:</span> <span class="mi">24</span><span class="p">,</span> <span class="s1">&#39;phi0&#39;</span><span class="p">:</span> <span class="mi">56</span><span class="p">},</span>   
			<span class="s1">&#39;Arm2&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;pitch&#39;</span><span class="p">:</span> <span class="mi">24</span><span class="p">,</span> <span class="s1">&#39;phi0&#39;</span><span class="p">:</span> <span class="mi">135</span><span class="p">},</span>
			<span class="s1">&#39;Arm3&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;pitch&#39;</span><span class="p">:</span> <span class="mi">25</span><span class="p">,</span> <span class="s1">&#39;phi0&#39;</span><span class="p">:</span> <span class="mi">189</span><span class="p">},</span>
			<span class="s1">&#39;Arm4&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;pitch&#39;</span><span class="p">:</span> <span class="mi">21</span><span class="p">,</span> <span class="s1">&#39;phi0&#39;</span><span class="p">:</span> <span class="mi">234</span><span class="p">}</span>
		<span class="p">}</span></div>

	 
<div class="viewcode-block" id="spiral_levine.model_">
<a class="viewcode-back" href="../../api.html#SpiralMap.models_.spiral_levine.model_">[docs]</a>
	<span class="k">def</span> <span class="nf">model_</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">arm_name</span><span class="p">,</span> <span class="n">R_max</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">n_points</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
<span class="w">		</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;Generate logarithmic spiral coordinates for specified arm.</span>
<span class="sd">		</span>
<span class="sd">		Parameters</span>
<span class="sd">		----------</span>
<span class="sd">		arm_name : str</span>
<span class="sd">			Name of arm to model (must be in [&#39;Arm1&#39;, &#39;Arm2&#39;, &#39;Arm3&#39;, &#39;Arm4&#39;])</span>
<span class="sd">		R_max : float, optional</span>
<span class="sd">			Maximum galactocentric radius to model (kpc), default=25</span>
<span class="sd">		n_points : int, optional</span>
<span class="sd">			Number of points to sample along the spiral, default=1000</span>
<span class="sd">	</span>
<span class="sd">		Returns</span>
<span class="sd">		-------</span>
<span class="sd">		tuple</span>
<span class="sd">			(x_hc, y_hc, x_gc, y_gc) coordinate arrays where:</span>
<span class="sd">			- x_hc, y_hc: Heliocentric coordinates (kpc)</span>
<span class="sd">			- x_gc, y_gc: Galactocentric coordinates (kpc)</span>
<span class="sd">	</span>
<span class="sd">		Raises</span>
<span class="sd">		------</span>
<span class="sd">		ValueError</span>
<span class="sd">			If invalid arm_name is provided</span>
<span class="sd">	</span>
<span class="sd">		Notes</span>
<span class="sd">		-----</span>
<span class="sd">		Implements the logarithmic spiral equation:</span>
<span class="sd">			R(φ) = R₀ * exp[(φ - φ₀) * tan(i)]</span>
<span class="sd">		where:</span>
<span class="sd">		- R₀ is solar galactocentric distance</span>
<span class="sd">		- i is pitch angle</span>
<span class="sd">		- φ₀ is solar crossing angle</span>
<span class="sd">		- φ is the angular coordinate</span>
<span class="sd">		&quot;&quot;&quot;</span>
	
		<span class="n">params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">arms_model</span><span class="p">[</span><span class="n">arm_name</span><span class="p">]</span>
		<span class="n">pitch_rad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;pitch&#39;</span><span class="p">])</span>
		<span class="n">phi0_rad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;phi0&#39;</span><span class="p">])</span>
		
		<span class="c1"># Calculate maximum phi to reach R_max</span>
		<span class="n">phi_max</span> <span class="o">=</span> <span class="n">phi0_rad</span> <span class="o">+</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">R_max</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">R0</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">pitch_rad</span><span class="p">))</span>
		
		<span class="c1"># Generate angular range</span>
		<span class="n">phi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">phi0_rad</span><span class="p">,</span> <span class="n">phi_max</span><span class="p">,</span> <span class="n">n_points</span><span class="p">)</span> <span class="c1">#n_</span>
		
		<span class="c1"># Logarithmic spiral equation</span>
		<span class="n">R</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">R0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">((</span><span class="n">phi</span> <span class="o">-</span> <span class="n">phi0_rad</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">pitch_rad</span><span class="p">))</span>
		
		<span class="c1"># Convert to Cartesian coordinates</span>
		<span class="n">x_gc</span> <span class="o">=</span> <span class="n">R</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>
		<span class="n">y_gc</span> <span class="o">=</span> <span class="n">R</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>
		
		<span class="c1"># Convert to Heliocentric coordinates</span>
		<span class="n">x_hc</span> <span class="o">=</span> <span class="n">x_gc</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">R0</span>  
	
		<span class="k">return</span> <span class="n">x_hc</span><span class="p">,</span> <span class="n">y_gc</span><span class="p">,</span><span class="n">x_gc</span><span class="p">,</span> <span class="n">y_gc</span></div>

		
<div class="viewcode-block" id="spiral_levine.output_">
<a class="viewcode-back" href="../../api.html#SpiralMap.models_.spiral_levine.output_">[docs]</a>
	<span class="k">def</span> <span class="nf">output_</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arm</span><span class="p">):</span>		

<span class="w">		</span><span class="sd">&quot;&quot;&quot;			</span>
<span class="sd">		   Get arm coordinates in structured format.</span>
<span class="sd">		</span>
<span class="sd">		   :param arm: Arm identifier (e.g., &#39;Arm1&#39;)		</span>
<span class="sd">		   :type arm: String </span>
<span class="sd">		   :return: self.dout = {&#39;xhc&#39;:xhc,&#39;yhc&#39;:yhc,&#39;xgc&#39;:xgc,&#39;ygc&#39;:ygc}</span>
<span class="sd">		   :rtype: dict </span>
<span class="sd">		&quot;&quot;&quot;</span>		
				
		<span class="n">xsun</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xsun</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">R0</span> <span class="o">=</span> <span class="o">-</span><span class="n">xsun</span>  
		<span class="n">xhc</span><span class="p">,</span> <span class="n">yhc</span><span class="p">,</span> <span class="n">xgc</span><span class="p">,</span> <span class="n">ygc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_</span><span class="p">(</span><span class="n">arm</span><span class="p">)</span>   
		<span class="bp">self</span><span class="o">.</span><span class="n">dout</span> <span class="o">=</span> <span class="p">{</span>
			<span class="s1">&#39;xhc&#39;</span><span class="p">:</span> <span class="n">xhc</span><span class="p">,</span>
			<span class="s1">&#39;yhc&#39;</span><span class="p">:</span> <span class="n">yhc</span><span class="p">,</span>
			<span class="s1">&#39;xgc&#39;</span><span class="p">:</span> <span class="n">xgc</span><span class="p">,</span>
			<span class="s1">&#39;ygc&#39;</span><span class="p">:</span> <span class="n">ygc</span><span class="p">}</span></div>
</div>



<span class="k">class</span> <span class="nc">spiral_drimmel_cepheids</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
	
	<span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">loc</span> <span class="o">=</span> <span class="n">dataloc</span><span class="o">+</span><span class="s1">&#39;/Drimmel2024_cepheids&#39;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">fname</span> <span class="o">=</span> <span class="s1">&#39;ArmAttributes_dyoungW1_bw025.pkl&#39;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">getarmlist</span><span class="p">()</span>
	<span class="k">def</span> <span class="nf">getarmlist</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

		
		<span class="bp">self</span><span class="o">.</span><span class="n">spirals</span> <span class="o">=</span> <span class="n">pickleread</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">loc</span><span class="o">+</span><span class="s1">&#39;/&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">fname</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">arms</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spirals</span><span class="p">[</span><span class="s1">&#39;0&#39;</span><span class="p">][</span><span class="s1">&#39;arm_attributes&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">armcolour</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Scutum&#39;</span><span class="p">:</span><span class="s1">&#39;C3&#39;</span><span class="p">,</span><span class="s1">&#39;Sag-Car&#39;</span><span class="p">:</span><span class="s1">&#39;C0&#39;</span><span class="p">,</span>
						  <span class="s1">&#39;Orion&#39;</span><span class="p">:</span><span class="s1">&#39;C1&#39;</span><span class="p">,</span><span class="s1">&#39;Perseus&#39;</span><span class="p">:</span><span class="s1">&#39;C2&#39;</span><span class="p">}</span>   
						  
		<span class="bp">self</span><span class="o">.</span><span class="n">armcolours</span><span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">armcolour</span><span class="p">[</span><span class="n">ky</span><span class="p">]</span>  <span class="k">for</span> <span class="n">ky</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">arms</span>  <span class="p">]</span>			  
	<span class="k">def</span> <span class="nf">info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>		
<span class="w">		</span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">		here goes basic info for the user about this model</span>
<span class="sd">		&#39;&#39;&#39;</span>					
		<span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Arm list&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">arms</span><span class="p">,</span> <span class="s1">&#39;Colour&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">armcolours</span><span class="p">}</span>
		<span class="n">dfmodlist</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">d</span><span class="p">)</span>
		<span class="nb">print</span><span class="p">(</span><span class="n">tabulate</span><span class="p">(</span><span class="n">dfmodlist</span><span class="p">,</span> <span class="n">headers</span> <span class="o">=</span> <span class="s1">&#39;keys&#39;</span><span class="p">,</span> <span class="n">tablefmt</span> <span class="o">=</span> <span class="s1">&#39;psql&#39;</span><span class="p">))</span>			        

	<span class="k">def</span> <span class="nf">output_</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">arm</span><span class="p">):</span>		
		
		<span class="n">xsun</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xsun</span>
		<span class="n">rsun</span> <span class="o">=</span> <span class="o">-</span><span class="n">xsun</span>	
		<span class="n">spirals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spirals</span>
		<span class="n">arms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">arms</span>
							
		<span class="c1"># XY positions</span>
		<span class="n">lnrsun</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">rsun</span><span class="p">)</span> 
			
		<span class="c1"># best phi range:</span>
		<span class="n">phi_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spirals</span><span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">][</span><span class="s1">&#39;phi_range&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()))</span>
		<span class="n">maxphi_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">([</span><span class="mi">60</span><span class="p">,</span><span class="o">-</span><span class="mi">120</span><span class="p">])</span> 
		
		<span class="n">pang</span> <span class="o">=</span> <span class="p">(</span><span class="n">spirals</span><span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">][</span><span class="s1">&#39;arm_attributes&#39;</span><span class="p">][</span><span class="n">arm</span><span class="p">][</span><span class="s1">&#39;arm_pang_strength&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">spirals</span><span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">][</span><span class="s1">&#39;arm_attributes&#39;</span><span class="p">][</span><span class="n">arm</span><span class="p">][</span><span class="s1">&#39;arm_pang_prom&#39;</span><span class="p">])</span><span class="o">/</span><span class="mf">2.</span>
		<span class="n">lnr0</span> <span class="o">=</span> <span class="p">(</span><span class="n">spirals</span><span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">][</span><span class="s1">&#39;arm_attributes&#39;</span><span class="p">][</span><span class="n">arm</span><span class="p">][</span><span class="s1">&#39;arm_lgr0_strength&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">spirals</span><span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">][</span><span class="s1">&#39;arm_attributes&#39;</span><span class="p">][</span><span class="n">arm</span><span class="p">][</span><span class="s1">&#39;arm_lgr0_prom&#39;</span><span class="p">])</span><span class="o">/</span><span class="mf">2.</span>
						
		<span class="n">phi</span><span class="o">=</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">51</span><span class="p">)</span><span class="o">/</span><span class="mf">50.</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">phi_range</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">phi_range</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  
		<span class="n">lgrarm</span> <span class="o">=</span> <span class="n">lnr0</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">pang</span><span class="p">))</span><span class="o">*</span><span class="n">phi</span> 		
		
		<span class="n">xgc</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">lgrarm</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">);</span> <span class="n">xhc</span> <span class="o">=</span> <span class="n">xgc</span> <span class="o">-</span> <span class="n">xsun</span>
		<span class="n">ygc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">lgrarm</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span> <span class="p">;</span>  <span class="n">yhc</span> <span class="o">=</span> <span class="n">ygc</span>
								
		<span class="c1"># extrapolate the arms</span>
		<span class="n">phi</span><span class="o">=</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">101</span><span class="p">)</span><span class="o">/</span><span class="mf">100.</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">maxphi_range</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">maxphi_range</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  
		<span class="n">lgrarm</span> <span class="o">=</span> <span class="n">lnr0</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">pang</span><span class="p">))</span><span class="o">*</span><span class="n">phi</span> 
		
		<span class="n">xgc_ex</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">lgrarm</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">);</span>  <span class="n">xhc_ex</span> <span class="o">=</span> <span class="n">xgc_ex</span> <span class="o">-</span> <span class="n">xsun</span>
		<span class="n">ygc_ex</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">lgrarm</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">);</span> <span class="n">yhc_ex</span> <span class="o">=</span> <span class="n">ygc_ex</span>
		<span class="n">lonarm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">lgrarm</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">rsun</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">lgrarm</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">)))</span> 
		
		<span class="n">rgc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">xgc</span><span class="o">**</span><span class="mf">2.</span> <span class="o">+</span> <span class="n">ygc</span><span class="o">**</span><span class="mf">2.</span><span class="p">)</span>
		<span class="n">rgc_ex</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">xgc_ex</span><span class="o">**</span><span class="mf">2.</span> <span class="o">+</span> <span class="n">ygc_ex</span><span class="o">**</span><span class="mf">2.</span><span class="p">)</span>
          
		<span class="bp">self</span><span class="o">.</span><span class="n">dout</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;xhc&#39;</span><span class="p">:</span><span class="n">xhc</span><span class="p">,</span><span class="s1">&#39;yhc&#39;</span><span class="p">:</span><span class="n">yhc</span><span class="p">,</span><span class="s1">&#39;xgc&#39;</span><span class="p">:</span><span class="n">xgc</span><span class="p">,</span><span class="s1">&#39;ygc&#39;</span><span class="p">:</span><span class="n">ygc</span><span class="p">,</span><span class="s1">&#39;xhc_ex&#39;</span><span class="p">:</span><span class="n">xhc_ex</span><span class="p">,</span><span class="s1">&#39;yhc_ex&#39;</span><span class="p">:</span><span class="n">yhc_ex</span><span class="p">,</span><span class="s1">&#39;xgc_ex&#39;</span><span class="p">:</span><span class="n">xgc_ex</span><span class="p">,</span><span class="s1">&#39;ygc_ex&#39;</span><span class="p">:</span><span class="n">ygc_ex</span><span class="p">}</span>			


<div class="viewcode-block" id="spiral_drimmel_nir">
<a class="viewcode-back" href="../../api.html#SpiralMap.models_.spiral_drimmel_nir">[docs]</a>
<span class="k">class</span> <span class="nc">spiral_drimmel_nir</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;Drimmel (2000) Near-Infrared (NIR) spiral arm model</span>
<span class="sd">	</span>
<span class="sd">	Implements the 2-arm spiral structure model from:</span>
<span class="sd">	Drimmel, R. (2000) &quot;Evidence for a two-armed spiral in the Milky Way&quot;</span>
<span class="sd">	using COBE/DIRBE near-infrared data. Includes main arms and phase-shifted interarms.</span>
<span class="sd">	</span>
<span class="sd">	Attributes</span>
<span class="sd">	----------</span>
<span class="sd">	arms : ndarray</span>
<span class="sd">		Array of arm identifiers [&#39;1_arm&#39;, &#39;2_arm&#39;, &#39;3_interarm&#39;, &#39;4_interarm&#39;]</span>
<span class="sd">	armcolour : dict</span>
<span class="sd">		Color mapping for visualization:</span>
<span class="sd">		- Main arms: black</span>
<span class="sd">		- Interarms: red	</span>
<span class="sd">	&quot;&quot;&quot;</span>
	<span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;Initialize Drimmel NIR spiral model with default parameters&quot;&quot;&quot;</span>
	 
		<span class="bp">self</span><span class="o">.</span><span class="n">loc</span> <span class="o">=</span> <span class="n">dataloc</span><span class="o">+</span><span class="s1">&#39;/Drimmel_NIR&#39;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">fname</span> <span class="o">=</span> <span class="s1">&#39;Drimmel2armspiral.fits&#39;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">getarmlist</span><span class="p">()</span>
<div class="viewcode-block" id="spiral_drimmel_nir.getarmlist">
<a class="viewcode-back" href="../../api.html#SpiralMap.models_.spiral_drimmel_nir.getarmlist">[docs]</a>
	<span class="k">def</span> <span class="nf">getarmlist</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;Set arm names and colours&quot;&quot;&quot;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">arms</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;1_arm&#39;</span><span class="p">,</span><span class="s1">&#39;2_arm&#39;</span><span class="p">,</span><span class="s1">&#39;3_interarm&#39;</span><span class="p">,</span><span class="s1">&#39;4_interarm&#39;</span><span class="p">])</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">armcolour</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;1_arm&#39;</span><span class="p">:</span><span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="s1">&#39;2_arm&#39;</span><span class="p">:</span><span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="s1">&#39;3_interarm&#39;</span><span class="p">:</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="s1">&#39;4_interarm&#39;</span><span class="p">:</span><span class="s1">&#39;red&#39;</span><span class="p">}</span>		
		<span class="bp">self</span><span class="o">.</span><span class="n">armcolours</span><span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">armcolour</span><span class="p">[</span><span class="n">ky</span><span class="p">]</span>  <span class="k">for</span> <span class="n">ky</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">arms</span>  <span class="p">]</span>			</div>

	<span class="k">def</span> <span class="nf">info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>		
		<span class="c1"># &quot;&quot;&quot;Display basic model information and arm components.&quot;&quot;&quot;	</span>
		<span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Arm list&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">arms</span><span class="p">,</span> <span class="s1">&#39;Colour&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">armcolours</span><span class="p">}</span>
		<span class="n">dfmodlist</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>			
		<span class="nb">print</span><span class="p">(</span><span class="n">tabulate</span><span class="p">(</span><span class="n">dfmodlist</span><span class="p">,</span> <span class="n">headers</span> <span class="o">=</span> <span class="s1">&#39;keys&#39;</span><span class="p">,</span> <span class="n">tablefmt</span> <span class="o">=</span> <span class="s1">&#39;psql&#39;</span><span class="p">))</span>		
	        
<div class="viewcode-block" id="spiral_drimmel_nir.getdata">
<a class="viewcode-back" href="../../api.html#SpiralMap.models_.spiral_drimmel_nir.getdata">[docs]</a>
	<span class="k">def</span> <span class="nf">getdata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;Load and preprocess spiral arm data from FITS file.</span>
<span class="sd">		</span>
<span class="sd">		1. Loads base FITS data</span>
<span class="sd">		</span>
<span class="sd">		2. Scales coordinates using solar position</span>
<span class="sd">		</span>
<span class="sd">		3. Adds phase-shifted interarm components</span>
<span class="sd">		</span>
<span class="sd">		4. Calculates galactocentric radii</span>
<span class="sd">		</span>
<span class="sd">		Notes</span>
<span class="sd">		-----</span>
<span class="sd">		- Original data scaled by solar galactocentric distance</span>
<span class="sd">		- Phase-shifted arms loaded from separate numpy files</span>
<span class="sd">		&quot;&quot;&quot;</span>
	
		<span class="n">dt</span> <span class="o">=</span> <span class="n">fitsread</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">loc</span><span class="o">+</span><span class="s1">&#39;/&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">fname</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">data0</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
		
		<span class="n">xsun</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xsun</span>					
			
		<span class="c1"># rescaling to |xsun|</span>
		<span class="n">qnts</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;rgc1&#39;</span><span class="p">,</span><span class="s1">&#39;xhc1&#39;</span><span class="p">,</span><span class="s1">&#39;yhc1&#39;</span><span class="p">,</span><span class="s1">&#39;rgc2&#39;</span><span class="p">,</span><span class="s1">&#39;xhc2&#39;</span><span class="p">,</span><span class="s1">&#39;yhc2&#39;</span><span class="p">]</span>
		<span class="k">for</span> <span class="n">qnt</span> <span class="ow">in</span> <span class="n">qnts</span><span class="p">:</span>
			<span class="n">dt</span><span class="p">[</span><span class="n">qnt</span><span class="p">]</span> <span class="o">=</span> <span class="n">dt</span><span class="p">[</span><span class="n">qnt</span><span class="p">]</span><span class="o">*</span><span class="nb">abs</span><span class="p">(</span><span class="n">xsun</span><span class="p">)</span>			        
		<span class="c1">#----- add phase-shifted arms as `3` and `4`    </span>
		<span class="n">dloc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loc</span><span class="o">+</span><span class="s1">&#39;/phase_shifted&#39;</span>
		<span class="k">for</span> <span class="n">inum</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]:</span>
			<span class="n">dt</span><span class="p">[</span><span class="s1">&#39;xhc&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">inum</span><span class="p">)]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">dloc</span><span class="o">+</span><span class="s1">&#39;/Arm&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">inum</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;_X_hel.npy&#39;</span><span class="p">)</span>
			<span class="n">dt</span><span class="p">[</span><span class="s1">&#39;yhc&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">inum</span><span class="p">)]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">dloc</span><span class="o">+</span><span class="s1">&#39;/Arm&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">inum</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;_Y_hel.npy&#39;</span><span class="p">)</span>
			<span class="n">dt</span><span class="p">[</span><span class="s1">&#39;rgc&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">inum</span><span class="p">)]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span> <span class="p">((</span><span class="n">dt</span><span class="p">[</span><span class="s1">&#39;xhc&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">inum</span><span class="p">)]</span> <span class="o">+</span> <span class="n">xsun</span><span class="p">)</span><span class="o">**</span><span class="mf">2.</span><span class="p">)</span> <span class="o">+</span> <span class="p">((</span><span class="n">dt</span><span class="p">[</span><span class="s1">&#39;yhc&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">inum</span><span class="p">)])</span><span class="o">**</span><span class="mf">2.</span><span class="p">)</span> <span class="p">)</span>       
		<span class="c1">#------------------       </span>
		
		<span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
	
		<span class="k">return</span> </div>

<div class="viewcode-block" id="spiral_drimmel_nir.output_">
<a class="viewcode-back" href="../../api.html#SpiralMap.models_.spiral_drimmel_nir.output_">[docs]</a>
	<span class="k">def</span> <span class="nf">output_</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">arm</span><span class="p">):</span>			
<span class="w">		</span><span class="sd">&quot;&quot;&quot;Retrieve spiral arm coordinates in specified format.</span>
<span class="sd">		</span>
<span class="sd">		Parameters</span>
<span class="sd">		----------</span>
<span class="sd">		arm : str</span>
<span class="sd">			Arm identifier or selection mode:</span>
<span class="sd">			- &#39;1&#39;, &#39;2&#39; for main arms</span>
<span class="sd">			- &#39;3&#39;, &#39;4&#39; for interarms </span>
<span class="sd">			- &#39;all&#39; for all components</span>
<span class="sd">			- &#39;main&#39; for just main arms</span>
<span class="sd">		typ_ : {&#39;cartesian&#39;, &#39;polar&#39;, &#39;polargrid&#39;}, default &#39;cartesian&#39;</span>
<span class="sd">			Output format:</span>
<span class="sd">			- cartesian: Returns x,y coordinates</span>
<span class="sd">			- polar/polargrid: Generates polar coordinate plots</span>
<span class="sd">	</span>
<span class="sd">		Returns</span>
<span class="sd">		-------</span>
<span class="sd">		dict</span>
<span class="sd">			For cartesian type contains:</span>
<span class="sd">			- xhc, yhc: Heliocentric coordinates (kpc)</span>
<span class="sd">			- xgc, ygc: Galactocentric coordinates (kpc)</span>
<span class="sd">			</span>
<span class="sd">		Notes</span>
<span class="sd">		-----</span>
<span class="sd">		Polar modes create matplotlib plots directly using:</span>
<span class="sd">		- phi1: Angle from negative x-axis (GC frame)</span>
<span class="sd">		- phi4: Galactic longitude (0-360 degrees)</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="n">xsun</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xsun</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">getdata</span><span class="p">()</span>
		<span class="n">dt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>  
					
		<span class="n">numbs</span> <span class="o">=</span> <span class="p">[</span><span class="n">arm</span><span class="p">]</span>
		<span class="k">if</span> <span class="n">arm</span> <span class="o">==</span> <span class="s1">&#39;all&#39;</span><span class="p">:</span>
			<span class="n">numbs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">arms</span>
		<span class="k">elif</span> <span class="n">arm</span> <span class="o">==</span> <span class="s1">&#39;main&#39;</span><span class="p">:</span>
			<span class="n">numbs</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span><span class="s1">&#39;2&#39;</span><span class="p">]</span>		
		
		<span class="bp">self</span><span class="o">.</span><span class="n">dused</span> <span class="o">=</span> <span class="p">{}</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">dused</span><span class="p">[</span><span class="s1">&#39;rgc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">dused</span><span class="p">[</span><span class="s1">&#39;xgc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">dused</span><span class="p">[</span><span class="s1">&#39;yhc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">dused</span><span class="p">[</span><span class="s1">&#39;phi1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">dused</span><span class="p">[</span><span class="s1">&#39;phi4&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
	
		<span class="k">for</span> <span class="n">numb1</span> <span class="ow">in</span> <span class="n">numbs</span><span class="p">:</span>	
			<span class="n">numb</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">numb1</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]))</span>	            
			<span class="n">xhc</span> <span class="o">=</span> <span class="n">dt</span><span class="p">[</span><span class="s1">&#39;xhc&#39;</span><span class="o">+</span><span class="n">numb</span><span class="p">]</span>
			<span class="n">yhc</span> <span class="o">=</span> <span class="n">dt</span><span class="p">[</span><span class="s1">&#39;yhc&#39;</span><span class="o">+</span><span class="n">numb</span><span class="p">]</span>
			<span class="n">rgc</span> <span class="o">=</span> <span class="n">dt</span><span class="p">[</span><span class="s1">&#39;rgc&#39;</span><span class="o">+</span><span class="n">numb</span><span class="p">]</span>            
			<span class="n">xgc</span> <span class="o">=</span> <span class="n">xhc</span> <span class="o">+</span> <span class="n">xsun</span>			
			<span class="n">ygc</span> <span class="o">=</span> <span class="n">yhc</span>                     
			<span class="bp">self</span><span class="o">.</span><span class="n">dout</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;xhc&#39;</span><span class="p">:</span><span class="n">xhc</span><span class="p">,</span><span class="s1">&#39;yhc&#39;</span><span class="p">:</span><span class="n">yhc</span><span class="p">,</span><span class="s1">&#39;xgc&#39;</span><span class="p">:</span><span class="n">xgc</span><span class="p">,</span><span class="s1">&#39;ygc&#39;</span><span class="p">:</span><span class="n">ygc</span><span class="p">}</span>					</div>
</div>



<div class="viewcode-block" id="reid_spiral">
<a class="viewcode-back" href="../../api.html#SpiralMap.models_.reid_spiral">[docs]</a>
<span class="k">class</span> <span class="nc">reid_spiral</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;Reid et al. (2019) kinked logarithmic spiral arm model</span>
<span class="sd">	</span>
<span class="sd">	Implements the Milky Way spiral structure model from:</span>
<span class="sd">	&quot;Trigonometric Parallaxes of High Mass Star Forming Regions: The Structure and Kinematics of the Milky Way&quot;</span>
<span class="sd">	using kinked logarithmic spirals with varying pitch angles. Models 7 major arm features.</span>
<span class="sd">	</span>
<span class="sd">	Attributes</span>
<span class="sd">	----------</span>
<span class="sd">	arms : ndarray</span>
<span class="sd">		Array of arm identifiers [&#39;3-kpc&#39;, &#39;Norma&#39;, &#39;Sct-Cen&#39;, &#39;Sgr-Car&#39;, &#39;Local&#39;, &#39;Perseus&#39;, &#39;Outer&#39;]	</span>
<span class="sd">	&quot;&quot;&quot;</span>
	
	<span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kcor</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;Initialize Reid et al. (2019) spiral model</span>
<span class="sd">		</span>
<span class="sd">		Parameters</span>
<span class="sd">		----------</span>
<span class="sd">		kcor : bool, optional</span>
<span class="sd">			Apply distance correction adjustment to R_kink parameters,</span>
<span class="sd">			default=False</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">kcor</span> <span class="o">=</span> <span class="n">kcor</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">getarmlist</span><span class="p">()</span>		
<div class="viewcode-block" id="reid_spiral.getarmlist">
<a class="viewcode-back" href="../../api.html#SpiralMap.models_.reid_spiral.getarmlist">[docs]</a>
	<span class="k">def</span> <span class="nf">getarmlist</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>	
<span class="w">		</span><span class="sd">&quot;&quot;&quot;Set arm names and colours&quot;&quot;&quot;</span>			
		<span class="bp">self</span><span class="o">.</span><span class="n">arms</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;3-kpc&#39;</span><span class="p">,</span><span class="s1">&#39;Norma&#39;</span><span class="p">,</span><span class="s1">&#39;Sct-Cen&#39;</span><span class="p">,</span><span class="s1">&#39;Sgr-Car&#39;</span><span class="p">,</span><span class="s1">&#39;Local&#39;</span><span class="p">,</span><span class="s1">&#39;Perseus&#39;</span><span class="p">,</span><span class="s1">&#39;Outer&#39;</span><span class="p">])</span>      				
		<span class="bp">self</span><span class="o">.</span><span class="n">armcolour</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;3-kpc&#39;</span><span class="p">:</span><span class="s1">&#39;C6&#39;</span><span class="p">,</span><span class="s1">&#39;Norma&#39;</span><span class="p">:</span><span class="s1">&#39;C5&#39;</span><span class="p">,</span><span class="s1">&#39;Sct-Cen&#39;</span><span class="p">:</span><span class="s1">&#39;C4&#39;</span><span class="p">,</span>
		                  <span class="s1">&#39;Sgr-Car&#39;</span><span class="p">:</span><span class="s1">&#39;C3&#39;</span><span class="p">,</span><span class="s1">&#39;Local&#39;</span><span class="p">:</span><span class="s1">&#39;C2&#39;</span><span class="p">,</span><span class="s1">&#39;Perseus&#39;</span><span class="p">:</span><span class="s1">&#39;C1&#39;</span><span class="p">,</span>
		                  <span class="s1">&#39;Outer&#39;</span><span class="p">:</span><span class="s1">&#39;C0&#39;</span><span class="p">}</span>	
		<span class="bp">self</span><span class="o">.</span><span class="n">armcolours</span><span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">armcolour</span><span class="p">[</span><span class="n">ky</span><span class="p">]</span>  <span class="k">for</span> <span class="n">ky</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">arms</span>  <span class="p">]</span>			                  	  		</div>

	<span class="k">def</span> <span class="nf">info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>		
		<span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Arm list&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">arms</span><span class="p">,</span> <span class="s1">&#39;Colour&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">armcolours</span><span class="p">}</span>
		<span class="n">dfmodlist</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>			
		<span class="nb">print</span><span class="p">(</span><span class="n">tabulate</span><span class="p">(</span><span class="n">dfmodlist</span><span class="p">,</span> <span class="n">headers</span> <span class="o">=</span> <span class="s1">&#39;keys&#39;</span><span class="p">,</span> <span class="n">tablefmt</span> <span class="o">=</span> <span class="s1">&#39;psql&#39;</span><span class="p">))</span>				
		
<div class="viewcode-block" id="reid_spiral.getparams">
<a class="viewcode-back" href="../../api.html#SpiralMap.models_.reid_spiral.getparams">[docs]</a>
	<span class="k">def</span> <span class="nf">getparams</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">arm</span><span class="p">):</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;Load spiral parameters for specified arm from Reid et al. (2019) Table 4.</span>
<span class="sd">		</span>
<span class="sd">		Parameters</span>
<span class="sd">		----------</span>
<span class="sd">		arm : str</span>
<span class="sd">			Valid arm identifier from class arms list</span>
<span class="sd">	</span>
<span class="sd">		Returns</span>
<span class="sd">		-------</span>
<span class="sd">		dict</span>
<span class="sd">			Dictionary containing:</span>
<span class="sd">			- beta_kink: Kink angle position in degrees</span>
<span class="sd">			</span>
<span class="sd">			- pitch_low: Pitch angle before kink (degrees)</span>
<span class="sd">			</span>
<span class="sd">			- pitch_high: Pitch angle after kink (degrees)</span>
<span class="sd">			</span>
<span class="sd">			- R_kink: Galactocentric radius at kink (kpc)</span>
<span class="sd">			</span>
<span class="sd">			- beta_min/max: Angular range in degrees</span>
<span class="sd">			</span>
<span class="sd">			- width: Arm width parameter (kpc)</span>
<span class="sd">	</span>
<span class="sd">		Notes</span>
<span class="sd">		-----</span>
<span class="sd">		Applies correction to R_kink if kcor=True during initialization</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="k">if</span> <span class="n">arm</span> <span class="o">==</span> <span class="s1">&#39;3-kpc&#39;</span><span class="p">:</span>
			<span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span><span class="n">arm</span><span class="p">,</span><span class="s1">&#39;beta_kink&#39;</span><span class="p">:</span><span class="mi">15</span><span class="p">,</span>
					  <span class="s1">&#39;pitch_low&#39;</span><span class="p">:</span><span class="o">-</span><span class="mf">4.2</span><span class="p">,</span><span class="s1">&#39;pitch_high&#39;</span><span class="p">:</span><span class="o">-</span><span class="mf">4.2</span><span class="p">,</span>
					  <span class="s1">&#39;R_kink&#39;</span><span class="p">:</span><span class="mf">3.52</span><span class="p">,</span><span class="s1">&#39;beta_min&#39;</span><span class="p">:</span><span class="mi">15</span><span class="p">,</span>
					  <span class="s1">&#39;beta_max&#39;</span><span class="p">:</span><span class="mi">18</span><span class="p">,</span><span class="s1">&#39;width&#39;</span><span class="p">:</span><span class="mf">0.18</span><span class="p">}</span>
		<span class="k">if</span> <span class="n">arm</span> <span class="o">==</span> <span class="s1">&#39;Norma&#39;</span><span class="p">:</span>
			<span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span><span class="n">arm</span><span class="p">,</span><span class="s1">&#39;beta_kink&#39;</span><span class="p">:</span><span class="mi">18</span><span class="p">,</span><span class="s1">&#39;pitch_low&#39;</span><span class="p">:</span><span class="o">-</span><span class="mf">1.</span><span class="p">,</span>
			          <span class="s1">&#39;pitch_high&#39;</span><span class="p">:</span><span class="mf">19.5</span><span class="p">,</span><span class="s1">&#39;R_kink&#39;</span><span class="p">:</span><span class="mf">4.46</span><span class="p">,</span><span class="s1">&#39;beta_min&#39;</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span>
			          <span class="s1">&#39;beta_max&#39;</span><span class="p">:</span><span class="mi">54</span><span class="p">,</span><span class="s1">&#39;width&#39;</span><span class="p">:</span><span class="mf">0.14</span><span class="p">}</span>
		<span class="k">if</span> <span class="n">arm</span> <span class="o">==</span> <span class="s1">&#39;Sct-Cen&#39;</span><span class="p">:</span>
			<span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span><span class="n">arm</span><span class="p">,</span><span class="s1">&#39;beta_kink&#39;</span><span class="p">:</span><span class="mi">23</span><span class="p">,</span><span class="s1">&#39;pitch_low&#39;</span><span class="p">:</span><span class="mf">14.1</span><span class="p">,</span>
			          <span class="s1">&#39;pitch_high&#39;</span><span class="p">:</span><span class="mf">12.1</span><span class="p">,</span><span class="s1">&#39;R_kink&#39;</span><span class="p">:</span><span class="mf">4.91</span><span class="p">,</span><span class="s1">&#39;beta_min&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
			          <span class="s1">&#39;beta_max&#39;</span><span class="p">:</span><span class="mi">104</span><span class="p">,</span><span class="s1">&#39;width&#39;</span><span class="p">:</span><span class="mf">0.23</span><span class="p">}</span>
		<span class="k">if</span> <span class="n">arm</span> <span class="o">==</span> <span class="s1">&#39;Sgr-Car&#39;</span><span class="p">:</span> <span class="c1">#&#39;Sgr-Car&#39;</span>
			<span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span><span class="n">arm</span><span class="p">,</span><span class="s1">&#39;beta_kink&#39;</span><span class="p">:</span><span class="mi">24</span><span class="p">,</span><span class="s1">&#39;pitch_low&#39;</span><span class="p">:</span><span class="mf">17.1</span><span class="p">,</span>
			          <span class="s1">&#39;pitch_high&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;R_kink&#39;</span><span class="p">:</span><span class="mf">6.04</span><span class="p">,</span><span class="s1">&#39;beta_min&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span>
			          <span class="s1">&#39;beta_max&#39;</span><span class="p">:</span><span class="mi">97</span><span class="p">,</span><span class="s1">&#39;width&#39;</span><span class="p">:</span><span class="mf">0.27</span><span class="p">}</span>
		<span class="k">if</span> <span class="n">arm</span> <span class="o">==</span> <span class="s1">&#39;Local&#39;</span><span class="p">:</span>
			<span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span><span class="n">arm</span><span class="p">,</span><span class="s1">&#39;beta_kink&#39;</span><span class="p">:</span><span class="mi">9</span><span class="p">,</span><span class="s1">&#39;pitch_low&#39;</span><span class="p">:</span><span class="mf">11.4</span><span class="p">,</span>
			          <span class="s1">&#39;pitch_high&#39;</span><span class="p">:</span><span class="mf">11.4</span><span class="p">,</span><span class="s1">&#39;R_kink&#39;</span><span class="p">:</span><span class="mf">8.26</span><span class="p">,</span><span class="s1">&#39;beta_min&#39;</span><span class="p">:</span><span class="o">-</span><span class="mi">8</span><span class="p">,</span>
			          <span class="s1">&#39;beta_max&#39;</span><span class="p">:</span><span class="mi">34</span><span class="p">,</span><span class="s1">&#39;width&#39;</span><span class="p">:</span><span class="mf">0.31</span><span class="p">}</span>
		<span class="k">if</span> <span class="n">arm</span> <span class="o">==</span> <span class="s1">&#39;Perseus&#39;</span><span class="p">:</span>
			<span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span><span class="n">arm</span><span class="p">,</span><span class="s1">&#39;beta_kink&#39;</span><span class="p">:</span><span class="mi">40</span><span class="p">,</span><span class="s1">&#39;pitch_low&#39;</span><span class="p">:</span><span class="mf">10.3</span><span class="p">,</span>
			          <span class="s1">&#39;pitch_high&#39;</span><span class="p">:</span><span class="mf">8.7</span><span class="p">,</span><span class="s1">&#39;R_kink&#39;</span><span class="p">:</span><span class="mf">8.87</span><span class="p">,</span><span class="s1">&#39;beta_min&#39;</span><span class="p">:</span><span class="o">-</span><span class="mi">23</span><span class="p">,</span>
			          <span class="s1">&#39;beta_max&#39;</span><span class="p">:</span><span class="mi">115</span><span class="p">,</span><span class="s1">&#39;width&#39;</span><span class="p">:</span><span class="mf">0.35</span><span class="p">}</span>
		<span class="k">if</span> <span class="n">arm</span> <span class="o">==</span> <span class="s1">&#39;Outer&#39;</span><span class="p">:</span>
			<span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span><span class="n">arm</span><span class="p">,</span><span class="s1">&#39;beta_kink&#39;</span><span class="p">:</span><span class="mi">18</span><span class="p">,</span><span class="s1">&#39;pitch_low&#39;</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span>
			          <span class="s1">&#39;pitch_high&#39;</span><span class="p">:</span><span class="mf">9.4</span><span class="p">,</span><span class="s1">&#39;R_kink&#39;</span><span class="p">:</span><span class="mf">12.24</span><span class="p">,</span><span class="s1">&#39;beta_min&#39;</span><span class="p">:</span><span class="o">-</span><span class="mi">16</span><span class="p">,</span>
			          <span class="s1">&#39;beta_max&#39;</span><span class="p">:</span><span class="mi">71</span><span class="p">,</span><span class="s1">&#39;width&#39;</span><span class="p">:</span><span class="mf">0.65</span><span class="p">}</span>				
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kcor</span><span class="p">:</span>
			<span class="n">Rreid</span> <span class="o">=</span> <span class="mf">8.15</span>
			<span class="n">diffval</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;R_kink&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">Rreid</span>
			<span class="n">xsun</span> <span class="o">=</span> <span class="n">get_lsr</span><span class="p">()[</span><span class="s1">&#39;xsun&#39;</span><span class="p">]</span>
			<span class="k">if</span> <span class="n">diffval</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
				 <span class="n">params</span><span class="p">[</span><span class="s1">&#39;R_kink&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">xsun</span><span class="p">)</span> <span class="o">+</span> <span class="n">diffval</span>
			<span class="k">else</span><span class="p">:</span>
				 <span class="n">params</span><span class="p">[</span><span class="s1">&#39;R_kink&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">xsun</span><span class="p">)</span> <span class="o">+</span> <span class="n">diffval</span>							
		<span class="k">return</span> <span class="n">params</span></div>

	
<div class="viewcode-block" id="reid_spiral.model_">
<a class="viewcode-back" href="../../api.html#SpiralMap.models_.reid_spiral.model_">[docs]</a>
	<span class="k">def</span> <span class="nf">model_</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">params</span><span class="p">):</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;Generate kinked logarithmic spiral coordinates.</span>
<span class="sd">		</span>
<span class="sd">		Parameters</span>
<span class="sd">		----------</span>
<span class="sd">		params : dict</span>
<span class="sd">			Spiral parameters dictionary from getparams()</span>
<span class="sd">	</span>
<span class="sd">		Returns</span>
<span class="sd">		-------</span>
<span class="sd">		tuple</span>
<span class="sd">			(x, y, x1, y1, x2, y2) coordinate arrays where:</span>
<span class="sd">			</span>
<span class="sd">			- x,y: Arm center coordinates (GC)</span>
<span class="sd">			</span>
<span class="sd">			- x1,y1: Inner arm boundary</span>
<span class="sd">			</span>
<span class="sd">			- x2,y2: Outer arm boundary</span>
<span class="sd">	</span>
<span class="sd">		Notes</span>
<span class="sd">		-----</span>
<span class="sd">		Implements modified logarithmic spiral equation with pitch angle kink:</span>
<span class="sd">		R(β) = R_kink * exp[-(β - β_kink) * tan(pitch)]</span>
<span class="sd">		where pitch changes at β_kink</span>
<span class="sd">		&quot;&quot;&quot;</span>
		
		<span class="n">beta_kink</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;beta_kink&#39;</span><span class="p">])</span>
		<span class="n">pitch_low</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;pitch_low&#39;</span><span class="p">])</span>
		<span class="n">pitch_high</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;pitch_high&#39;</span><span class="p">])</span>
		<span class="n">R_kink</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;R_kink&#39;</span><span class="p">]</span>
		<span class="n">beta_min</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;beta_min&#39;</span><span class="p">]</span>
		<span class="n">beta_max</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;beta_max&#39;</span><span class="p">]</span>
		<span class="n">width</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;width&#39;</span><span class="p">]</span>
				
		<span class="n">beta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">beta_min</span><span class="p">,</span><span class="n">beta_max</span><span class="p">,</span><span class="mi">1000</span><span class="p">)</span>		
		<span class="n">beta_min</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">beta_min</span><span class="p">)</span>
		<span class="n">beta_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">beta_max</span><span class="p">)</span>
		<span class="n">beta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">beta</span><span class="p">)</span>	
				
		<span class="n">pitch</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">beta</span><span class="o">.</span><span class="n">size</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
		<span class="n">indl</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">beta</span><span class="o">&lt;</span><span class="n">beta_kink</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span> <span class="n">pitch</span><span class="p">[</span><span class="n">indl</span><span class="p">]</span> <span class="o">=</span> <span class="n">pitch_low</span>
		<span class="n">indr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">beta</span><span class="o">&gt;</span><span class="n">beta_kink</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span> <span class="n">pitch</span><span class="p">[</span><span class="n">indr</span><span class="p">]</span> <span class="o">=</span> <span class="n">pitch_high</span>
		
		<span class="n">tmp1</span> <span class="o">=</span> <span class="p">(</span><span class="n">beta</span> <span class="o">-</span> <span class="n">beta_kink</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">pitch</span><span class="p">))</span>
		<span class="n">tmp2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">tmp1</span><span class="p">)</span>
				
		<span class="n">R</span> <span class="o">=</span> <span class="n">R_kink</span><span class="o">*</span><span class="n">tmp2</span>
		<span class="n">x</span> <span class="o">=</span> <span class="o">-</span><span class="n">R</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">beta</span><span class="p">))</span>
		<span class="n">y</span> <span class="o">=</span> <span class="n">R</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">beta</span><span class="p">))</span>
	
		<span class="n">R2</span> <span class="o">=</span> <span class="p">(</span><span class="n">R_kink</span><span class="o">+</span><span class="p">(</span><span class="n">width</span><span class="o">*</span><span class="mf">0.5</span><span class="p">))</span><span class="o">*</span><span class="n">tmp2</span>
		<span class="n">x2</span> <span class="o">=</span> <span class="o">-</span><span class="n">R2</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">beta</span><span class="p">))</span>
		<span class="n">y2</span> <span class="o">=</span> <span class="n">R2</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">beta</span><span class="p">))</span>
	
		<span class="n">R1</span> <span class="o">=</span> <span class="p">(</span><span class="n">R_kink</span><span class="o">-</span><span class="p">(</span><span class="n">width</span><span class="o">*</span><span class="mf">0.5</span><span class="p">))</span><span class="o">*</span><span class="n">tmp2</span>
		<span class="n">x1</span> <span class="o">=</span> <span class="o">-</span><span class="n">R1</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">beta</span><span class="p">))</span>
		<span class="n">y1</span> <span class="o">=</span> <span class="n">R1</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">beta</span><span class="p">))</span>
						
		<span class="k">return</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span><span class="n">y1</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">y2</span>	</div>

<div class="viewcode-block" id="reid_spiral.output_">
<a class="viewcode-back" href="../../api.html#SpiralMap.models_.reid_spiral.output_">[docs]</a>
	<span class="k">def</span> <span class="nf">output_</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">arm</span><span class="p">):</span>		
<span class="w">		</span><span class="sd">&quot;&quot;&quot;			</span>
<span class="sd">		   Get arm coordinates in structured format.</span>
<span class="sd">		</span>
<span class="sd">		   :param arm: Arm identifier (e.g., &#39;Norma&#39;)		</span>
<span class="sd">		   :type arm: String </span>
<span class="sd">		   :return: self.dout = {&#39;xhc&#39;:xhc,&#39;yhc&#39;:yhc,&#39;xgc&#39;:xgc,&#39;ygc&#39;:ygc}</span>
<span class="sd">		   :rtype: dict </span>
<span class="sd">		&quot;&quot;&quot;</span>		
		
		<span class="n">xsun</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xsun</span>
		<span class="n">params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getparams</span><span class="p">(</span><span class="n">arm</span><span class="p">)</span>		
		
		<span class="n">xgc</span><span class="p">,</span><span class="n">ygc</span><span class="p">,</span><span class="n">xgc1</span><span class="p">,</span><span class="n">ygc1</span><span class="p">,</span><span class="n">xgc2</span><span class="p">,</span><span class="n">ygc2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_</span><span class="p">(</span><span class="n">params</span><span class="p">);</span>			
		<span class="n">xhc</span> <span class="o">=</span> <span class="n">xgc</span> <span class="o">-</span> <span class="n">xsun</span>
		<span class="n">xhc1</span> <span class="o">=</span> <span class="n">xgc1</span> <span class="o">-</span> <span class="n">xsun</span>
		<span class="n">xhc2</span> <span class="o">=</span> <span class="n">xgc2</span> <span class="o">-</span> <span class="n">xsun</span>	
		<span class="n">yhc</span> <span class="o">=</span> <span class="n">ygc</span>			
		<span class="bp">self</span><span class="o">.</span><span class="n">dout</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;xhc&#39;</span><span class="p">:</span><span class="n">xhc</span><span class="p">,</span><span class="s1">&#39;yhc&#39;</span><span class="p">:</span><span class="n">yhc</span><span class="p">,</span><span class="s1">&#39;xgc&#39;</span><span class="p">:</span><span class="n">xgc</span><span class="p">,</span><span class="s1">&#39;ygc&#39;</span><span class="p">:</span><span class="n">ygc</span><span class="p">}</span>													</div>
</div>



<div class="viewcode-block" id="main_">
<a class="viewcode-back" href="../../api.html#SpiralMap.models_.main_">[docs]</a>
<span class="k">class</span> <span class="nc">main_</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>	
<span class="w">	</span><span class="sd">&quot;&quot;&quot;	</span>
<span class="sd">	The main executor that calls the individual models to grab the spiral traces.</span>
<span class="sd">	It is also used to set plot preferences and make plots.		</span>
<span class="sd">	&quot;&quot;&quot;</span>
	<span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Rsun</span><span class="o">=</span><span class="mf">8.277</span><span class="p">,</span><span class="n">print_</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>  		
<span class="w">		</span><span class="sd">&quot;&quot;&quot;			</span>
<span class="sd">		   Initialize main object.</span>
<span class="sd">		</span>
<span class="sd">		   :param Rsun: Optional - Galactocentric R(kpc) of the Sun, default=8.277.	</span>
<span class="sd">		   :type Rsun: float </span>
<span class="sd">		   :param print\_: Optional - if set to False does not print to screen.</span>
<span class="sd">		   :type print\_: Boolean </span>
<span class="sd">		&quot;&quot;&quot;</span>		
		 		   		 	
		<span class="bp">self</span><span class="o">.</span><span class="n">root_</span> <span class="o">=</span> <span class="n">root_</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">dataloc</span> <span class="o">=</span> <span class="n">dataloc</span>        
		<span class="bp">self</span><span class="o">.</span><span class="n">xsun</span> <span class="o">=</span> <span class="o">-</span><span class="n">Rsun</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">Rsun</span> <span class="o">=</span> <span class="n">Rsun</span>        
		<span class="bp">self</span><span class="o">.</span><span class="n">listmodels</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">getinfo</span><span class="p">(</span><span class="n">print_</span><span class="o">=</span><span class="n">print_</span><span class="p">)</span>	    
		
		<span class="bp">self</span><span class="o">.</span><span class="n">modrec</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">armrec</span> <span class="o">=</span> <span class="p">[]</span>
<div class="viewcode-block" id="main_.listmodels">
<a class="viewcode-back" href="../../api.html#SpiralMap.models_.main_.listmodels">[docs]</a>
	<span class="k">def</span> <span class="nf">listmodels</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  
<span class="w">		</span><span class="sd">&quot;&quot;&quot;			</span>
<span class="sd">		   	Defines list of available models/maps</span>
<span class="sd">		   	Constructs dictionaries to initialise individual model classes</span>
<span class="sd">		&quot;&quot;&quot;</span>	
		   		
		<span class="bp">self</span><span class="o">.</span><span class="n">models</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Taylor_Cordes_1992&#39;</span><span class="p">,</span><span class="s1">&#39;Drimmel_NIR_2000&#39;</span><span class="p">,</span>
					   <span class="s1">&#39;Levine_2006&#39;</span><span class="p">,</span><span class="s1">&#39;Hou_Han_2014&#39;</span><span class="p">,</span><span class="s1">&#39;Reid_2019&#39;</span><span class="p">,</span>
					   <span class="s1">&#39;Poggio_cont_2021&#39;</span><span class="p">,</span><span class="s1">&#39;GaiaPVP_cont_2022&#39;</span><span class="p">,</span><span class="s1">&#39;Drimmel_Ceph_2024&#39;</span><span class="p">]</span>        
		<span class="bp">self</span><span class="o">.</span><span class="n">models_class</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Reid_2019&#39;</span><span class="p">:</span><span class="n">reid_spiral</span><span class="p">(),</span>
							 <span class="s1">&#39;Levine_2006&#39;</span><span class="p">:</span><span class="n">spiral_levine</span><span class="p">(),</span>
							 <span class="s1">&#39;Poggio_cont_2021&#39;</span><span class="p">:</span><span class="n">spiral_poggio_maps</span><span class="p">(</span><span class="n">model_</span><span class="o">=</span><span class="s1">&#39;Poggio_cont_2021&#39;</span><span class="p">),</span>
							 <span class="s1">&#39;GaiaPVP_cont_2022&#39;</span><span class="p">:</span><span class="n">spiral_poggio_maps</span><span class="p">(</span><span class="n">model_</span><span class="o">=</span><span class="s1">&#39;GaiaPVP_cont_2022&#39;</span><span class="p">),</span>
							 <span class="s1">&#39;Drimmel_NIR_2000&#39;</span><span class="p">:</span><span class="n">spiral_drimmel_nir</span><span class="p">(),</span>
							 <span class="s1">&#39;Taylor_Cordes_1992&#39;</span><span class="p">:</span><span class="n">TaylorCordesSpiral</span><span class="p">(),</span>
							 <span class="s1">&#39;Hou_Han_2014&#39;</span><span class="p">:</span><span class="n">spiral_houhan</span><span class="p">(),</span>
							 <span class="s1">&#39;Drimmel_Ceph_2024&#39;</span><span class="p">:</span><span class="n">spiral_drimmel_cepheids</span><span class="p">()}</span>
							 
		<span class="bp">self</span><span class="o">.</span><span class="n">models_desc</span> <span class="o">=</span> 	<span class="p">[</span><span class="s1">&#39;HII&#39;</span><span class="p">,</span><span class="s1">&#39;NIR emission&#39;</span><span class="p">,</span>
					   <span class="s1">&#39;HI&#39;</span><span class="p">,</span><span class="s1">&#39;HII/GMC/Masers&#39;</span><span class="p">,</span><span class="s1">&#39;MASER parallax&#39;</span><span class="p">,</span>
					   <span class="s1">&#39;Upper main sequence (map)&#39;</span><span class="p">,</span><span class="s1">&#39;OB stars (map)&#39;</span><span class="p">,</span><span class="s1">&#39;Cepheids&#39;</span><span class="p">]</span>  			 							 </div>

<div class="viewcode-block" id="main_.getinfo">
<a class="viewcode-back" href="../../api.html#SpiralMap.models_.main_.getinfo">[docs]</a>
	<span class="k">def</span> <span class="nf">getinfo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">model</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">print_</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>	
<span class="w">		</span><span class="sd">&quot;&quot;&quot;			</span>
<span class="sd">		   prints (model list, tracers) &amp; default plot attributes are defined here.</span>
<span class="sd">		</span>
<span class="sd">		   :param model: Optional - &#39;&#39; by default so lists all models. otherwise provide a model (ex: Drimmel_Ceph_2024) to list out all arms and default colours.	</span>
<span class="sd">		   :type model: String </span>
<span class="sd">		   :param print\_: Optional - if set to False does not print to screen.</span>
<span class="sd">		   :type print\_: Boolean </span>
<span class="sd">		&quot;&quot;&quot;</span>		
		
		<span class="k">if</span> <span class="n">model</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>		
			<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;try self.getinfo(model) for more details&#39;</span><span class="p">)</span>		
			<span class="n">dfmodlist</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">,</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Available models &amp; maps:&#39;</span><span class="p">])</span>			
			<span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Available models &amp; maps:&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">,</span> <span class="s1">&#39;Description&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">models_desc</span><span class="p">}</span>
			<span class="n">dfmodlist</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>					
			
			<span class="k">if</span> <span class="n">print_</span><span class="p">:</span>			
				<span class="nb">print</span><span class="p">(</span><span class="n">tabulate</span><span class="p">(</span><span class="n">dfmodlist</span><span class="p">,</span> <span class="n">headers</span> <span class="o">=</span> <span class="s1">&#39;keys&#39;</span><span class="p">,</span> <span class="n">tablefmt</span> <span class="o">=</span> <span class="s1">&#39;psql&#39;</span><span class="p">))</span>

		<span class="k">else</span><span class="p">:</span>
			
			<span class="k">try</span><span class="p">:</span>
				<span class="n">spimod</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">models_class</span><span class="p">[</span><span class="n">model</span><span class="p">]</span>
				<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;#####################&#39;</span><span class="p">)</span>			
				<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Model = &#39;</span><span class="o">+</span><span class="n">model</span><span class="p">)</span>
				<span class="n">spimod</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
			<span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
				<span class="nb">print</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
				<span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">+</span><span class="s1">&#39; is not in the library, check name !&#39;</span><span class="p">)</span>	
				<span class="nb">print</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>				
			
		<span class="bp">self</span><span class="o">.</span><span class="n">plotattrs_default</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;plot&#39;</span><span class="p">:</span><span class="kc">False</span><span class="p">,</span>
								<span class="s1">&#39;markersize&#39;</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span>
								<span class="s1">&#39;coordsys&#39;</span><span class="p">:</span><span class="s1">&#39;HC&#39;</span><span class="p">,</span>
								<span class="s1">&#39;linewidth&#39;</span><span class="p">:</span><span class="mf">0.5</span><span class="p">,</span>
								<span class="s1">&#39;linestyle&#39;</span><span class="p">:</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span>
								<span class="s1">&#39;armcolour&#39;</span><span class="p">:</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
								<span class="s1">&#39;markSunGC&#39;</span><span class="p">:</span><span class="kc">True</span><span class="p">,</span>
								<span class="s1">&#39;xmin&#39;</span><span class="p">:</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
								<span class="s1">&#39;xmax&#39;</span><span class="p">:</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
								<span class="s1">&#39;ymin&#39;</span><span class="p">:</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
								<span class="s1">&#39;ymax&#39;</span><span class="p">:</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
								<span class="s1">&#39;polarproj&#39;</span><span class="p">:</span><span class="kc">False</span><span class="p">,</span>       
								<span class="s1">&#39;polargrid&#39;</span><span class="p">:</span><span class="kc">False</span><span class="p">,</span>    
								<span class="s1">&#39;dataloc&#39;</span><span class="p">:</span><span class="n">dataloc</span><span class="p">}</span>    </div>

	<span class="k">def</span> <span class="nf">add2plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">plotattrs</span><span class="p">):</span>			
		<span class="k">if</span> <span class="n">plotattrs</span><span class="p">[</span><span class="s1">&#39;coordsys&#39;</span><span class="p">]</span> <span class="o">==</span><span class="s1">&#39;HC&#39;</span><span class="p">:</span>								
			<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\odot$&#39;</span><span class="p">,</span><span class="n">markersize</span><span class="o">=</span><span class="n">plotattrs</span><span class="p">[</span><span class="s1">&#39;markersize&#39;</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
			<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">xsun</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;*&#39;</span><span class="p">,</span><span class="n">markersize</span><span class="o">=</span><span class="n">plotattrs</span><span class="p">[</span><span class="s1">&#39;markersize&#39;</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>		
		<span class="k">if</span> <span class="n">plotattrs</span><span class="p">[</span><span class="s1">&#39;coordsys&#39;</span><span class="p">]</span> <span class="o">==</span><span class="s1">&#39;GC&#39;</span><span class="p">:</span>										
			<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;*&#39;</span><span class="p">,</span><span class="n">markersize</span><span class="o">=</span><span class="n">plotattrs</span><span class="p">[</span><span class="s1">&#39;markersize&#39;</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
			<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xsun</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\odot$&#39;</span><span class="p">,</span><span class="n">markersize</span><span class="o">=</span><span class="n">plotattrs</span><span class="p">[</span><span class="s1">&#39;markersize&#39;</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">xyplot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">spimod</span><span class="p">,</span><span class="n">plotattrs_</span><span class="p">):</span>						
		<span class="k">if</span> <span class="n">plotattrs_</span><span class="p">[</span><span class="s1">&#39;plot&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">plotattrs_</span><span class="p">[</span><span class="s1">&#39;polarproj&#39;</span><span class="p">]</span><span class="o">==</span><span class="kc">False</span> <span class="p">:</span>							
			<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">spimod</span><span class="o">.</span><span class="n">dout</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="o">+</span><span class="n">plotattrs_</span><span class="p">[</span><span class="s1">&#39;coordsys&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()],</span>
			         <span class="n">spimod</span><span class="o">.</span><span class="n">dout</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="o">+</span><span class="n">plotattrs_</span><span class="p">[</span><span class="s1">&#39;coordsys&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()],</span>
			         <span class="n">plotattrs_</span><span class="p">[</span><span class="s1">&#39;linestyle&#39;</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="n">plotattrs_</span><span class="p">[</span><span class="s1">&#39;armcolour&#39;</span><span class="p">])</span>			
			<span class="k">if</span> <span class="s1">&#39;xhc_ex&#39;</span> <span class="ow">in</span> 	<span class="n">spimod</span><span class="o">.</span><span class="n">dout</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
				<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">spimod</span><span class="o">.</span><span class="n">dout</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="o">+</span><span class="n">plotattrs_</span><span class="p">[</span><span class="s1">&#39;coordsys&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">+</span><span class="s1">&#39;_ex&#39;</span><span class="p">],</span>
				         <span class="n">spimod</span><span class="o">.</span><span class="n">dout</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="o">+</span><span class="n">plotattrs_</span><span class="p">[</span><span class="s1">&#39;coordsys&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">+</span><span class="s1">&#39;_ex&#39;</span><span class="p">],</span>
				         <span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">plotattrs_</span><span class="p">[</span><span class="s1">&#39;armcolour&#39;</span><span class="p">])</span>	
				                							
			<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;X$_{&#39;</span><span class="o">+</span><span class="n">plotattrs_</span><span class="p">[</span><span class="s1">&#39;coordsys&#39;</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;}$ [Kpc]&#39;</span><span class="p">)</span>
			<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Y$_{&#39;</span><span class="o">+</span><span class="n">plotattrs_</span><span class="p">[</span><span class="s1">&#39;coordsys&#39;</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;}$ [Kpc]&#39;</span><span class="p">)</span>	 
			<span class="k">if</span> <span class="n">plotattrs_</span><span class="p">[</span><span class="s1">&#39;xmin&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span> <span class="ow">or</span> <span class="n">plotattrs_</span><span class="p">[</span><span class="s1">&#39;xmax&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span> <span class="ow">or</span> <span class="n">plotattrs_</span><span class="p">[</span><span class="s1">&#39;ymin&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span> <span class="ow">or</span> <span class="n">plotattrs_</span><span class="p">[</span><span class="s1">&#39;ymax&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
				<span class="n">rub</span><span class="o">=</span><span class="mi">1</span>																			
			<span class="k">else</span><span class="p">:</span>
				<span class="n">xmin</span><span class="p">,</span><span class="n">xmax</span> <span class="o">=</span> <span class="n">plotattrs_</span><span class="p">[</span><span class="s1">&#39;xmin&#39;</span><span class="p">],</span><span class="n">plotattrs_</span><span class="p">[</span><span class="s1">&#39;xmax&#39;</span><span class="p">]</span>
				<span class="n">ymin</span><span class="p">,</span><span class="n">ymax</span> <span class="o">=</span> <span class="n">plotattrs_</span><span class="p">[</span><span class="s1">&#39;ymin&#39;</span><span class="p">],</span><span class="n">plotattrs_</span><span class="p">[</span><span class="s1">&#39;ymax&#39;</span><span class="p">]</span>	
				<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmax</span><span class="p">])</span>	
				<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="n">ymin</span><span class="p">,</span><span class="n">ymax</span><span class="p">])</span>	
			
			<span class="bp">self</span><span class="o">.</span><span class="n">xmin</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">xmax</span> <span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span><span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>				
			<span class="bp">self</span><span class="o">.</span><span class="n">ymin</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">ymax</span> <span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span><span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>			
			
			<span class="k">if</span> <span class="n">plotattrs_</span><span class="p">[</span><span class="s1">&#39;markSunGC&#39;</span><span class="p">]:</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">add2plot</span><span class="p">(</span><span class="n">plotattrs_</span><span class="p">)</span>	
<div class="viewcode-block" id="main_.readout">
<a class="viewcode-back" href="../../api.html#SpiralMap.models_.main_.readout">[docs]</a>
	<span class="k">def</span> <span class="nf">readout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">plotattrs</span><span class="o">=</span><span class="p">{},</span><span class="n">model</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">arm</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">print_</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>	
<span class="w">		</span><span class="sd">&quot;&quot;&quot;			</span>
<span class="sd">		   reads out individual models/ makes plots etc.</span>
<span class="sd">		</span>
<span class="sd">		   :param plotattrs: Optional - if not provided, uses default plot attributes.</span>
<span class="sd">		   :type plotattrs: dict </span>
<span class="sd">		   :param model: (required otherwise raises exception)</span>
<span class="sd">		   :type model: String </span>
<span class="sd">		   :param arm:  Optional - (default = &#39;&#39; so reads all arms)</span>
<span class="sd">		   :type arm:  String</span>
<span class="sd">		   :param print\_: Optional - if set to False does not print to screen.</span>
<span class="sd">		   :type print\_: Boolean </span>
<span class="sd">		   :raise RuntimeError: if no model is provided.</span>
<span class="sd">		&quot;&quot;&quot;</span>						
		<span class="k">if</span> <span class="n">model</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
			 <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;model = blank | no model provided </span><span class="se">\n</span><span class="s1"> try self.getino() for list of available models&#39;</span><span class="p">)</span>			 
			
		<span class="bp">self</span><span class="o">.</span><span class="n">modrec</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>		
		<span class="n">spimod</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">models_class</span><span class="p">[</span><span class="n">model</span><span class="p">]</span>			
		<span class="n">spimod</span><span class="o">.</span><span class="n">xsun</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xsun</span>
		<span class="n">spimod</span><span class="o">.</span><span class="n">getarmlist</span><span class="p">()</span>		
		<span class="bp">self</span><span class="o">.</span><span class="n">armlist</span> <span class="o">=</span> <span class="n">spimod</span><span class="o">.</span><span class="n">arms</span>	
		<span class="bp">self</span><span class="o">.</span><span class="n">arm</span> <span class="o">=</span> <span class="n">arm</span>
				
		<span class="c1"># in case plot attributes are not provided, or incomplete</span>
		<span class="k">for</span> <span class="n">ky</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotattrs_default</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>			
			<span class="k">if</span> <span class="n">ky</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">plotattrs</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>				
				<span class="n">plotattrs</span><span class="p">[</span><span class="n">ky</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotattrs_default</span><span class="p">[</span><span class="n">ky</span><span class="p">]</span>
		<span class="n">plotattrs1</span> <span class="o">=</span> <span class="n">plotattrs</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>		
		<span class="k">if</span> <span class="s1">&#39;cont&#39;</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>													
			<span class="n">spimod</span><span class="o">.</span><span class="n">output_</span><span class="p">(</span><span class="n">plotattrs1</span><span class="p">)</span>		
			<span class="c1"># self.xmin,self.xmax,self.ymin,self.ymax = spimod.xmin,spimod.xmax,spimod.ymin,spimod.ymax</span>
		<span class="k">if</span> <span class="p">((</span><span class="s1">&#39;cont&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span><span class="o">&amp;</span><span class="p">(</span><span class="s1">&#39;all&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">arm</span><span class="p">)):</span>	
			<span class="bp">self</span><span class="o">.</span><span class="n">armrec</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">arm</span><span class="p">)</span>					
			<span class="n">plotattrs1</span> <span class="o">=</span> <span class="n">plotattrs</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>													
			<span class="n">spimod</span><span class="o">.</span><span class="n">output_</span><span class="p">(</span><span class="n">arm</span><span class="p">)</span>
			<span class="n">getangular</span><span class="p">(</span><span class="n">spimod</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">dout</span> <span class="o">=</span> <span class="n">spimod</span><span class="o">.</span><span class="n">dout</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> 													
			<span class="k">if</span> <span class="n">plotattrs1</span><span class="p">[</span><span class="s1">&#39;armcolour&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
				<span class="n">plotattrs1</span><span class="p">[</span><span class="s1">&#39;armcolour&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">spimod</span><span class="o">.</span><span class="n">armcolour</span><span class="p">[</span><span class="n">arm</span><span class="p">]</span>		
			<span class="bp">self</span><span class="o">.</span><span class="n">xyplot</span><span class="p">(</span><span class="n">spimod</span><span class="p">,</span><span class="n">plotattrs1</span><span class="p">)</span>
			<span class="n">_polarproj</span><span class="p">(</span><span class="n">spimod</span><span class="p">,</span><span class="n">plotattrs1</span><span class="p">)</span>														
		<span class="k">if</span> <span class="p">((</span><span class="s1">&#39;cont&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span><span class="o">&amp;</span><span class="p">(</span><span class="n">arm</span><span class="o">==</span><span class="s1">&#39;all&#39;</span><span class="p">))</span>  <span class="p">:</span>														
			<span class="k">for</span> <span class="n">arm_temp</span> <span class="ow">in</span> <span class="n">spimod</span><span class="o">.</span><span class="n">arms</span><span class="p">:</span>			
				<span class="n">plotattrs1</span> <span class="o">=</span> <span class="n">plotattrs</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>			
				<span class="n">spimod</span><span class="o">.</span><span class="n">output_</span><span class="p">(</span><span class="n">arm_temp</span><span class="p">)</span>
				<span class="n">getangular</span><span class="p">(</span><span class="n">spimod</span><span class="p">)</span>											
				<span class="k">if</span> <span class="n">plotattrs1</span><span class="p">[</span><span class="s1">&#39;armcolour&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
					<span class="n">plotattrs1</span><span class="p">[</span><span class="s1">&#39;armcolour&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">spimod</span><span class="o">.</span><span class="n">armcolour</span><span class="p">[</span><span class="n">arm_temp</span><span class="p">]</span>
					<span class="bp">self</span><span class="o">.</span><span class="n">xyplot</span><span class="p">(</span><span class="n">spimod</span><span class="p">,</span><span class="n">plotattrs1</span><span class="p">)</span>
					<span class="n">_polarproj</span><span class="p">(</span><span class="n">spimod</span><span class="p">,</span><span class="n">plotattrs1</span><span class="p">)</span>																							
		<span class="k">try</span><span class="p">:</span>	
			<span class="n">add_polargrid</span><span class="p">(</span><span class="n">plotattrs1</span><span class="p">,</span><span class="n">xmin</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmax</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">xmax</span><span class="p">,</span><span class="n">ymin</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ymin</span><span class="p">,</span><span class="n">ymax</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ymax</span><span class="p">,</span><span class="n">modrec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">modrec</span><span class="p">,</span><span class="n">armrec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">armrec</span><span class="p">)</span>	
		<span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
			<span class="k">pass</span>										</div>
</div>

									
<span class="k">class</span> <span class="nc">_make_supportfiles</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	was run to save supporting files</span>
<span class="sd">	</span>
<span class="sd">	&quot;&quot;&quot;</span>
	
	<span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
					
		<span class="bp">self</span><span class="o">.</span><span class="n">xsun</span> <span class="o">=</span> <span class="o">-</span><span class="mf">8.277</span>	
	
		<span class="c1"># self.prep_poggio_polar()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">savelims_all</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">savelims</span><span class="p">()</span>	
	<span class="k">def</span> <span class="nf">prep_poggio_polar</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>	
<span class="w">		</span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">		saves the poggio contours for polarprojection</span>
<span class="sd">		&#39;&#39;&#39;</span>
	
		<span class="n">xsun</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">xsun</span>
		<span class="n">usemodels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Poggio_cont_2021&#39;</span><span class="p">,</span><span class="s1">&#39;GaiaPVP_cont_2022&#39;</span><span class="p">]</span>	
		
		<span class="k">for</span> <span class="n">usemodel</span> <span class="ow">in</span> <span class="n">usemodels</span><span class="p">:</span>
			
			<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
			<span class="n">plotattrs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;plot&#39;</span><span class="p">:</span><span class="kc">True</span><span class="p">,</span><span class="s1">&#39;coordsys&#39;</span><span class="p">:</span> <span class="s1">&#39;HC&#39;</span><span class="p">,</span><span class="s1">&#39;markersize&#39;</span><span class="p">:</span><span class="mi">15</span><span class="p">,</span><span class="s1">&#39;linewidth&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;polarproj&#39;</span><span class="p">:</span><span class="kc">False</span><span class="p">,</span><span class="s1">&#39;armcolour&#39;</span><span class="p">:</span><span class="s1">&#39;black&#39;</span><span class="p">}</span>	
			<span class="n">sp</span> <span class="o">=</span> <span class="n">spiral_poggio_maps</span><span class="p">(</span><span class="n">model_</span><span class="o">=</span><span class="n">usemodel</span><span class="p">)</span>
			<span class="n">sp</span><span class="o">.</span><span class="n">xsun</span> <span class="o">=</span> <span class="n">xsun</span>
			<span class="n">cset1</span><span class="p">,</span><span class="n">cset2</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">output_</span><span class="p">(</span><span class="n">plotattrs</span><span class="p">)</span>
			
			<span class="c1"># # check xy projection</span>
			<span class="c1"># plt.ion()</span>
			<span class="c1"># plt.close(&#39;all&#39;)</span>
			<span class="c1"># [[plt.plot(q[:,0],q[:,1], c=&#39;C%d&#39;%c) for q in Q]  for c,Q in enumerate(cset1.allsegs)]</span>
			<span class="c1"># # # # plt.savefig(root_+&#39;/test_xy.png&#39;)	</span>
			
				
			<span class="n">tst</span> <span class="o">=</span> <span class="p">[[(</span><span class="n">q</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">q</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">Q</span><span class="p">]</span>  <span class="k">for</span> <span class="n">c</span><span class="p">,</span><span class="n">Q</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">cset1</span><span class="o">.</span><span class="n">allsegs</span><span class="p">)]</span>
			
			<span class="n">plt</span><span class="o">.</span><span class="n">ion</span><span class="p">()</span>
			<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
			<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">7.5</span><span class="p">,</span><span class="mf">7.</span><span class="p">),</span><span class="n">subplot_kw</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s2">&quot;polar&quot;</span><span class="p">))</span>
			
			<span class="n">dsave</span> <span class="o">=</span> <span class="p">{}</span>
			<span class="n">dsave</span><span class="p">[</span><span class="s1">&#39;glon4&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
			<span class="n">dsave</span><span class="p">[</span><span class="s1">&#39;dhelio&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
			<span class="n">dsave</span><span class="p">[</span><span class="s1">&#39;phi4&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
			<span class="n">dsave</span><span class="p">[</span><span class="s1">&#39;rgc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
			<span class="k">for</span> <span class="n">inum</span><span class="p">,</span><span class="n">Q</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">cset1</span><span class="o">.</span><span class="n">allsegs</span><span class="p">):</span>
				<span class="n">xc</span> <span class="o">=</span> <span class="p">[</span><span class="n">q</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">Q</span><span class="p">]</span>
				<span class="n">yc</span> <span class="o">=</span> <span class="p">[</span><span class="n">q</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">Q</span><span class="p">]</span>
				
				<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xc</span><span class="p">)):</span>
					<span class="n">glon4</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="n">yc</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">xc</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span><span class="o">%</span><span class="mf">360.</span>
					<span class="n">dhelio</span> <span class="o">=</span> <span class="n">sqrtsum</span><span class="p">(</span><span class="n">ds</span><span class="o">=</span><span class="p">[</span><span class="n">xc</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">yc</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>
					<span class="n">phi4</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="n">yc</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">xc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">sp</span><span class="o">.</span><span class="n">xsun</span><span class="p">))</span><span class="o">%</span><span class="mf">360.</span>	
					<span class="n">rgc</span> <span class="o">=</span> <span class="n">sqrtsum</span><span class="p">(</span><span class="n">ds</span><span class="o">=</span><span class="p">[</span><span class="n">xc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">sp</span><span class="o">.</span><span class="n">xsun</span><span class="p">,</span><span class="n">yc</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>
					<span class="c1"># plt.plot(np.radians(phi4),rgc,&#39;.&#39;) # gc frame</span>
					<span class="c1"># plt.plot(np.radians(glon4),dhelio,&#39;.&#39;) # hc frame</span>
					<span class="n">dsave</span><span class="p">[</span><span class="s1">&#39;phi4&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">phi4</span><span class="p">)</span>
					<span class="n">dsave</span><span class="p">[</span><span class="s1">&#39;rgc&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rgc</span><span class="p">)</span>
					<span class="n">dsave</span><span class="p">[</span><span class="s1">&#39;glon4&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">glon4</span><span class="p">)</span>
					<span class="n">dsave</span><span class="p">[</span><span class="s1">&#39;dhelio&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dhelio</span><span class="p">)</span>
	
			
			<span class="k">for</span> <span class="n">ky</span> <span class="ow">in</span> <span class="n">dsave</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
				<span class="n">dsave</span><span class="p">[</span><span class="n">ky</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">dsave</span><span class="p">[</span><span class="n">ky</span><span class="p">])</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>	
				
			<span class="n">dsave</span><span class="p">[</span><span class="s1">&#39;ang_gc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dsave</span><span class="p">[</span><span class="s1">&#39;phi4&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>	
			<span class="n">dsave</span><span class="p">[</span><span class="s1">&#39;ang_hc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dsave</span><span class="p">[</span><span class="s1">&#39;glon4&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>	
			
			<span class="n">dsave</span><span class="p">[</span><span class="s1">&#39;rad_gc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dsave</span><span class="p">[</span><span class="s1">&#39;rgc&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>	
			<span class="n">dsave</span><span class="p">[</span><span class="s1">&#39;rad_hc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dsave</span><span class="p">[</span><span class="s1">&#39;dhelio&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>	
			
			
			<span class="n">picklewrite</span><span class="p">(</span><span class="n">dsave</span><span class="p">,</span><span class="n">usemodel</span><span class="o">+</span><span class="s1">&#39;_pproj_contours&#39;</span><span class="p">,</span><span class="n">dataloc</span><span class="o">+</span><span class="s1">&#39;/&#39;</span><span class="o">+</span><span class="n">usemodel</span><span class="p">)</span>						
	<span class="k">def</span> <span class="nf">savelims_all</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>		
	
		<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;saving plot limits for all models&#39;</span><span class="p">)</span>
		<span class="n">xsun</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">xsun</span>
	
		<span class="n">mylims</span> <span class="o">=</span> <span class="p">{}</span>
		
		<span class="n">spirals</span> <span class="o">=</span> <span class="n">main_</span><span class="p">(</span><span class="n">xsun</span><span class="o">=</span><span class="n">xsun</span><span class="p">)</span>
		<span class="k">for</span> <span class="n">inum</span><span class="p">,</span><span class="n">use_model</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">spirals</span><span class="o">.</span><span class="n">models</span><span class="p">):</span>				
			
			<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
		
			<span class="n">mylims</span><span class="p">[</span><span class="n">use_model</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
			
			<span class="n">plotattrs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;plot&#39;</span><span class="p">:</span><span class="kc">True</span><span class="p">,</span><span class="s1">&#39;coordsys&#39;</span><span class="p">:</span><span class="s1">&#39;GC&#39;</span><span class="p">,</span><span class="s1">&#39;markersize&#39;</span><span class="p">:</span><span class="mi">15</span><span class="p">,</span><span class="s1">&#39;markSunGC&#39;</span><span class="p">:</span><span class="kc">True</span><span class="p">,</span><span class="s1">&#39;polargrid&#39;</span><span class="p">:</span><span class="kc">False</span><span class="p">}</span>		
	
			<span class="n">coordsys</span> <span class="o">=</span> <span class="n">plotattrs</span><span class="p">[</span><span class="s1">&#39;coordsys&#39;</span><span class="p">]</span>
	
			<span class="n">spirals</span><span class="o">.</span><span class="n">getinfo</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">use_model</span><span class="p">)</span>
			<span class="n">spirals</span><span class="o">.</span><span class="n">readout</span><span class="p">(</span><span class="n">plotattrs</span><span class="p">,</span><span class="n">model</span><span class="o">=</span><span class="n">use_model</span><span class="p">,</span><span class="n">arm</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>		
			<span class="n">mylims</span><span class="p">[</span><span class="n">use_model</span><span class="p">][</span><span class="s1">&#39;xmin&#39;</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="n">coordsys</span><span class="p">]</span> <span class="o">=</span> <span class="n">spirals</span><span class="o">.</span><span class="n">xmin</span>
			<span class="n">mylims</span><span class="p">[</span><span class="n">use_model</span><span class="p">][</span><span class="s1">&#39;xmax&#39;</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="n">coordsys</span><span class="p">]</span> <span class="o">=</span> <span class="n">spirals</span><span class="o">.</span><span class="n">xmax</span>
			<span class="n">mylims</span><span class="p">[</span><span class="n">use_model</span><span class="p">][</span><span class="s1">&#39;ymin&#39;</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="n">coordsys</span><span class="p">]</span> <span class="o">=</span> <span class="n">spirals</span><span class="o">.</span><span class="n">ymin</span>
			<span class="n">mylims</span><span class="p">[</span><span class="n">use_model</span><span class="p">][</span><span class="s1">&#39;ymax&#39;</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="n">coordsys</span><span class="p">]</span> <span class="o">=</span> <span class="n">spirals</span><span class="o">.</span><span class="n">ymax</span>
	
			<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
			<span class="n">plotattrs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;plot&#39;</span><span class="p">:</span><span class="kc">True</span><span class="p">,</span><span class="s1">&#39;coordsys&#39;</span><span class="p">:</span><span class="s1">&#39;HC&#39;</span><span class="p">,</span><span class="s1">&#39;markersize&#39;</span><span class="p">:</span><span class="mi">15</span><span class="p">,</span><span class="s1">&#39;markSunGC&#39;</span><span class="p">:</span><span class="kc">True</span><span class="p">,</span><span class="s1">&#39;polargrid&#39;</span><span class="p">:</span><span class="kc">False</span><span class="p">}</span>		
			<span class="n">coordsys</span> <span class="o">=</span> <span class="n">plotattrs</span><span class="p">[</span><span class="s1">&#39;coordsys&#39;</span><span class="p">]</span>		
				
			<span class="n">spirals</span><span class="o">.</span><span class="n">getinfo</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">use_model</span><span class="p">)</span>
			<span class="n">spirals</span><span class="o">.</span><span class="n">readout</span><span class="p">(</span><span class="n">plotattrs</span><span class="p">,</span><span class="n">model</span><span class="o">=</span><span class="n">use_model</span><span class="p">,</span><span class="n">arm</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
			<span class="n">mylims</span><span class="p">[</span><span class="n">use_model</span><span class="p">][</span><span class="s1">&#39;xmin&#39;</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="n">coordsys</span><span class="p">]</span> <span class="o">=</span> <span class="n">spirals</span><span class="o">.</span><span class="n">xmin</span>
			<span class="n">mylims</span><span class="p">[</span><span class="n">use_model</span><span class="p">][</span><span class="s1">&#39;xmax&#39;</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="n">coordsys</span><span class="p">]</span> <span class="o">=</span> <span class="n">spirals</span><span class="o">.</span><span class="n">xmax</span>
			<span class="n">mylims</span><span class="p">[</span><span class="n">use_model</span><span class="p">][</span><span class="s1">&#39;ymin&#39;</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="n">coordsys</span><span class="p">]</span> <span class="o">=</span> <span class="n">spirals</span><span class="o">.</span><span class="n">ymin</span>
			<span class="n">mylims</span><span class="p">[</span><span class="n">use_model</span><span class="p">][</span><span class="s1">&#39;ymax&#39;</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="n">coordsys</span><span class="p">]</span> <span class="o">=</span> <span class="n">spirals</span><span class="o">.</span><span class="n">ymax</span>
						
		<span class="n">picklewrite</span><span class="p">(</span><span class="n">mylims</span><span class="p">,</span><span class="s1">&#39;flim_all&#39;</span><span class="p">,</span><span class="n">dataloc</span><span class="p">)</span>		
	<span class="k">def</span> <span class="nf">savelims</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>		
	
		<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;saving plot limits for all models&#39;</span><span class="p">)</span>
		<span class="n">xsun</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">xsun</span>
	
		<span class="n">mylims</span> <span class="o">=</span> <span class="p">{}</span>
		
		<span class="n">spirals</span> <span class="o">=</span> <span class="n">main_</span><span class="p">(</span><span class="n">xsun</span><span class="o">=</span><span class="n">xsun</span><span class="p">)</span>
		
		<span class="k">for</span> <span class="n">inum</span><span class="p">,</span><span class="n">use_model</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">spirals</span><span class="o">.</span><span class="n">models</span><span class="p">):</span>	
						
				
			<span class="n">spimod</span> <span class="o">=</span> <span class="n">spirals</span><span class="o">.</span><span class="n">models_class</span><span class="p">[</span><span class="n">use_model</span><span class="p">]</span>
			<span class="n">spimod</span><span class="o">.</span><span class="n">getarmlist</span><span class="p">()</span>
		
			<span class="n">mylims</span><span class="p">[</span><span class="n">use_model</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
			
			<span class="k">for</span> <span class="n">jnum</span><span class="p">,</span> <span class="n">arm</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">spimod</span><span class="o">.</span><span class="n">arms</span><span class="p">):</span>
				
				<span class="n">mylims</span><span class="p">[</span><span class="n">use_model</span><span class="p">][</span><span class="n">arm</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

				<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
				<span class="n">plotattrs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;plot&#39;</span><span class="p">:</span><span class="kc">True</span><span class="p">,</span><span class="s1">&#39;coordsys&#39;</span><span class="p">:</span><span class="s1">&#39;GC&#39;</span><span class="p">,</span><span class="s1">&#39;markersize&#39;</span><span class="p">:</span><span class="mi">15</span><span class="p">,</span><span class="s1">&#39;markSunGC&#39;</span><span class="p">:</span><span class="kc">True</span><span class="p">,</span><span class="s1">&#39;polargrid&#39;</span><span class="p">:</span><span class="kc">False</span><span class="p">}</span>		
		
				<span class="n">coordsys</span> <span class="o">=</span> <span class="n">plotattrs</span><span class="p">[</span><span class="s1">&#39;coordsys&#39;</span><span class="p">]</span>
		
				<span class="n">spirals</span><span class="o">.</span><span class="n">getinfo</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">use_model</span><span class="p">)</span>
				<span class="n">spirals</span><span class="o">.</span><span class="n">readout</span><span class="p">(</span><span class="n">plotattrs</span><span class="p">,</span><span class="n">model</span><span class="o">=</span><span class="n">use_model</span><span class="p">,</span><span class="n">arm</span><span class="o">=</span><span class="n">arm</span><span class="p">)</span>		
				<span class="n">mylims</span><span class="p">[</span><span class="n">use_model</span><span class="p">][</span><span class="n">arm</span><span class="p">][</span><span class="s1">&#39;xmin&#39;</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="n">coordsys</span><span class="p">]</span> <span class="o">=</span> <span class="n">spirals</span><span class="o">.</span><span class="n">xmin</span>
				<span class="n">mylims</span><span class="p">[</span><span class="n">use_model</span><span class="p">][</span><span class="n">arm</span><span class="p">][</span><span class="s1">&#39;xmax&#39;</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="n">coordsys</span><span class="p">]</span> <span class="o">=</span> <span class="n">spirals</span><span class="o">.</span><span class="n">xmax</span>
				<span class="n">mylims</span><span class="p">[</span><span class="n">use_model</span><span class="p">][</span><span class="n">arm</span><span class="p">][</span><span class="s1">&#39;ymin&#39;</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="n">coordsys</span><span class="p">]</span> <span class="o">=</span> <span class="n">spirals</span><span class="o">.</span><span class="n">ymin</span>
				<span class="n">mylims</span><span class="p">[</span><span class="n">use_model</span><span class="p">][</span><span class="n">arm</span><span class="p">][</span><span class="s1">&#39;ymax&#39;</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="n">coordsys</span><span class="p">]</span> <span class="o">=</span> <span class="n">spirals</span><span class="o">.</span><span class="n">ymax</span>
		
				<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
				<span class="n">plotattrs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;plot&#39;</span><span class="p">:</span><span class="kc">True</span><span class="p">,</span><span class="s1">&#39;coordsys&#39;</span><span class="p">:</span><span class="s1">&#39;HC&#39;</span><span class="p">,</span><span class="s1">&#39;markersize&#39;</span><span class="p">:</span><span class="mi">15</span><span class="p">,</span><span class="s1">&#39;markSunGC&#39;</span><span class="p">:</span><span class="kc">True</span><span class="p">,</span><span class="s1">&#39;polargrid&#39;</span><span class="p">:</span><span class="kc">False</span><span class="p">}</span>		
				<span class="n">coordsys</span> <span class="o">=</span> <span class="n">plotattrs</span><span class="p">[</span><span class="s1">&#39;coordsys&#39;</span><span class="p">]</span>		
					
				<span class="n">spirals</span><span class="o">.</span><span class="n">getinfo</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">use_model</span><span class="p">)</span>
				<span class="n">spirals</span><span class="o">.</span><span class="n">readout</span><span class="p">(</span><span class="n">plotattrs</span><span class="p">,</span><span class="n">model</span><span class="o">=</span><span class="n">use_model</span><span class="p">,</span><span class="n">arm</span><span class="o">=</span><span class="n">arm</span><span class="p">)</span>
				<span class="n">mylims</span><span class="p">[</span><span class="n">use_model</span><span class="p">][</span><span class="n">arm</span><span class="p">][</span><span class="s1">&#39;xmin&#39;</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="n">coordsys</span><span class="p">]</span> <span class="o">=</span> <span class="n">spirals</span><span class="o">.</span><span class="n">xmin</span>
				<span class="n">mylims</span><span class="p">[</span><span class="n">use_model</span><span class="p">][</span><span class="n">arm</span><span class="p">][</span><span class="s1">&#39;xmax&#39;</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="n">coordsys</span><span class="p">]</span> <span class="o">=</span> <span class="n">spirals</span><span class="o">.</span><span class="n">xmax</span>
				<span class="n">mylims</span><span class="p">[</span><span class="n">use_model</span><span class="p">][</span><span class="n">arm</span><span class="p">][</span><span class="s1">&#39;ymin&#39;</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="n">coordsys</span><span class="p">]</span> <span class="o">=</span> <span class="n">spirals</span><span class="o">.</span><span class="n">ymin</span>
				<span class="n">mylims</span><span class="p">[</span><span class="n">use_model</span><span class="p">][</span><span class="n">arm</span><span class="p">][</span><span class="s1">&#39;ymax&#39;</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="n">coordsys</span><span class="p">]</span> <span class="o">=</span> <span class="n">spirals</span><span class="o">.</span><span class="n">ymax</span>
						
		<span class="n">picklewrite</span><span class="p">(</span><span class="n">mylims</span><span class="p">,</span><span class="s1">&#39;flim&#39;</span><span class="p">,</span><span class="n">dataloc</span><span class="p">)</span>	
	


</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Prusty &amp; Khanna.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>