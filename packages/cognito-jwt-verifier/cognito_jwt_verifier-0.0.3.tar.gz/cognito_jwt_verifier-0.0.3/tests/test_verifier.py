import pytest

from cognito_jwt_verifier import AsyncCognitoJwtVerifier


@pytest.mark.asyncio
async def test_verify_access_token():
    access_token = "eyJraWQiOiJicU1lSnJBUFJMY2MwaVlvdWF5SlIwMEZVbDZPQ2ZpZ2Q0UFNDNmxFQXpBPSIsImFsZyI6IlJTMjU2In0.eyJzdWIiOiI2MTRiYzViMC01MDQxLTcwZTUtZTYyYS0wY2MyYzM0MjRjMzgiLCJ0b2tlbl91c2UiOiJhY2Nlc3MiLCJzY29wZSI6Im9wZW5pZCIsImF1dGhfdGltZSI6MTc0OTA4Njc4MSwiaXNzIjoiaHR0cHM6XC9cL2NvZ25pdG8taWRwLnVzLWVhc3QtMi5hbWF6b25hd3MuY29tXC91cy1lYXN0LTJfQUU3dW9nTjVyIiwiZXhwIjoxNzQ5MDkwMzgxLCJpYXQiOjE3NDkwODY3ODEsInZlcnNpb24iOjIsImp0aSI6IjBjMTExZjE3LThiNmUtNDljYy04YTYxLTNjMDFkYTkzNGVmZiIsImNsaWVudF9pZCI6Im05NXZ1c3VidmlyNnBzbjFtZmFjNjFvbmQiLCJ1c2VybmFtZSI6Im1hc29uZmxpbnQ0NCJ9.dwXN7FgRTcFtf2QUv-BxCfyxwYu8ZqK9UNdzqfxLoZlDvg_64Aag-JFSwtS80tSJOQHkZkhTTIY6w89z4mVUO6dlQVgd0cquWgKb7DnLea655luBoedaV_y_e5SA0PO2BB1FFC_T_vqG1hOcNdFmt6D7VykJPErotUnXXTjq0iR9H5e9-501UZaoYmoBNIFT9VzSRzysD1SiKtm6GEzDszzTzy_iTu0eJsh_-CdobUA107wDtS2dJ4T_RYnrw9A6-xq4qfgZm9q6x0Sk8EP4Ot9baFQI5BX1DuyQNe9ocmaFS_basFLRT8wIiOX6_OvGp1BblUzKRa4vPghvJtecdw"
    verifier = AsyncCognitoJwtVerifier(
        "https://cognito-idp.us-east-2.amazonaws.com/us-east-2_AE7uogN5r",
        client_ids=["m95vusubvir6psn1mfac61ond"],
    )
    claims = await verifier.verify_access_token(access_token)


@pytest.mark.asyncio
async def test_verify_id_token():
    id_token = "eyJraWQiOiJNYUNTXC9QUWhuaXhJNmJXMXVYalBmWEVRY1l4dVNmUXNYSHRnMCtPSkNmcz0iLCJhbGciOiJSUzI1NiJ9.eyJhdF9oYXNoIjoiLXRaRlFTMlJPWElIVjRVLXFQTy0tZyIsInN1YiI6IjYxNGJjNWIwLTUwNDEtNzBlNS1lNjJhLTBjYzJjMzQyNGMzOCIsImVtYWlsX3ZlcmlmaWVkIjp0cnVlLCJpc3MiOiJodHRwczpcL1wvY29nbml0by1pZHAudXMtZWFzdC0yLmFtYXpvbmF3cy5jb21cL3VzLWVhc3QtMl9BRTd1b2dONXIiLCJwaG9uZV9udW1iZXJfdmVyaWZpZWQiOnRydWUsImNvZ25pdG86dXNlcm5hbWUiOiJtYXNvbmZsaW50NDQiLCJhdWQiOiJtOTV2dXN1YnZpcjZwc24xbWZhYzYxb25kIiwidG9rZW5fdXNlIjoiaWQiLCJhdXRoX3RpbWUiOjE3NDkwODY3ODEsInBob25lX251bWJlciI6IisxODE2NjE3NDUxMSIsImV4cCI6MTc0OTA5MDM4MSwiaWF0IjoxNzQ5MDg2NzgxLCJqdGkiOiJhMjM4NTA2OS01NTgyLTQ2OGItOTc5NC1mMTcyMzAyN2M2ZTYiLCJlbWFpbCI6Im1hc29uZmxpbnQ0NEBnbWFpbC5jb20ifQ.TAkWkh0xw0DY3Xy5i2t5q--jYL9X0ZU_Sn_F5-kIdy_MgZ2PMpG9s0dO3tI8u3uyuT6ip5Bb4VsKBXlpakE9CDBC6yMc_8_9LCw8I78IMB-0hLHVacF8P_sBxnpWXMKSRdY7HBmQ5dKuQ4FJ2Yh1yf5MYh_ni0aJopvBJCIF_IZONzNo21nFFPeb2g3-GEOuZivm9Pd2CwcCaChfqEusSQfBw7yM8HOtgbBpNWLa5LzAqWQ5xei-7iW5m8OyjugTkdLruytEVEy8U-pDALwyyHi4NeWb8mw1meMGxUwEtRt6EkOoeCBhzShA0k1-QzAcScuB6rd2i4kFiAUjfDLD-A"
    verifier = AsyncCognitoJwtVerifier(
        "https://cognito-idp.us-east-2.amazonaws.com/us-east-2_AE7uogN5r",
        client_ids=["m95vusubvir6psn1mfac61ond"],
    )
    claims = await verifier.verify_id_token(id_token)
