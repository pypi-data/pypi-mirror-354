Metadata-Version: 2.4
Name: crdb-mcpctl
Version: 0.1.0
Summary: CLI for interacting with a CRDB-backed Model Context Protocol server
Author-email: Virag Tripathi <virag.tripathi@gmail.com>
License-Expression: MIT
Classifier: Development Status :: 4 - Beta
Classifier: Intended Audience :: Developers
Classifier: Topic :: Software Development :: Quality Assurance
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3.7
Classifier: Programming Language :: Python :: 3.8
Classifier: Programming Language :: Python :: 3.9
Classifier: Programming Language :: Python :: 3.10
Classifier: Operating System :: OS Independent
Requires-Python: >=3.9
Description-Content-Type: text/markdown
License-File: LICENSE
Requires-Dist: typer[all]>=0.12.3
Requires-Dist: requests>=2.31.0
Requires-Dist: pydantic>=2.6.4
Requires-Dist: PyYAML>=6.0.1
Requires-Dist: openai>=1.14.2
Requires-Dist: anthropic>=0.25.4
Requires-Dist: tenacity
Provides-Extra: dev
Requires-Dist: black; extra == "dev"
Requires-Dist: ruff; extra == "dev"
Requires-Dist: pytest; extra == "dev"
Requires-Dist: pytest-mock; extra == "dev"
Dynamic: license-file

# crdb-mcpctl

![PyPI](https://img.shields.io/pypi/v/crdb-mcpctl)
![Python](https://img.shields.io/pypi/pyversions/crdb-mcpctl)
![License](https://img.shields.io/github/license/viragtripathi/crdb-mcpctl)
![CI](https://github.com/viragtripathi/crdb-mcpctl/actions/workflows/python-ci.yml/badge.svg)

A developer-friendly, model-provider-agnostic CLI tool for working with [Model Context Protocol](https://modelcontextprotocol.io) servers ‚Äî built specifically for use with [CockroachDB](https://www.cockroachlabs.com/) backends.

![crdb-mcpctl CLI screenshot](./crdb-mcpctl.png)

---

## üß† What This Is

`crdb-mcpctl` is a spec-aligned, CLI-first interface for creating, managing, exporting, and running [Model Context Protocol](https://modelcontextprotocol.io) resources.

It works with [`crdb-mcp-server`](https://github.com/viragtripathi/crdb-mcp-server), a FastAPI-based MCP implementation backed by CockroachDB. Together, they offer:

- A reliable MCP context registry (server)
- A CLI for simulation, LLM runs, and batch workflows (client)

---

## ‚úÖ Feature Highlights

- üå± MCP-spec-compliant context management (create, list, get, delete)
- üì¶ Export individual or all contexts to YAML or JSON
- üîÅ Run contexts against real LLMs (OpenAI, Anthropic, etc.)
- üí¨ Supports streaming, retry, model override
- üìö Batch simulation of inputs
- ‚öôÔ∏è Reads config from `~/.config/crdb-mcpctl/config.yaml` or env vars
- üß± Extensible provider system (Claude, GPT-4, Mistral, etc.)
- üìà Configurable logging per command (`--log-level`)

---

## üöÄ Quickstart

### üì¶ Install from PyPI

```bash
pip install crdb-mcpctl
````

### üõ† Or install from source

```bash
git clone https://github.com/viragtripathi/crdb-mcpctl
cd crdb-mcpctl
pip install -e .
```

> You‚Äôll also need a running instance of [`crdb-mcp-server`](https://github.com/viragtripathi/crdb-mcp-server)

---

## üîê Configuration Options

### ‚úÖ Environment Variables (preferred for CI and scripting)

| Variable            | Description                          |
|---------------------|--------------------------------------|
| `MCP_SERVER_URL`    | Base URL for the MCP server          |
| `MCP_API_TOKEN`     | Bearer token for protected endpoints |
| `OPENAI_API_KEY`    | API key for OpenAI LLMs              |
| `ANTHROPIC_API_KEY` | API key for Anthropic Claude LLMs    |

```bash
export MCP_SERVER_URL=http://localhost:8081
export OPENAI_API_KEY=sk-...
```

---

### üóÇ `~/.config/crdb-mcpctl/config.yaml` (alternative for local/dev)

```yaml
server: http://localhost:8081

openai:
  api_key: sk-...

anthropic:
  api_key: your-anthropic-key
```

‚úÖ Env vars take precedence over config file.

---

## üß™ CLI Commands

```bash
# Show version and top-level help
crdb-mcpctl --version
crdb-mcpctl --help

# Create a context
crdb-mcpctl create context --file summarizer.yaml

# List all contexts
crdb-mcpctl list contexts

# Get or delete a context
crdb-mcpctl get context <uuid>
crdb-mcpctl delete context <uuid> -y

# Export one or all
crdb-mcpctl export context <uuid> --file out.yaml
crdb-mcpctl export all --output-dir exported_contexts/

# Run a single input
crdb-mcpctl run context --provider openai --file context.yaml --input "Summarize this article"

# Simulate a batch of inputs
crdb-mcpctl simulate context \
  --provider anthropic \
  --file summarizer.yaml \
  --inputs inputs.txt
```

---

## üß∞ Logging

Enable structured logging with:

```bash
crdb-mcpctl create context --file ctx.yaml --log-level DEBUG
```

---

## ‚ôªÔ∏è Retry Logic

All network operations (GET, POST, DELETE) retry up to 3 times with 2s backoff using [`tenacity`](https://tenacity.readthedocs.io/).

---

## üí° Error Feedback Example

On connection failure:

```text
‚ùå Failed to connect to MCP server at http://localhost:8081

üîß Is the server running? Start it with:
  crdb-mcp-server serve --init-schema

üåç To override the server URL:
  --server http://localhost:8081
  OR
  export MCP_SERVER_URL=http://localhost:8081
```

---

## üôå Contributions

This project is open for internal and public usage.

If you want to support additional providers, improve UX, or standardize context specs, contributions are welcome.

